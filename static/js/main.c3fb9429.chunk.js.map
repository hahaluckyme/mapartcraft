{"version":3,"sources":["images/classicVsValley.png","components/faq.js","images/Palette128_Unobtainable_Trans.png","components/header.js","locale/de/flag.svg","locale/ua/flag.svg","locale/en/flag.svg","locale/eo/flag.svg","locale/es/flag.svg","locale/et/flag.svg","locale/et/flag_pop.svg","locale/fr/flag.svg","locale/it/flag.svg","locale/lt/flag.svg","locale/pt/flag.svg","locale/ru/flag.svg","locale/zh-Hans/flag.svg","locale/zh-Hant/flag.svg","locale/pl/flag.svg","locale/pt-Br/flag.svg","locale/ja/flag.svg","locale/locale.js","components/languages.js","cookieManager.js","components/tooltip.js","components/mapart/blockSelectionAddCustom/blockSelectionAddCustom.js","images/null.png","images/textures.png","components/mapart/blockImage.js","components/mapart/blockSelection.js","components/mapart/workers/worker-builder.js","components/mapart/workers/nbt.js","components/mapart/greenButtons.js","components/mapart/workers/mapCanvas.js","components/mapart/mapPreview.js","components/mapart/autoCompleteInputBlockToAdd/autoCompleteInputBlockToAdd.js","components/mapart/bufferedNumberInput/bufferedNumberInput.js","components/mapart/mapSettings.js","components/mapart/materials.js","components/mapart/nbtReader.js","components/mapart/viewOnlineCommon/waila.js","components/mapart/viewOnline2D/viewOnline2D.js","components/mapart/viewOnline3D/pointerLockControls.js","components/mapart/viewOnline3D/viewOnline3D.js","components/mapart/mapartController.js","images/upload.png","components/root.js","index.js"],"names":["FAQ","props","_jsxs","className","children","_jsx","Link","to","undefined","includes","match","params","countryCode","href","target","rel","style","textAlign","alt","src","IMG_ClassicVsValley","Header","Component","render","getLocaleString","this","Locale","en","strings","Strings_en","flag","Flag_en","ua","Strings_ua","Flag_ua","et","Strings_et","Flag_et","flag_special","Flag_et_pop","lt","Strings_lt","Flag_lt","ru","Strings_ru","Flag_ru","de","Strings_de","Flag_de","pl","Strings_pl","Flag_pl","fr","Strings_fr","Flag_fr","it","Strings_it","Flag_it","pt","Strings_pt","Flag_pt","es","Strings_es","Flag_es","Strings_zh_Hans","Flag_zh_Hans","Strings_zh_Hant","Flag_zh_Hant","ja","Flag_ja","eo","Strings_eo","Flag_eo","Strings_pt_Br","Flag_pt_Br","Languages","Object","keys","map","language","React","Fragment","CookieManager","init","forEach","name","getCookie","setCookie","cname","cvalue","d","Date","setTime","getTime","expires","toUTCString","document","cookie","ca","split","i","length","c","charAt","substring","indexOf","touchCookie","defaultValue","cookieValue","Tooltip","constructor","arguments","state","hovering","handleMouseOver","setState","handleMouseOut","tooltipStyle","textStyleOverrides","display","onMouseOver","onMouseOut","tooltipText","BlockSelectionAddCustom","super","block_name","block_nbtTags","block_colourSetId","block_versions","E_KeyOrValue","key","value","examplesGroups","title","blocks","blockName","nbtTags","facing","half","versions","variant","type","onSettingChange_block_name","e","onSettingChange_block_nbtTags","tagIndex","keyOrValue","block_nbtTags_new","every","t","pop","push","onSettingChange_block_colourSetId","onSettingChange_block_versions","versionToToggle","block_versions_new","coloursJSON","supportedVersion_key","SupportedVersions","componentDidUpdate","prevProps","lastSelectedCustomBlock","loadBlockIntoForm","colourSetId","blockId","blockToLoad","blockToLoad_nbtTags","versionToLoad_nbtData","values","validVersions","find","version","nbtTag_key","nbtTag_value","entries","NBTArgs","blockToLoad_versions","supportedVersion_value","MCVersion","NBTName","onAddCustomBlock","onDeleteCustomBlock","examples","open","examplesGroup","block","outline","padding","marginBlockStart","marginBlockEnd","disabled","_ref","tagKey","tagValue","_ref2","checked","setting_customBlock_name","onChange","setting_customBlock_nbtTags","_ref3","setting_customBlock_colourSetId","backgroundColor","tonesRGB","normal","join","color","_ref4","colourSet","colourName","setting_customBlock_versions","_ref5","block_version","block_version_checked","customBlock_submit","colSpan","width","onClick","customBlock_delete","BlockImage","props_others","isNone","isUnknown","IMG_Null","displayName","backgroundImage","IMG_Textures","backgroundPositionX","backgroundPositionY","presetIndex","BlockSelection","getColourSetBox","optionValue_staircasing","background","MapModes","SCHEMATIC_NBT","staircaseModes","OFF","uniqueId","MAPDAT","cssRGB","CLASSIC","VALLEY","ON","dark","light","ON_UNOBTAINABLE","unobtainable","FULL_DARK","FULL_LIGHT","FULL_UNOBTAINABLE","Error","getColourSetTones","disabledTones","onToggleColourTone","cursor","has","filter","RGBArray","onChangeColourSetBlock","optionValue_version","optionValue_showOriginalBlocks","onOptionChange_showOriginalBlocks","selectedBlocks","presets","selectedPresetName","isDefaultPreset","onPresetChange","onDeletePreset","onSavePreset","onSharePreset","onGetPDNPaletteClicked","handleAddCustomBlock","handleDeleteCustomBlock","setting_showOriginalBlocks","presetsManagement","id","preset","localeKey","blockSelection","some","hidden","position","paddingLeft","zIndex","whiteSpace","margin","WorkerBuilder","Worker","worker","code","toString","lastIndexOf","blob","Blob","URL","createObjectURL","NBTWorker","args","optionValue_supportBlock","pixelsData","maps","currentSelectedBlocks","progressReportHead","exactColourCache","Map","TagTypes","NBTWriter","ArrayBuffer","DataView","Uint8Array","buffer","dataView","arrayView","offset","encodeUTF8","str","array","charCodeAt","accommodate","size","requiredLength","byteLength","newLength","newBuffer","newArrayView","set","fill","write","dataType","writeByType","bytes","writeTopLevelCompound","getData","slice","Map_NBT","mapColoursLayout","coloursLayout","mapMaterialsCounts","materials","NBT_json","entities","palette","author","DataVersion","physicalLayout","palette_colourSetId_paletteId","palette_paletteId_colourSetId","columnHeightsCache","constructPaletteLookups","nonZeroMaterials","fromEntries","_","setNBT_json_palette","paletteItemToPush","Name","toLowerCase","blockNBTData","Properties","NBTArg_key","setNBT_json_DataVersion","NBTVersion","returnPhysicalBlock","x","y","z","pos","getPhysicalLayout","columnNumber","getPhysicalLayout_individualColumn","postMessage","head","body","mapColoursLayoutColumn","currentHeight","physicalColumn","rowNumber","coloursLayoutBlock","tone","sort","elt1","elt2","plateaus","startIndex","endIndex","ascending","currentPlateauStartIndex","visibleBlocksHeight","physicalBlock","nonPlateauPulldownHeights","Number","MAX_SAFE_INTEGER","pullDownHeight","Math","min","plateauPulldownHeight","shift","columnMinimumY","reduce","a","b","concat","setNBT_json_blocks","setNBT_json_size","getNBT","nbtWriter","Map_Mapdat","dataVersion","data","scale","dimension","unlimitedTracking","trackingPosition","locked","height","xCenter","zCenter","colors","setNBT_json_colors","pixel","arrayOffset","mapdatId","exactRGBToColourSetIdAndTone","pixelRGB","RGBBinary","get","onmessage","headerMessage","toneKey","toneRGB","setupExactColourCache","mapSize_x","mapSize_z","whichMap_z","whichMap_x","coloursLayout_columnToPush","pixelsData_offset","colourSetIdAndTone","setupColoursLayoutsFromPixelsData","rowOfMaps","j","materials_new","mergeMaps","whichMap_y","NBT_Array","Mapdat_Bytes","GreenButtons","buttonWidth_viewOnline","buttonWidth_NBT_Joined","buttonWidth_NBT_Split","buttonWidth_Mapdat_Split","mapPreviewWorker_onFinishCallback","nbtWorker","getNBT_base","workerHeader","optionValue_mapSize_x","optionValue_mapSize_y","optionValue_mapdatFilenameUseId","optionValue_mapdatFilenameIdStart","uploadedImage_baseFilename","currentMaterialsData","mapPreviewWorker_inProgress","downloadBlobFile","onGetViewOnlineNBT","elt","alert","terminate","resetButtonWidths","numberOfSplitsCalculated","zipFile","JSZip","t0","performance","now","t1","console","log","NBT_Array_gzipped","gzip","file","generateAsync","then","content","downloadBlob","Mapdat_Bytes_gzipped","onViewOnlineClicked","onGetNBTClicked","onGetNBTSplitClicked","onGetMapdatSplitClicked","onGetMapdatSplitZipClicked","componentDidUpdate_shouldNBTWorkerTerminate","optionValue_modeNBTOrMapdat","optionValue_cropImage","optionValue_cropImage_zoom","optionValue_cropImage_percent_x","optionValue_cropImage_percent_y","optionValue_transparency","optionValue_transparencyTolerance","optionValue_betterColour","optionValue_dithering","optionValue_dithering_propagation_red","optionValue_dithering_propagation_green","optionValue_dithering_propagation_blue","optionValue_preprocessingEnabled","preProcessingValue_brightness","preProcessingValue_contrast","preProcessingValue_saturation","preProcessingValue_backgroundColourSelect","preProcessingValue_backgroundColour","uploadedImage","componentWillUnmount","buttons_mapModeConditional","floor","MapWorker","ColourMethods","DitherMethods","canvasImageData","colourSetsToUse","colourCache","labCache","lab50Cache","lab65Cache","rgb2lab","rgb","val","r1","g1","b1","pow","f","h","k","l","rgb2lab50","f1","cbrt","lab50","rgb2lab65","lab65","squaredEuclideanMetricColours","pixel1","pixel2","chosenColourMethod","colourMethodKey","MapartCraftDefault","L","Cie76_Lab50","Cie76_Lab65","Ciede2000_Lab50","Ciede2000_Lab65","lStd","aStd","bStd","cStd","sqrt","lSmp","aSmp","bSmp","cAvg","cAvgPow7","G","apStd","apSmp","cpStd","cpSmp","hpStd","abs","atan2","PI","hpSmp","dL","dC","cpStdtimescpSmpZero","dhp","hp","dH","sin","Lp","Cp","Lpminus50","Lpm50","T","cos","Sl","Sc","Sh","deltaTheta","exp","Rc","dLdivSl","dCdivSc","dHdivSh","r","g","findClosestColourSetIdAndToneAndRGBTo","closestPixel","shortestDistance","squareDistance","findClosest2ColourSetIdAndToneAndRGBTo","shortestDistance1","shortestDistance2","closestPixel1","closestPixel2","colourSetIdAndToneToRGB","newPixels","colourSetIdsToUse","toneKeys","mapMode","staircaseMode","setupColourSetsToUse","mapsRowToAdd","mapEntryToAdd","supportBlockCount","ditherMatrix","divisor","row","chosenDitherMethod","ditherMethodKey","None","FloydSteinberg","FloydSteinberg_20","FloydSteinberg_24","MinAvgErr","Burkes","SierraLite","Stucki","Atkinson","Atkinson_6","Atkinson_10","Atkinson_12","ditherDivisor","indexR","indexG","indexB","indexA","multimapWidth","multimap_x","multimap_y","closestColourSetIdAndTone","oldPixel","closestColour","Bayer44","Bayer22","Ordered33","quant_error","weight","getMapartImageDataAndMaterials","pixels","MapPreview","mapPreviewSizeScale","workerProgress","mapCanvasWorker","MapCanvasWorker","increasePreviewScale","decreasePreviewScale","canvasRef_source","createRef","canvasRef_display","fileInputRef","shouldCanvasUpdate_source","newProps","prevState","newState","propChanges","optionValue_pixelSize","shouldCanvasUpdate_display","updateCanvas_source","updateCanvas_display","closestSmoothColourTo","colourHex","rgbGroups_input","exec","colourRGB_input","parseInt","smallestDistance","colourRGB_return","coloursRGB_colourSet","colourRGB_colourSet","colourDistance","padStart","ctx_source","current","getContext","imageSmoothingEnabled","imageSmoothingQuality","clearRect","canvas","BackgroundColourModes","test","backgroundColour","SMOOTH","selectedBlockId","rect","fillStyle","CropModes","drawImage","CENTER","MANUAL","img_width","img_height","samplingWidth","samplingHeight","samplingOffset_x","samplingOffset_y","pixelationFactor","canvasWidth","canvasHeight","smallWidth","smallHeight","onGetMapMaterials","onMapPreviewWorker_begin","getImageData","putImageData","optionValue_showGridOverlay","onFileDialogEvent","ref","backgroundSize","click","visibility","AutoCompleteInputBlockToAdd","suggestionSelected","getRelevantSuggestions","suggestions_prefix","suggestions_includes","supportBlockMandatory","startsWith","handleTextChange","newValue","replace","setValue","onSuggestionClicked","suggestion","onFocus","relevantSuggestions","BufferedNumberInput","onInputChange","validators","onValidInput","newValue_buffer","newValue_int","validator","max","step","MapSettings","onOptionChange_version","onOptionChange_mapSize_x","onOptionChange_mapSize_y","onOptionChange_modeNBTOrMapdat","onOptionChange_cropImage","onOptionChange_cropImage_zoom","onOptionChange_cropImage_percent_x","onOptionChange_cropImage_percent_y","onOptionChange_showGridOverlay","onOptionChange_pixelSize","onOptionChange_staircasing","setOption_SupportBlock","onOptionChange_transparency","onOptionChange_transparencyTolerance","onOptionChange_mapdatFilenameUseId","onOptionChange_mapdatFilenameIdStart","onOptionChange_BetterColour","onOptionChange_dithering","onOptionChange_dithering_propagation_red","onOptionChange_dithering_propagation_green","onOptionChange_dithering_propagation_blue","onOptionChange_PreProcessingEnabled","onOptionChange_PreProcessingBrightness","onOptionChange_PreProcessingContrast","onOptionChange_PreProcessingSaturation","onOptionChange_PreProcessingBackgroundColourSelect","onOptionChange_PreProcessingBackgroundColour","optionValue_extras_moreStaircasingOptions","onOptionChange_extras_moreStaircasingOptions","setting_mode","setting_version","supportedVersion","setting_mapSize","isNaN","setting_crop","cropMode","setting_crop_zoom","setting_crop_percent_x","setting_crop_percent_y","settingGroup_cropping","setting_pixelSize","setting_grid","setting_staircasing","extra","settings_mapModeConditional","setting_transparency","setting_transparencyTolerance","settingGroup_transparency","setting_mapdatFilenameUseId","setting_mapdatFilenameIdStart","settingGroup_mapdatFilename","setting_betterColour","setting_dithering","setting_dithering_propagation_red","setting_dithering_propagation_green","setting_dithering_propagation_blue","setting_dithering_propagation","setting_preprocessing","setting_preprocessing_brightness","setting_preprocessing_contrast","setting_preprocessing_saturation","setting_preprocessing_background","backgroundColourMode","setting_preprocessing_backgroundColour","settingGroup_preprocessing","setting_extras_moreStaircasingOptions","Materials","onlyMaxPerSplit","onOnlyMaxPerSplitChange","currentState","formatMaterialCount","count","numberOfShulkers","numberOfStacks","remainder","n","getMaterialsCount_nonZeroMaterialsItems","materialsCount","materialCount","first","second","getMaterialsCount_supportBlock","colourSetIdAndBlockIdFromNBTName","nbtNameToColourSetId","selection","copyToClipboard","nonZeroMaterialsItems","mergedList","Array","counts","v","NBSP","String","fromCharCode","CRLF","results","nameMaxLength","padEnd","navigator","clipboard","writeText","supportBlockIds","NBTReader","loadBuffer","decodeUTF8","codepoints","byte","apply","read","readByType","arrayLength","returnArray","string_bytes_length","string_bytes","list_objectType","list_length","returnObject","tagType","array_length","Waila","selectedBlock","verticalAlign","ViewOnline2D","getNBTDecompressed","viewOnline_NBT","nbtReader","drawNBT","viewOnline_NBT_decompressed","canvasRef_viewOnline","paletteIdToColourSetIdAndBlockId","NBT_palette","paletteItem_index","paletteItem","paletteItemFound","argKey","argValue","img_textures","Image","onload","canvasRef_viewOnline_ctx","textBaseline","font","fillRect","currentY","processedNoobline","block_paletteId","block_coords","int_colourSetId","int_blockId","int_colourSetId_toDraw","int_blockId_toDraw","strokeStyle","strokeText","fillText","whichChunk_x","whichChunk_y","zoomFactor","canvasOffset_x","canvasOffset_y","mouse","down","movedSinceDown","handleScroll_document","preventDefault","handleScroll_canvas","zoomMultiplier","offsetX","offsetY","delta","wheelDelta","detail","bind","handleMouseDown","clientX","clientY","addEventListener","handleMouseMove","passive","handleMouseUp","canvas_width","clientWidth","canvas_height","clientHeight","block_x","block_z","selectedBlock_colourSetId","selectedBlock_blockId","removeEventListener","mouseMoved_x","mouseMoved_y","componentDidMount","onChooseViewOnline3D","component_controls","flexDirection","component_waila","component_size","size_x","size_y","size_z","marginRight","right","component_topBar","left","top","_euler","Euler","_vector","Vector3","_vector_up","_changeEvent","_lockEvent","_unlockEvent","_PI_2","PointerLockControls","EventDispatcher","camera","domElement","warn","isLocked","minPolarAngle","maxPolarAngle","scope","onMouseMove","event","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","error","connect","disconnect","dispose","getObject","getDirection","direction","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","up","addScaledVector","moveRight","moveUp","lock","requestPointerLock","unlock","exitPointerLock","BlockWorld","options","faces","uvRow","dir","vertices","uv","chunkSize","chunks","chunks_mesh","renderRequested","animationFrameRequestID","moveX","moveY","startAnimationLoop","renderer","scene","window","requestAnimationFrame","stopAnimationLoop","cancelAnimationFrame","handleKeyDown","controls","fov","updateProjectionMatrix","handleKeyUp","handlePointerDown","canvasRef","recordMovement","selectBlockIfNoMovement","selectBlock","handleTouchStart","handleWindowResize","setSize","aspect","tileSize","tileTextureWidth","tileTextureHeight","camera_x","camera_y","camera_z","onSelectBlockCallback","THREE","add","texture","load","magFilter","minFilter","material","side","alphaTest","transparent","addEventListeners","removeEventListeners","computeBlockOffset","blockX","euclideanModulo","getChunkKey","getChunkForBlock","addChunkForBlock","chunkKey","chunk","getBlock","blockOffset","setBlock","start","end","setFromMatrixPosition","matrixWorld","unproject","intersection","intersectRay","dx","dy","dz","lenSq","len","ix","iy","iz","stepX","stepY","stepZ","txDelta","tyDelta","tzDelta","xDist","yDist","zDist","txMax","Infinity","tyMax","tzMax","steppedIndex","generateGeometryDataForChunk","chunkX","chunkY","chunkZ","verticesComponents","normalsComponents","uvs","indices","startX","startY","startZ","blockY","blockZ","neighbor","numberOfVertices","updateChunkGeometry","mesh","geometry","setAttribute","Float32Array","setIndex","computeBoundingSphere","updateBlockGeometry","updatedChunkKeys","ox","oy","oz","ViewOnline3D","handleEscapeKeyDown","handleViewOnline3DEscape","schematic_size_x","schematic_size_y","schematic_size_z","world","bottom","MapartController","viewOnline_3D","eventListener_dragover","stopPropagation","eventListener_drop","files","dataTransfer","imgUrl","loadUploadedImageFromURL","eventListener_paste","clipboardData","handleChangeColourSetBlock","handleChangeColourSetBlocks","setsAndBlocks","presetIndexes","blockIdAndBlock","handleToggleColourTone","delete","mode","mcVersion","supportedVersionFound","cropValue","staircasingValue","colourValue","ditheringValue","text","handleGetPDNPaletteClicked","paletteText","selectedBlocksToURL","numberOfColoursExported","toneKeysToExport","colours","toneKeyToExport","toUpperCase","handlePresetChange","presetName","selectedPreset","DefaultPresets","defaultPreset","handleDeletePreset","confirm","presets_new","JSON","stringify","handleSavePreset","presetToSave_name","prompt","otherPresets","newPreset","presetQueryString","handleSharePreset","URLToPreset","encodedPreset","onCorruptedPreset","presetRegex","encodedColourSetId","encodedBlockId","decodedColourSetId","decodedPresetIndex","Q","R","S","U","V","W","X","Y","Z","decodedBlock","decodedBlockId","handleSetMapMaterials","block_name_trimmed","trim","blockToAdd","addedFirstVersion","block_version_isSelected","nbtTag_key_trimmed","nbtTag_value_trimmed","customBlocks_new","parse","customBlock","getMergedColoursJSON","cookiesPresets_loaded","cookiesPresets_updated","cookiesPreset_default","cookiesPreset_loaded","cookie_customBlocks","Set","cookieMCVersion","URLParams","location","searchParams","decodedPresetBlocks","customBlocks","coloursJSON_custom","imageURL","baseFilename","img","filename","downloadURL","downloadElt","createElement","download","appendChild","revokeObjectURL","removeChild","Root","displayingCorruptedPresetWarning","displayingEdgeWarning","stringName","languageCodeOverride","stringSegments","stringLast","folder","stringSegment","onEdgeWarningButtonClick","onCorruptedPresetWarningButtonClick","showCorruptedPresetWarning","ReactDOM","StrictMode","Router","basename","Switch","Route","path","component","getElementById"],"mappings":"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","file":"static/js/main.c3fb9429.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/classicVsValley.fb0924c8.png\";","import { Link } from \"react-router-dom\";\n\nimport \"./faq.css\";\nimport IMG_Palette from \"../images/Palette128_Unobtainable_Trans.png\";\nimport IMG_ClassicVsValley from \"../images/classicVsValley.png\";\n\nfunction FAQ(props) {\n  return (\n    <div className=\"FAQ\">\n      <Link to={`/${![undefined, \"en\"].includes(props.match.params.countryCode) ? props.match.params.countryCode : \"\"}`}>\n        <h3>Close</h3>\n      </Link>\n\n      <h1>FAQ</h1>\n\n      <h2>How do I get started?</h2>\n      <a href=\"https://youtu.be/bJ-wX68WNHM\" target=\"_blank\" rel=\"noopener noreferrer\">\n        Video tutorial\n      </a>\n\n      <h2>General</h2>\n      <b>Why does the output change with the same image and settings?</b>\n      <p>\n        The JPEG decoding and scaling algorithms vary between browsers and get changed all the time. If you wish to be 100% sure your image stays the same,\n        right click on the <em>Map preview</em> and choose <em>Save image as...</em>. Next time you can upload the image you saved.\n      </p>\n\n      <h2>Schematic (.nbt)</h2>\n      <b>What do I do with the NBT file?</b>\n      <p>Use it like a .schematic file.</p>\n\n      <b>How can I use the NBT file?</b>\n      <p>\n        You can use it with programs like{\" \"}\n        <a href=\"https://cubical.xyz/\" target=\"_blank\" rel=\"noopener noreferrer\">\n          cubical.xyz\n        </a>\n        ,{\" \"}\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\n          MCEdit\n        </a>{\" \"}\n        and mods like{\" \"}\n        <a href=\"https://minecraft.curseforge.com/projects/schematica\" target=\"_blank\" rel=\"noopener noreferrer\">\n          Schematica\n        </a>{\" \"}\n        /{\" \"}\n        <a href=\"https://minecraft.curseforge.com/projects/litematica\" target=\"_blank\" rel=\"noopener noreferrer\">\n          Litematica\n        </a>\n        . You can also import them into your game directly with a structure block - although it might require a redstone power source (\n        <a href=\"https://github.com/rebane2001/mapartcraft/issues/100\" target=\"_blank\" rel=\"noopener noreferrer\">\n          #100\n        </a>\n        ). It might be a better idea to use a datafile instead - it's easier and gives more colors.\n      </p>\n\n      <b>...but I need a .schematic file!</b>\n      <p>\n        Import it into{\" \"}\n        <a href=\"https://cubical.xyz/\" target=\"_blank\" rel=\"noopener noreferrer\">\n          cubical.xyz\n        </a>{\" \"}\n        or{\" \"}\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\n          MCEdit\n        </a>{\" \"}\n        and export as .schematic. <em>Note that if you're using MCEdit or Cubical, you must export the map as 1.12.2.</em> You do not need a .schematic file for\n        use with Baritone; use Schematica and the \"#schematica\" command.\n      </p>\n\n      <b>But MCEdit doesn't work!</b>\n      <p>\n        Make sure you're using{\" \"}\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\n          MCEdit Unified\n        </a>{\" \"}\n        and importing the NBT as a schematic, NOT loading it as a world. Alternatively, use Cubical.\n      </p>\n\n      <b>Why is there a row of extra blocks?</b>\n      <p>\n        The shade a block shows up as on the map is decided by the block North of it; if the Northern block is higher then a darker tone shows, else if the\n        Northern block is lower then a lighter tone shows, else a normal tone shows. Thus an extra row of blocks (colloquially known as a noobline) exists at\n        the top of a map to shade the top row properly.\n      </p>\n\n      <b>How do I align the map?</b>\n      <p>\n        When you have found a suitable place to build your map (eg above an ocean) make sure to open the map first and find the bottom left corner for aligning\n        your schematic. Maps in Minecraft align to a fixed 128x128 grid. North is always the up-direction on maps and you shouldn't need to rotate the schematic.\n      </p>\n\n      <h2>Datafile (.dat)</h2>\n      <b>What is a map.dat file?</b>\n      <p>\n        '.dat' is the native format Minecraft stores map data in, meaning you can use it to import maps into your worlds without needing to build a physical\n        structure. It also enables you to use a fourth extra shade of color not accessible in survival.\n      </p>\n\n      <b>What do I do with the map.dat file?</b>\n      <p>\n        You can use the map.dat file in singleplayer or a server you own. Create a new map in-game, go to your world's save file, then the data folder and from\n        there you can replace map_xxx.dat files. MapartCraft downloads a .zip file containing all of the 1x1 map.dat files.\n      </p>\n\n      <h2>Settings</h2>\n      <b>Map size?</b>\n      <p>\n        This will define how many maps you will create for your picture. When creating bigger maps, it's recommended to split it into multiple schematics (lest\n        large staircased maps stretch above the world height limit). This can be done with the \"DOWNLOAD AS 1X1 SPLIT\" button which downloads all the 1x1 NBTs in a .zip file.\n      </p>\n\n      <b>My image is stretched!</b>\n      <p>Change your map size, enable the crop option, or edit your image with an image editor.</p>\n\n      <b>'Staircasing'?</b>\n      <p>\n        This will make your map 3D. Doing so will give you 3 times the colors, often producing a much richer mapart, but it will also make the map a lot harder\n        to build, as it is not flat. 3D 'Classic' and 'Valley' modes produce the exact same resulting map image, however they are built differently; 'Valley' mode allows the map to be built without any downwards staircases, which may be easier in survival. Observe the difference:\n      </p>\n      <div style={{ textAlign: \"center\" }}>\n        <img alt=\"classicVsValley.png\" src={IMG_ClassicVsValley} style={{\"maxWidth\": \"75%\"}}></img>\n      </div>\n      <p>\n        More staircasing modes can be enabled from the <em>Extras</em> settings tab.\n      </p>\n\n      <b>Better color?</b>\n      <p>\n        This setting will give you more natural colors. Disabling this will make the website faster and give you slightly worse colors. It is recommended to\n        keep this enabled.\n      </p>\n\n      <b>Dithering?</b>\n      <p>\n        This will add grain to your image to make it look a lot smoother. Floyd-Steinberg dithering is the most accurate, but the Ordered/Bayer dithering will\n        usually have less artifacts and gives the image an unique style. It is usually recommended to disable dithering for flat-colored artwork.\n      </p>\n\n      <b>Presets?</b>\n      <p>\n        You can use presets to save and load block configurations. Pick your blocks and click \"Save\" to save them as a preset, pick a preset to load it and\n        click \"Delete\" to delete the loaded preset. It is also possible to share a link for your preset with others.\n      </p>\n\n      <h2>Custom Blocks</h2>\n      <p>Custom blocks can be added from the bottom of the blocks selection pane. Different versions of a block can be added for the same block name, eg for 1.12.2 and 1.13.2+. Some examples are provided in the 'examples' section. NBT tags / block states can be found on the <a href=\"https://minecraft.wiki/w/Block_states\" target=\"_blank\" rel=\"noopener noreferrer\">Minecraft Wiki</a>. To edit an existing custom block, select it, edit the tags / versions etc, and then click the 'add' button to overwrite. Note that presets URLs do not support custom blocks.</p>\n\n      <div style={{ textAlign: \"center\" }}>\n        <img alt=\"Palette\" src={IMG_Palette} />\n      </div>\n    </div>\n  );\n}\n\nexport default FAQ;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAFWElEQVR42u2dS28bVRxHx5mJ37Fjx3ZsN3YebhunNEuEkHgsilCFWPJYIJD4Aiz4EvkCSF2yJEhsWNOyBUWAKOpL6kOkavNo0jaYxEnctGFVL88ggbrpOdvf+PpOc3yr+5977ySWlpaOA2Dr4lcUB9v3P8b8xgLGwbnut5iv/N3D/M3r72G+fP8y5gsL3MHr/PXBiTtjfP+pmM8Hl+Iu4PgG5xd7fAMjgbzUKIACiAKIAogCiALIy0a0uLiIF9z7I4N5rnca8wcx89hul9v/83Ef8zMPW5iP9e7wPPoEd/Bemvtf2yxhvsq3F5SDmAtqMXWA1Zg/cL/vCCAKIAogCiAKIAogCiDDaWK328ULkhWeCCc25jC/WecOnDzJ7Ve2IsxP325int/IY16vcwfzCe5/JVvFPJ3jz48HMYWGCsf1mI9HUeQIIAogCiAKIAogCiAKIMNpYqfTwQuOyryw/SDXxrzA0+RgZobbL6d4HjtXnsQ8l+OJeLXKHcw94f6XMw3MUzF1gEIQs3GgzHE1ZR1A/C9AFEAUQBRAFEAUQP41iS8+/RDPB1j77UdsYBDyvoCHuXHM58dWML+yz+vm21u8P3/l4SbmC51ZzNcPnvI0vf8M841BzG9scJfzEs/jO7vc/s/bO44AogCiAKIAogCiAKIA8pzo1PQUG3IriflhNMGFhiI/b58tcftre1wHmDoscB1h9zHm9Ql+4N7f4wUBtZDrAHsHMb+xcIPzwijGjeMQ89RO6AggCiAKIAogCiAKIAogwzrA7BSva++P8Tx9f5TPydsv8UF3rSq3P57iDfDNHd7/n0lx+9VSEfPtiOsAE8+OMN8aiWL+BNy/IObfvzbgef5oOOIIIAogCiAKIAogCiAKIMM6QKvB++u38vw8uj/K8+idIq8XaE5w+8WQ6wC1mP3/6SS3P1Hk9QT5YIB5acB1gFwQUwd4yv0L8lwHqPS5/WTkegBRAFEAUQBRAFEAUQAZkjj3WQvPB3i79To2sP6I5/ntCxcw//WDJcyj6DLmy5vLmH80+Tnmh6s/Yb49wve3tvY+5mfaX2P+xrufcJng8BvMv9s7j/n+75OOAKIAogCiAKIAogCiADKcZtems3jB2fkW5tkN3lfQjenA5tQi5qOjj7iBY45b7RmeJ+9e5QZCfnFfr8f9b1R538Li2VcwP9rn9QoXe3xOY7TedgQQBRAFEAUQBRAFEAWQ4TSxMsXn8M2f4nn+09T0f6oDXGvyFcnkLW5gj+Nmk+sYexs8T++P8PkH2Sz3f7LM7Xe785g/2eXPFx/z+w6Or5xyBBAFEAUQBRAFEAUQBZBhHaDc4P33czO8rrz3jN830InpQK3GV6RS/P3BNseT9Sbmfxf5fIFHIb/3MJPh/ldKvN6i05njOkCP+zdW4Of9T8odRwBRAFEAUQBRAFEAUQB5TiL4so0r69/5gc/L37+yjvlCndcTPEjzPP3uNq8HuPnqa5hPZPgcveIv1zC/fZ7X3Z+5yvsW3ury/V8+4t/gpeXvE44AogCiAKIAogCiAKIA8j8RBfP8vHpyhc/L3435gtk07zuIcrzuvrfD5+lHtTrm2XxMHSC9yu3HrIcocxkkOD3NdY71wYgjgCiAKIAogCiAKIAogLy4OsAc1wEqBXYk5q13QTvN+w4GWX7v4HrE3xBWqlwHKPDnC0m+/3CK2x8fP8R87gTXEa4OQkcAUQBRAFEAUQBRAFEAeXF1gDbP08t5PpA/EbNqvZlKYf5Xhs/DH4v4eX5U5vf6pceTmOdTvF4hbHD7hUIP83aD6wjlA+sAogCiAKIAogCiAKIA8sL4B0z245ksDQ2eAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport \"./header.css\";\n\nclass Header extends Component {\n  render() {\n    const { getLocaleString } = this.props;\n    return (\n      <div className=\"header\">\n        <h3>\n          <Link to={`/${![undefined, \"en\"].includes(this.props.countryCode) ? this.props.countryCode + \"/\" : \"\"}faq`}>\n            <span className=\"FAQTextButton\">{getLocaleString(\"FAQ/FAQ\")}</span>\n          </Link>\n          <span> | </span>\n          <a href=\"https://youtu.be/j-4RXPkJKU8\" target=\"_blank\" rel=\"noopener noreferrer\">\n            {getLocaleString(\"FAQ/VIDEO-TUTORIAL\")}\n          </a>\n          <span> | </span>\n          <a href=\"https://github.com/hahaluckyme/mapartcraft\" target=\"_blank\" rel=\"noopener noreferrer\">\n            GitHub\n          </a>\n          <span> | </span>\n          <a href=\"https://discord.gg/r7Tuerq\" target=\"_blank\" rel=\"noopener noreferrer\">\n            2b2t Mapart Discord\n          </a>\n          <span> | </span>\n          <a href=\"https://area51.selfadjointoperator.com/mapartcraft/\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Beta\n          </a>\n        </h3>\n        <p>\n          {getLocaleString(\"DESCRIPTION/1\")}\n          <a href=\"https://www.reddit.com/r/2b2t/\" target=\"_blank\" rel=\"noopener noreferrer\">\n            2b2t\n          </a>\n          {getLocaleString(\"DESCRIPTION/2\")}\n          <br></br>\n          {getLocaleString(\"DESCRIPTION/3\")}\n          <a href=\"https://redd.it/2yck3f\" target=\"_blank\" rel=\"noopener noreferrer\">\n            {getLocaleString(\"DESCRIPTION/4\")}\n          </a>\n          {getLocaleString(\"DESCRIPTION/5\")}\n          <br></br>\n          <em>\n            {getLocaleString(\"DESCRIPTION/6\")}\n            <a href=\"https://rebane2001.com/mapartcraft/\" target=\"_blank\" rel=\"noopener noreferrer\">MapartCraft</a>\n            {getLocaleString(\"DESCRIPTION/7\")}\n            {\".\"}\n          </em>\n          <br></br>\n          <b>\n            {getLocaleString(\"FAQ/PLEASE-READ-1\")}\n            <Link to={`/${![undefined, \"en\"].includes(this.props.countryCode) ? this.props.countryCode + \"/\" : \"\"}faq`}>\n              <span className=\"FAQTextButton\">{getLocaleString(\"FAQ/FAQ\")}</span>\n            </Link>\n            {getLocaleString(\"FAQ/PLEASE-READ-2\")}\n          </b>\n        </p>\n      </div>\n    );\n  }\n}\n\nexport default Header;\n","export default __webpack_public_path__ + \"static/media/flag.79a9235b.svg\";","export default __webpack_public_path__ + \"static/media/flag.4e2d656c.svg\";","export default __webpack_public_path__ + \"static/media/flag.abd4909f.svg\";","export default __webpack_public_path__ + \"static/media/flag.e764ed7e.svg\";","export default __webpack_public_path__ + \"static/media/flag.1d6c7aaf.svg\";","export default __webpack_public_path__ + \"static/media/flag.7d8cfc96.svg\";","export default __webpack_public_path__ + \"static/media/flag_pop.4141ec11.svg\";","export default __webpack_public_path__ + \"static/media/flag.cb7a79a1.svg\";","export default __webpack_public_path__ + \"static/media/flag.3ee8d817.svg\";","export default __webpack_public_path__ + \"static/media/flag.1f134dd5.svg\";","export default __webpack_public_path__ + \"static/media/flag.fc8a3ce6.svg\";","export default __webpack_public_path__ + \"static/media/flag.a3f20782.svg\";","export default __webpack_public_path__ + \"static/media/flag.3fe6473c.svg\";","export default __webpack_public_path__ + \"static/media/flag.06daf36a.svg\";","export default __webpack_public_path__ + \"static/media/flag.ea665cae.svg\";","export default __webpack_public_path__ + \"static/media/flag.23ab2621.svg\";","export default __webpack_public_path__ + \"static/media/flag.0ab17bb9.svg\";","import Flag_de from \"./de/flag.svg\";\nimport Strings_de from \"./de/strings.json\";\n\nimport Flag_ua from \"./ua/flag.svg\";\nimport Strings_ua from \"./ua/strings.json\";\n\nimport Flag_en from \"./en/flag.svg\";\nimport Strings_en from \"./en/strings.json\";\n\nimport Flag_eo from \"./eo/flag.svg\";\nimport Strings_eo from \"./eo/strings.json\";\n\nimport Flag_es from \"./es/flag.svg\";\nimport Strings_es from \"./es/strings.json\";\n\nimport Flag_et from \"./et/flag.svg\";\nimport Flag_et_pop from \"./et/flag_pop.svg\";\nimport Strings_et from \"./et/strings.json\";\n\nimport Flag_fr from \"./fr/flag.svg\";\nimport Strings_fr from \"./fr/strings.json\";\n\nimport Flag_it from \"./it/flag.svg\";\nimport Strings_it from \"./it/strings.json\";\n\nimport Flag_lt from \"./lt/flag.svg\";\nimport Strings_lt from \"./lt/strings.json\";\n\nimport Flag_pt from \"./pt/flag.svg\";\nimport Strings_pt from \"./pt/strings.json\";\n\nimport Flag_ru from \"./ru/flag.svg\";\nimport Strings_ru from \"./ru/strings.json\";\n\nimport Flag_zh_Hans from \"./zh-Hans/flag.svg\";\nimport Strings_zh_Hans from \"./zh-Hans/strings.json\";\n\nimport Flag_zh_Hant from \"./zh-Hant/flag.svg\";\nimport Strings_zh_Hant from \"./zh-Hant/strings.json\";\n\nimport Flag_pl from \"./pl/flag.svg\";\nimport Strings_pl from \"./pl/strings.json\";\n\nimport Flag_pt_Br from \"./pt-Br/flag.svg\";\nimport Strings_pt_Br from \"./pt-Br/strings.json\";\n\nimport Flag_ja from \"./ja/flag.svg\";\nimport Strings_ja from \"./ja/strings.json\";\n\nconst Locale = {\n  en: { strings: Strings_en, flag: Flag_en },\n  ua: { strings: Strings_ua, flag: Flag_ua },\n  et: { strings: Strings_et, flag: Flag_et, flag_special: Flag_et_pop },\n  lt: { strings: Strings_lt, flag: Flag_lt },\n  ru: { strings: Strings_ru, flag: Flag_ru },\n  de: { strings: Strings_de, flag: Flag_de },\n  pl: { strings: Strings_pl, flag: Flag_pl },\n  fr: { strings: Strings_fr, flag: Flag_fr },\n  it: { strings: Strings_it, flag: Flag_it },\n  pt: { strings: Strings_pt, flag: Flag_pt },\n  es: { strings: Strings_es, flag: Flag_es },\n  \"zh-Hans\": { strings: Strings_zh_Hans, flag: Flag_zh_Hans },\n  \"zh-Hant\": { strings: Strings_zh_Hant, flag: Flag_zh_Hant },\n  ja: { strings: Strings_ja, flag: Flag_ja },\n  eo: { strings: Strings_eo, flag: Flag_eo },\n  \"pt-Br\": { strings: Strings_pt_Br, flag: Flag_pt_Br },\n};\n\nexport default Locale;\n","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport Locale from \"../locale/locale\";\n\nimport \"./languages.css\";\n\nclass Languages extends Component {\n  render() {\n    return (\n      <div className=\"languages\">\n        {Object.keys(Locale).map((language) => (\n          <div className=\"language\" key={language}>\n            {language === \"et\" ? (\n              <React.Fragment>\n                <Link to={`/${language}`}>\n                  <img src={Locale[language].flag} alt={language} className={`flag flag_${language}`} />\n                  <img key=\"et_pop\" src={Locale[language].flag_special} alt=\"et_pop\" className={\"flag flag_et_pop\"} />\n                </Link>\n              </React.Fragment>\n            ) : (\n              <Link to={`/${language === \"en\" ? \"\" : language}`}>\n                <img src={Locale[language].flag} alt={language} className={`flag flag_${language}`} />\n              </Link>\n            )}\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default Languages;\n","class CookieManager {\n  static init() {\n    // Handle cookie migration\n    const cookieNames = [\"presets\", \"mcversion\", \"customBlocks\"];\n    cookieNames.forEach(name => {\n      if (this.getCookie(`mapartcraft_${name}`) === null && this.getCookie(name) !== null) {\n        this.setCookie(`mapartcraft_${name}`, this.getCookie(name));\n      }\n    });\n  }\n\n  //Thx\n  //https://www.w3schools.com/js/js_cookies.asp\n  static setCookie(cname, cvalue) {\n    let d = new Date();\n    d.setTime(d.getTime() + 9000 * 24 * 60 * 60 * 1000);\n    let expires = \"expires=\" + d.toUTCString();\n    document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\";\n  }\n\n  static getCookie(cname) {\n    let name = cname + \"=\";\n    let ca = document.cookie.split(\";\");\n    for (let i = 0; i < ca.length; i++) {\n      let c = ca[i];\n      while (c.charAt(0) === \" \") {\n        c = c.substring(1);\n      }\n      if (c.indexOf(name) === 0) {\n        return c.substring(name.length, c.length);\n      }\n    }\n    return null;\n  }\n\n  static touchCookie(cname, defaultValue) {\n    const cookieValue = this.getCookie(cname);\n    if (cookieValue !== null) {\n      return cookieValue;\n    } else {\n      this.setCookie(cname, defaultValue);\n      return defaultValue;\n    }\n  }\n}\n\nexport default CookieManager;\n","import React, { Component } from \"react\";\n\nimport \"./tooltip.css\";\n\nclass Tooltip extends Component {\n  state = {\n    hovering: false,\n  };\n\n  handleMouseOver = () => {\n    this.setState({ hovering: true });\n  };\n\n  handleMouseOut = () => {\n    this.setState({ hovering: false });\n  };\n\n  render() {\n    const tooltipStyle = this.props.textStyleOverrides !== undefined\n      ? {\n          display: this.state.hovering ? \"unset\" : \"none\",\n          ...this.props.textStyleOverrides,\n        }\n      : { display: this.state.hovering ? \"unset\" : \"none\" };\n    return (\n      <div className=\"tooltipContainer\">\n        <div onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n          {this.props.children}\n        </div>\n        <p className=\"tooltipText\" style={tooltipStyle}>\n          {this.props.tooltipText}\n        </p>\n      </div>\n    );\n  }\n}\n\nexport default Tooltip;\n","import React, { Component } from \"react\";\n\nimport SupportedVersions from \"../json/supportedVersions.json\";\n\nimport \"./blockSelectionAddCustom.css\";\n\nclass BlockSelectionAddCustom extends Component {\n  state = {\n    block_name: \"\",\n    block_nbtTags: [[\"\", \"\"]],\n    block_colourSetId: null,\n    block_versions: {},\n  };\n\n  E_KeyOrValue = {\n    key: 0,\n    value: 1,\n  };\n\n  examplesGroups = [\n    {\n      title: \"Stairs\",\n      blocks: [\n        {\n          blockName: \"birch_stairs\",\n          nbtTags: {\n            facing: \"north|east|south|west\",\n            half: \"top|bottom\",\n          },\n          versions: [\"1_12_2\", \"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\n        },\n      ],\n    },\n    {\n      title: \"Slabs\",\n      blocks: [\n        {\n          blockName: \"stone_slab\",\n          nbtTags: {\n            variant: \"cobblestone\",\n            half: \"top|bottom\",\n          },\n          versions: [\"1_12_2\"],\n        },\n        {\n          blockName: \"cobblestone_slab\",\n          nbtTags: {\n            type: \"top|bottom\",\n          },\n          versions: [\"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\n        },\n      ],\n    },\n    {\n      title: \"'Alpha slabs'\",\n      blocks: [\n        {\n          blockName: \"stone_slab\",\n          nbtTags: {\n            variant: \"wood_old\",\n            half: \"top|bottom\",\n          },\n          versions: [\"1_12_2\"],\n        },\n        {\n          blockName: \"petrified_oak_slab\",\n          nbtTags: {\n            type: \"top|bottom\",\n          },\n          versions: [\"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\n        },\n      ],\n    },\n  ];\n\n  constructor(props) {\n    super(props);\n    const { coloursJSON } = props;\n    this.state.block_colourSetId = Object.keys(coloursJSON)[0];\n    for (const supportedVersion_key of Object.keys(SupportedVersions)) {\n      this.state.block_versions[supportedVersion_key] = false;\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const { lastSelectedCustomBlock } = this.props;\n    if (prevProps.lastSelectedCustomBlock !== lastSelectedCustomBlock) {\n      this.loadBlockIntoForm(lastSelectedCustomBlock.colourSetId, lastSelectedCustomBlock.blockId);\n    }\n  }\n\n  loadBlockIntoForm(colourSetId, blockId) {\n    const { coloursJSON } = this.props;\n    const blockToLoad = coloursJSON[colourSetId].blocks[blockId];\n    let blockToLoad_nbtTags = [];\n    const versionToLoad_nbtData = Object.values(blockToLoad.validVersions).find((version) => typeof version !== \"string\");\n    for (const [nbtTag_key, nbtTag_value] of Object.entries(versionToLoad_nbtData.NBTArgs)) {\n      blockToLoad_nbtTags.push([nbtTag_key, nbtTag_value]);\n    }\n    blockToLoad_nbtTags.push([\"\", \"\"]);\n    const blockToLoad_versions = {};\n    for (const [supportedVersion_key, supportedVersion_value] of Object.entries(SupportedVersions)) {\n      if (supportedVersion_value.MCVersion in blockToLoad.validVersions) {\n        blockToLoad_versions[supportedVersion_key] = true;\n      } else {\n        blockToLoad_versions[supportedVersion_key] = false;\n      }\n    }\n    this.setState({\n      block_name: versionToLoad_nbtData.NBTName,\n      block_nbtTags: blockToLoad_nbtTags,\n      block_colourSetId: colourSetId,\n      block_versions: blockToLoad_versions,\n    });\n  }\n\n  onSettingChange_block_name = (e) => {\n    this.setState({ block_name: e.target.value });\n  };\n\n  onSettingChange_block_nbtTags = (e, tagIndex, keyOrValue) => {\n    const { block_nbtTags } = this.state;\n    let block_nbtTags_new = [...block_nbtTags];\n    block_nbtTags_new[tagIndex][keyOrValue] = e.target.value;\n    if (\n      tagIndex === block_nbtTags_new.length - 2 &&\n      block_nbtTags_new[block_nbtTags_new.length - 2].every((t) => t === \"\") &&\n      block_nbtTags_new[block_nbtTags_new.length - 1].every((t) => t === \"\")\n    ) {\n      // remove last tags inputs if they are empty and we have just made the penultimate tag inputs empty\n      block_nbtTags_new.pop();\n    } else if (tagIndex === block_nbtTags_new.length - 1) {\n      // always keep a blank set of inputs at the end for further tags\n      block_nbtTags_new.push([\"\", \"\"]);\n    }\n    this.setState({ block_nbtTags: block_nbtTags_new });\n  };\n\n  onSettingChange_block_colourSetId = (e) => {\n    this.setState({ block_colourSetId: e.target.value });\n  };\n\n  onSettingChange_block_versions = (versionToToggle) => {\n    let block_versions_new = { ...this.state.block_versions };\n    block_versions_new[versionToToggle] = !block_versions_new[versionToToggle];\n    this.setState({ block_versions: block_versions_new });\n  };\n\n  render() {\n    const { getLocaleString, coloursJSON, onAddCustomBlock, onDeleteCustomBlock } = this.props;\n    const { block_name, block_nbtTags, block_colourSetId, block_versions } = this.state;\n    const examples = (\n      <details open={false}>\n        <summary>{getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/EXAMPLES\")}</summary>\n        {this.examplesGroups.map((examplesGroup) => (\n          <div key={examplesGroup.title}>\n            <b>{examplesGroup.title}</b>\n            {examplesGroup.blocks.map((block) => (\n              <div\n                key={block.blockName}\n                style={{\n                  outline: \"0.1em solid white\",\n                  padding: \"0.2em\",\n                  marginBlockStart: \"0.2em\",\n                  marginBlockEnd: \"0.2em\",\n                }}\n              >\n                <table>\n                  <tbody>\n                    <tr>\n                      <th>\n                        <b>\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/BLOCK-NAME\")}\n                          {\":\"}\n                        </b>{\" \"}\n                      </th>\n                      <td style={{ textAlign: \"right\" }}>\n                        {\"minecraft:\"}\n                        <input type=\"text\" value={block.blockName} disabled={true} />\n                      </td>\n                    </tr>\n                    <tr>\n                      <th>\n                        <b>\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NBT-TAGS\")}\n                          {\":\"}\n                        </b>{\" \"}\n                      </th>\n                      <td style={{ textAlign: \"right\" }}>\n                        {Object.entries(block.nbtTags).map(([tagKey, tagValue]) => (\n                          <div key={tagKey}>\n                            <input type=\"text\" value={tagKey} disabled={true} />\n                            {\":\"}\n                            <input type=\"text\" value={tagValue} disabled={true} />\n                            <br />\n                          </div>\n                        ))}\n                      </td>\n                    </tr>\n                    <tr>\n                      <th>\n                        <b>\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/VERSIONS\")}\n                          {\":\"}\n                        </b>{\" \"}\n                      </th>\n                      <td>\n                        {Object.entries(SupportedVersions).map(([supportedVersion_key, supportedVersion_value]) => (\n                          <React.Fragment key={supportedVersion_key}>\n                            <input type=\"checkbox\" checked={block.versions.includes(supportedVersion_key)} disabled={true} />\n                            {supportedVersion_value.MCVersion}{\" \"}\n                          </React.Fragment>\n                        ))}\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            ))}\n            <br />\n          </div>\n        ))}\n      </details>\n    );\n    const setting_customBlock_name = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/BLOCK-NAME\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td style={{ textAlign: \"right\" }}>\n          {\"minecraft:\"}\n          <input type=\"text\" value={block_name} onChange={this.onSettingChange_block_name} />\n        </td>\n      </tr>\n    );\n    const setting_customBlock_nbtTags = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NBT-TAGS\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td style={{ textAlign: \"right\" }}>\n          {block_nbtTags.map(([tagKey, tagValue], tagIndex) => (\n            <div key={tagIndex}>\n              <input type=\"text\" value={tagKey} onChange={(e) => this.onSettingChange_block_nbtTags(e, tagIndex, this.E_KeyOrValue.key)} />\n              {\":\"}\n              <input type=\"text\" value={tagValue} onChange={(e) => this.onSettingChange_block_nbtTags(e, tagIndex, this.E_KeyOrValue.value)} />\n              <br />\n            </div>\n          ))}\n        </td>\n      </tr>\n    );\n    const setting_customBlock_colourSetId = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/COLOUR-SET\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <select\n            value={block_colourSetId}\n            onChange={this.onSettingChange_block_colourSetId}\n            style={{\n              backgroundColor: `rgb(${coloursJSON[block_colourSetId].tonesRGB.normal.join(\", \")})`,\n              color:\n                coloursJSON[block_colourSetId].tonesRGB.normal[0] * 0.299 +\n                  coloursJSON[block_colourSetId].tonesRGB.normal[1] * 0.587 +\n                  coloursJSON[block_colourSetId].tonesRGB.normal[2] * 0.114 >\n                186\n                  ? \"black\"\n                  : \"white\",\n            }}\n          >\n            {Object.entries(coloursJSON).map(([colourSetId, colourSet]) => (\n              <option\n                key={colourSetId}\n                value={colourSetId}\n                style={{\n                  backgroundColor: `rgb(${colourSet.tonesRGB.normal.join(\", \")})`,\n                  color:\n                    colourSet.tonesRGB.normal[0] * 0.299 + colourSet.tonesRGB.normal[1] * 0.587 + colourSet.tonesRGB.normal[2] * 0.114 > 186\n                      ? \"black\"\n                      : \"white\",\n                }}\n              >\n                {colourSet.colourName}\n              </option>\n            ))}\n          </select>\n        </td>\n      </tr>\n    );\n    const setting_customBlock_versions = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/VERSIONS\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          {Object.entries(block_versions).map(([block_version, block_version_checked]) => (\n            <React.Fragment key={block_version}>\n              <input type=\"checkbox\" checked={block_version_checked} onChange={() => this.onSettingChange_block_versions(block_version)} />\n              {SupportedVersions[block_version].MCVersion}{\" \"}\n            </React.Fragment>\n          ))}\n        </td>\n      </tr>\n    );\n    const customBlock_submit = (\n      <tr>\n        <th colSpan=\"2\">\n          <button\n            style={{ width: \"100%\" }}\n            onClick={() => onAddCustomBlock(block_colourSetId, block_name, block_nbtTags, block_versions)}\n          >\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ADD\")}\n          </button>\n        </th>\n      </tr>\n    );\n    const customBlock_delete = (\n      <tr>\n        <th colSpan=\"2\">\n          <button style={{ width: \"100%\" }} onClick={() => onDeleteCustomBlock(block_colourSetId, block_name, block_versions)}>\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/DELETE\")}\n          </button>\n        </th>\n      </tr>\n    );\n    return (\n      <details className=\"blockSelectionAddCustom\" open={false}>\n        <summary>{getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/TITLE\")}</summary>\n        {examples}\n        <table>\n          <tbody>\n            {setting_customBlock_name}\n            {setting_customBlock_nbtTags}\n            {setting_customBlock_colourSetId}\n            {setting_customBlock_versions}\n            {customBlock_submit}\n            {customBlock_delete}\n          </tbody>\n        </table>\n      </details>\n    );\n  }\n}\n\nexport default BlockSelectionAddCustom;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAySURBVFhH7c6hAQAwDMOwbP//nJH9UFCZmOq0zWT3fywAAAAAAAAAAAAAAAAAgO2A5AFAtAM9NfYR6AAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/textures.f0858a19.png\";","import React, { Component } from \"react\";\n\nimport IMG_Null from \"../../images/null.png\";\nimport IMG_Textures from \"../../images/textures.png\";\n\nimport \"./blockImage.css\";\n\nclass BlockImage extends Component {\n  render() {\n    const { getLocaleString, coloursJSON, colourSetId, blockId, style, className, ...props_others } = this.props;\n    const isNone = blockId === \"-1\"; // if barrier / no block selected for colourSetId\n    const isUnknown = colourSetId === \"64\" && blockId === \"2\"; // if unknown / placeholder block\n    return (\n      <img\n        src={IMG_Null}\n        alt={\n          isNone\n            ? getLocaleString(\"NONE\")\n            : isUnknown\n            ? getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")\n            : coloursJSON[colourSetId].blocks[blockId].displayName\n        }\n        style={\n          isNone\n            ? {\n                backgroundImage: `url(${IMG_Textures})`,\n                backgroundPositionX: \"-100%\",\n                backgroundPositionY: \"-6400%\",\n                ...style,\n              }\n            : isUnknown\n            ? {\n                backgroundImage: `url(${IMG_Textures})`,\n                backgroundPositionX: \"-200%\",\n                backgroundPositionY: \"-6400%\",\n                ...style,\n              }\n            : coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\"\n            ? {\n                backgroundImage: `url(${IMG_Textures})`,\n                backgroundPositionX: \"-500%\",\n                backgroundPositionY: \"-6400%\",\n                backgroundColor: `rgb(${coloursJSON[colourSetId].tonesRGB.normal.join(\", \")})`,\n                ...style,\n              }\n            : {\n                backgroundImage: `url(${IMG_Textures})`,\n                backgroundPositionX: `-${blockId}00%`,\n                backgroundPositionY: `-${colourSetId}00%`,\n                ...style,\n              }\n        }\n        className={`blockImage ${className}`}\n        {...props_others}\n      />\n    );\n  }\n}\n\nexport default BlockImage;\n","import React, { Component } from \"react\";\n\nimport Tooltip from \"../tooltip\";\nimport BlockSelectionAddCustom from \"./blockSelectionAddCustom/blockSelectionAddCustom\";\nimport BlockImage from \"./blockImage\";\n\nimport MapModes from \"./json/mapModes.json\";\nimport SupportedVersions from \"./json/supportedVersions.json\";\n\nimport \"./blockSelection.css\";\n\nclass BlockSelection extends Component {\n  state = {\n    lastSelectedCustomBlock: null, // {colourSetId, blockId}\n  };\n\n  cssRGB(RGBArray) {\n    // RGB array to css compatible string\n    return `rgb(${RGBArray.join(\", \")})`;\n  }\n\n  getColourSetBox = (colourSet) => {\n    const { optionValue_staircasing } = this.props;\n    let background;\n    switch (optionValue_staircasing) {\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\n      case MapModes.MAPDAT.staircaseModes.OFF.uniqueId: {\n        background = this.cssRGB(colourSet.tonesRGB.normal);\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\n      case MapModes.MAPDAT.staircaseModes.ON.uniqueId: {\n        background = `linear-gradient(${this.cssRGB(colourSet.tonesRGB.dark)} 33%, ${this.cssRGB(colourSet.tonesRGB.normal)} 33%, ${this.cssRGB(\n          colourSet.tonesRGB.normal\n        )} 66%, ${this.cssRGB(colourSet.tonesRGB.light)} 66%)`;\n        break;\n      }\n      case MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId: {\n        background = `linear-gradient(${this.cssRGB(colourSet.tonesRGB.unobtainable)} 25%, ${this.cssRGB(colourSet.tonesRGB.dark)} 25%, ${this.cssRGB(\n          colourSet.tonesRGB.dark\n        )} 50%, ${this.cssRGB(colourSet.tonesRGB.normal)} 50%, ${this.cssRGB(colourSet.tonesRGB.normal)} 75%, ${this.cssRGB(colourSet.tonesRGB.light)} 75%)`;\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\n      case MapModes.MAPDAT.staircaseModes.FULL_DARK.uniqueId: {\n        background = this.cssRGB(colourSet.tonesRGB.dark);\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId:\n      case MapModes.MAPDAT.staircaseModes.FULL_LIGHT.uniqueId: {\n        background = this.cssRGB(colourSet.tonesRGB.light);\n        break;\n      }\n      case MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId: {\n        background = this.cssRGB(colourSet.tonesRGB.unobtainable);\n        break;\n      }\n      default: {\n        throw new Error(\"Unknown staircasing value\");\n      }\n    }\n    return (\n      <div\n        className=\"colourSetBox\"\n        style={{\n          background: background,\n        }}\n      />\n    );\n  };\n\n  getColourSetTones = (colourSetId, colourSet, disabledTones, onToggleColourTone) => {\n    const { optionValue_staircasing } = this.props;\n    switch (optionValue_staircasing) {\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\n        return (\n          <React.Fragment>\n            <Tooltip tooltipText=\"DARK SHADE\">\n              <div\n                className=\"colourSetBox\"\n                onClick={() => onToggleColourTone(colourSetId, \"dark\")}\n                style={{\n                  background: this.cssRGB(colourSet.tonesRGB.dark),\n                  cursor: \"pointer\",\n                  ...(!disabledTones[colourSetId].has(\"dark\") && {\n                    filter: \"drop-shadow(0 0 4px #658968)\"\n                  })\n                }}\n              />\n            </Tooltip>\n            <Tooltip tooltipText=\"NORMAL SHADE\">\n              <div\n                className=\"colourSetBox\"\n                onClick={() => onToggleColourTone(colourSetId, \"normal\")}\n                style={{\n                  background: this.cssRGB(colourSet.tonesRGB.normal),\n                  cursor: \"pointer\",\n                  ...(!disabledTones[colourSetId].has(\"normal\") && {\n                    filter: \"drop-shadow(0 0 4px #658968)\"\n                  })\n                }}\n              />\n            </Tooltip>\n            <Tooltip tooltipText=\"BRIGHT SHADE\">\n              <div\n                className=\"colourSetBox\"\n                onClick={() => onToggleColourTone(colourSetId, \"light\")}\n                style={{\n                  background: this.cssRGB(colourSet.tonesRGB.light),\n                  cursor: \"pointer\",\n                  ...(!disabledTones[colourSetId].has(\"light\") && {\n                    filter: \"drop-shadow(0 0 4px #658968)\"\n                  })\n                }}\n              />\n            </Tooltip>\n          </React.Fragment>\n        );\n      default:\n        return \"\";\n    }\n  };\n\n  render() {\n    const {\n      coloursJSON,\n      getLocaleString,\n      onChangeColourSetBlock,\n      onToggleColourTone,\n      optionValue_version,\n      optionValue_showOriginalBlocks,\n      onOptionChange_showOriginalBlocks,\n      selectedBlocks,\n      disabledTones,\n      presets,\n      selectedPresetName,\n      isDefaultPreset,\n      onPresetChange,\n      onDeletePreset,\n      onSavePreset,\n      onSharePreset,\n      onGetPDNPaletteClicked,\n      handleAddCustomBlock,\n      handleDeleteCustomBlock,\n    } = this.props;\n    const { lastSelectedCustomBlock } = this.state;\n\n    const setting_showOriginalBlocks = (\n      <React.Fragment>\n        <Tooltip tooltipText={\"Also shows all blocks that were in the original mapartcraft (not recommended)\"}>\n          <b>\n            {\"Include not-recommended original blocks:\"}\n          </b>\n        </Tooltip>{\" \"}\n        <input type=\"checkbox\" checked={optionValue_showOriginalBlocks} onChange={onOptionChange_showOriginalBlocks} />\n        <br />\n      </React.Fragment>\n    );\n\n    const presetsManagement = (\n      <React.Fragment>\n        <h2 id=\"blockselectiontitle\">{getLocaleString(\"BLOCK-SELECTION/TITLE\")}</h2>\n        <b>\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/TITLE\")}\n          {\":\"}\n        </b>{\" \"}\n        <select id=\"presets\" value={selectedPresetName} onChange={onPresetChange}>\n          <option value=\"None\">{getLocaleString(\"BLOCK-SELECTION/PRESETS/NONE\")}</option>\n          {presets.map((preset) => (\n            <option value={preset.name} key={preset.name}>\n              {\"localeKey\" in preset ? getLocaleString(preset.localeKey) : preset.name}\n            </option>\n          ))}\n        </select>\n        <br />\n        {setting_showOriginalBlocks}\n        <button type=\"button\" disabled={isDefaultPreset()} onClick={onDeletePreset}>\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/DELETE\")}\n        </button>\n        <button type=\"button\" onClick={onSavePreset}>\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/SAVE\")}\n        </button>\n        <Tooltip tooltipText={getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-TT\")}>\n          <button type=\"button\" onClick={onSharePreset}>\n            {getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE\")}\n          </button>\n        </Tooltip>\n        <Tooltip tooltipText={getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-TT\")}>\n          <button type=\"button\" onClick={onGetPDNPaletteClicked}>\n            {getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD\")}\n          </button>\n        </Tooltip>\n      </React.Fragment>\n    );\n    const blockSelection = (\n      <React.Fragment>\n        {Object.entries(coloursJSON)\n          .filter(([, colourSet]) => Object.values(colourSet.blocks).some((block) => Object.keys(block.validVersions).includes(optionValue_version.MCVersion)))\n          .map(([colourSetId, colourSet]) => (\n            <div key={colourSetId} className=\"colourSet\">\n              {this.getColourSetBox(colourSet)}\n              {this.getColourSetTones(colourSetId, colourSet, disabledTones, onToggleColourTone)}\n              <label>\n                <Tooltip tooltipText={getLocaleString(\"NONE\")}>\n                  <BlockImage\n                    getLocaleString={getLocaleString}\n                    coloursJSON={coloursJSON}\n                    colourSetId={colourSetId}\n                    blockId={\"-1\"}\n                    onClick={() => onChangeColourSetBlock(colourSetId, \"-1\")}\n                    style={{\n                      cursor: \"pointer\",\n                      ...(selectedBlocks[colourSetId] === \"-1\" && {\n                        filter: \"drop-shadow(0 0 4px #ffffff)\",\n                      }),\n                    }}\n                  />\n                </Tooltip>\n              </label>\n              <div className={\"colourSetBlocks\"}>\n                {Object.entries(colourSet.blocks)\n                  .filter(([, block]) => Object.keys(block.validVersions).includes(optionValue_version.MCVersion))\n                  .filter(([, block]) => optionValue_showOriginalBlocks || !block.hidden)\n                  .map(([blockId, block]) => (\n                    <label key={blockId}>\n                      <Tooltip tooltipText={block.displayName}>\n                        {selectedBlocks[colourSetId] === blockId &&\n                          !(Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1].MCVersion in block.validVersions) && (\n                            // if doesn't support latest version\n                            <div\n                              style={{\n                                position: \"absolute\",\n                                paddingLeft: \"28px\",\n                                zIndex: 110,\n                              }}\n                            >\n                              <Tooltip\n                                tooltipText={`${getLocaleString(\"BLOCK-SELECTION/UNSUPPORTED-PAST\")} ${\n                                  Object.keys(block.validVersions)[Object.keys(block.validVersions).length - 1]\n                                }`}\n                                textStyleOverrides={{\n                                  whiteSpace: \"nowrap\",\n                                  backgroundColor: \"red\",\n                                }}\n                              >\n                                <h2 style={{ backgroundColor: \"red\", margin: \"0\" }}>{\"!\"}</h2>\n                              </Tooltip>\n                            </div>\n                          )}\n                        <BlockImage\n                          coloursJSON={coloursJSON}\n                          colourSetId={colourSetId}\n                          blockId={blockId}\n                          onClick={() => {\n                            onChangeColourSetBlock(colourSetId, blockId);\n                            if (block.presetIndex === \"CUSTOM\") {\n                              this.setState({ lastSelectedCustomBlock: { colourSetId, blockId } });\n                            }\n                          }}\n                          style={{\n                            cursor: \"pointer\",\n                            ...(selectedBlocks[colourSetId] === blockId && {\n                              filter: \"drop-shadow(0 0 4px #ffffff)\",\n                              ...(block.presetIndex !== \"CUSTOM\" && {\n                              }),\n                            }),\n                          }}\n                        />\n                      </Tooltip>\n                    </label>\n                  ))}\n              </div>\n            </div>\n          ))}\n      </React.Fragment>\n    );\n    return (\n      <div className=\"section blockSelectionDiv\">\n        {presetsManagement}\n        {blockSelection}\n        <BlockSelectionAddCustom\n          getLocaleString={getLocaleString}\n          coloursJSON={coloursJSON}\n          onAddCustomBlock={handleAddCustomBlock}\n          onDeleteCustomBlock={handleDeleteCustomBlock}\n          lastSelectedCustomBlock={lastSelectedCustomBlock}\n        />\n      </div>\n    );\n  }\n}\n\nexport default BlockSelection;\n","export default class WorkerBuilder extends Worker {\n  constructor(worker) {\n    let code = worker.toString();\n    code = code.substring(code.indexOf(\"{\") + 1, code.lastIndexOf(\"}\"));\n    const blob = new Blob([code], { type: \"application/javascript\" });\n    return new Worker(URL.createObjectURL(blob));\n  }\n}\n","// eslint-disable-next-line import/no-anonymous-default-export\n// eslint-disable-next-line no-restricted-globals\n\nexport default function NBTWorker (args) {\n\n// begin variables passed in onmessage\nvar coloursJSON;\nvar MapModes;\nvar optionValue_version;\nvar optionValue_staircasing;\nvar optionValue_supportBlock;\nvar pixelsData;\nvar maps;\nvar currentSelectedBlocks;\n// end onmessage variables\n\nvar exactColourCache = new Map(); // for mapping RGB that exactly matches in coloursJSON to colourSetId and tone\n\nvar progressReportHead;\n\n/*\n  A mapping from type names to NBT type numbers.\n  This is NOT just an enum, these values have to stay as they are\n  https://minecraft.wiki/w/NBT_format#TAG_definition\n*/\nconst TagTypes = {\n  end: 0,\n  byte: 1,\n  short: 2,\n  int: 3,\n  long: 4,\n  float: 5,\n  double: 6,\n  byteArray: 7,\n  string: 8,\n  list: 9,\n  compound: 10,\n  intArray: 11,\n  longArray: 12,\n};\n\nclass NBTWriter {\n  constructor() {\n    if (typeof ArrayBuffer === \"undefined\") {\n      throw new Error(\"Missing required type ArrayBuffer\");\n    }\n    if (typeof DataView === \"undefined\") {\n      throw new Error(\"Missing required type DataView\");\n    }\n    if (typeof Uint8Array === \"undefined\") {\n      throw new Error(\"Missing required type Uint8Array\");\n    }\n    /* Will be auto-resized (x2) on write if necessary. */\n    this.buffer = new ArrayBuffer(1024);\n\n    /* These are recreated when the buffer is */\n    this.dataView = new DataView(this.buffer);\n    this.arrayView = new Uint8Array(this.buffer);\n    this.offset = 0;\n  }\n\n  encodeUTF8(str) {\n    let array = [],\n      i,\n      c;\n    for (i = 0; i < str.length; i++) {\n      c = str.charCodeAt(i);\n      if (c === 0x0) {\n        array.push(0xc0);\n        array.push(0x80);\n      } else if (c < 0x80) {\n        array.push(c);\n      } else if (c < 0x800) {\n        array.push(0xc0 | (c >> 6));\n        array.push(0x80 | (c & 0x3f));\n      } else if (c < 0x10000) {\n        array.push(0xe0 | (c >> 12));\n        array.push(0x80 | ((c >> 6) & 0x3f));\n        array.push(0x80 | (c & 0x3f));\n      } else {\n        // unsure if this is accurate, however we never need such exotic unicode characters\n        array.push(0xf0 | ((c >> 18) & 0x07));\n        array.push(0x80 | ((c >> 12) & 0x3f));\n        array.push(0x80 | ((c >> 6) & 0x3f));\n        array.push(0x80 | (c & 0x3f));\n      }\n    }\n    return array;\n  }\n\n  accommodate(size) {\n    // Ensures that the buffer is large enough to write `size` bytes at the current `this.offset`.\n    let requiredLength = this.offset + size;\n    if (this.buffer.byteLength >= requiredLength) {\n      return;\n    }\n\n    let newLength = this.buffer.byteLength;\n    while (newLength < requiredLength) {\n      newLength *= 2;\n    }\n    let newBuffer = new ArrayBuffer(newLength);\n    let newArrayView = new Uint8Array(newBuffer);\n    newArrayView.set(this.arrayView);\n\n    // If there's a gap between the end of the old buffer\n    // and the start of the new one, we need to zero it out\n    if (this.offset > this.buffer.byteLength) {\n      newArrayView.fill(0, this.buffer.byteLength, this.offset);\n    }\n\n    this.buffer = newBuffer;\n    this.dataView = new DataView(newBuffer);\n    this.arrayView = newArrayView;\n  }\n\n  write(dataType, size, value) {\n    this.accommodate(size);\n    this.dataView[`set${dataType}`](this.offset, value);\n    this.offset += size;\n  }\n\n  writeByType(dataType, value) {\n    switch (dataType) {\n      case TagTypes.end: {\n        this.writeByType(TagTypes.byte, 0);\n        break;\n      }\n      case TagTypes.byte: {\n        this.write(\"Int8\", 1, value);\n        break;\n      }\n      case TagTypes.short: {\n        this.write(\"Int16\", 2, value);\n        break;\n      }\n      case TagTypes.int: {\n        this.write(\"Int32\", 4, value);\n        break;\n      }\n      case TagTypes.long: {\n        // NB: special: JS doesn't support native 64 bit ints; pass an array of two 32 bit ints to this case\n        this.write(\"Int32\", 4, value[0]);\n        this.write(\"Int32\", 4, value[1]);\n        break;\n      }\n      case TagTypes.float: {\n        this.write(\"Float32\", 4, value);\n        break;\n      }\n      case TagTypes.double: {\n        this.write(\"Float64\", 8, value);\n        break;\n      }\n      case TagTypes.byteArray: {\n        this.writeByType(TagTypes.int, value.length);\n        this.accommodate(value.length);\n        this.arrayView.set(value, this.offset);\n        this.offset += value.length;\n        break;\n      }\n      case TagTypes.string: {\n        let bytes = this.encodeUTF8(value);\n        this.writeByType(TagTypes.short, bytes.length);\n        this.accommodate(bytes.length);\n        this.arrayView.set(bytes, this.offset);\n        this.offset += bytes.length;\n        break;\n      }\n      case TagTypes.list: {\n        // Pass a dicitonary {\"type\": TagTypes.blah, \"value\": [] }\n        this.writeByType(TagTypes.byte, value.type);\n        this.writeByType(TagTypes.int, value.value.length);\n        for (let i = 0; i < value.value.length; i++) {\n          this.writeByType(value.type, value.value[i]);\n        }\n        break;\n      }\n      case TagTypes.compound: {\n        // This is the rich tagtype we will interact with a lot\n        // Pass a dictionary {\"type\": TagTypes.blah, \"value\": ... }\n        // {\n        //   author: { type: TagTypes.string, value: \"Steve\" },\n        //   stuff: {\n        //       type: TagTypes.compound,\n        //       value: {\n        //         foo: { type: int, value: 42 },\n        //         bar: { type: string, value: 'Hi!' }\n        //       }\n        //   }\n        // }\n        Object.keys(value).forEach((key) => {\n          this.writeByType(TagTypes.byte, value[key].type);\n          this.writeByType(TagTypes.string, key);\n          this.writeByType(value[key].type, value[key].value); // this is where the nice recursion happens\n        });\n        this.writeByType(TagTypes.end, 0);\n        break;\n      }\n      case TagTypes.intArray: {\n        this.writeByType(TagTypes.int, value.length);\n        for (let i = 0; i < value.length; i++) {\n          this.writeByType(TagTypes.int, value[i]);\n          // https://lkml.org/lkml/2012/7/6/495\n        }\n        break;\n      }\n      case TagTypes.longArray: {\n        this.writeByType(TagTypes.int, value.length);\n        for (let i = 0; i < value.length; i++) {\n          this.writeByType(TagTypes.long, value[i]);\n          // NB this is an array of longs given as specified in case:long\n        }\n        break;\n      }\n      case \"UBYTE\": {\n        // unsure why this is here, seems unused; nbt raw bytes (TagTypes.byte) are signed\n        this.write(\"Uint8\", 1, value);\n        break;\n      }\n      default: {\n        throw new Error(`Unknown data type ${dataType} for value ${value}`);\n      }\n    }\n  }\n\n  writeTopLevelCompound(value) {\n    // For writing a top level JSON object as a compound tag.\n    // This is of the form {\"name\": \"blah\", \"value\": {...}}\n    // This is not just this.writeByType(TagTypes.compound, value); we add the appropriate compound prefix etc\n    this.writeByType(TagTypes.byte, TagTypes.compound);\n    this.writeByType(TagTypes.string, value.name);\n    this.writeByType(TagTypes.compound, value.value);\n  }\n\n  getData() {\n    /*\n      Returns the writen data as a slice from the internal buffer, cutting off any padding at the end.\n    */\n    this.accommodate(0); /* make sure the offset is inside the buffer */\n    return this.buffer.slice(0, this.offset);\n  }\n}\n\nclass Map_NBT {\n  constructor(map) {\n    this.mapColoursLayout = map.coloursLayout;\n    this.mapMaterialsCounts = map.materials;\n    this.NBT_json = {\n      name: \"\",\n      value: {\n        blocks: {\n          type: TagTypes.list,\n          value: {\n            type: TagTypes.compound,\n            value: [],\n          },\n        },\n        entities: {\n          type: TagTypes.list,\n          value: {\n            type: TagTypes.compound,\n            value: [],\n          },\n        },\n        palette: {\n          type: TagTypes.list,\n          value: {\n            type: TagTypes.compound,\n            value: [],\n          },\n        },\n        size: {\n          type: TagTypes.list,\n          value: {\n            type: TagTypes.int,\n            value: [], // X, Y, Z\n          },\n        },\n        author: {\n          type: TagTypes.string,\n          value: \"mms0316.github.io/mapartcraft\",\n        },\n        DataVersion: {\n          type: TagTypes.int,\n          value: null,\n        },\n      },\n    };\n    this.physicalLayout = [];\n    this.palette_colourSetId_paletteId = {}; // map coloursJSON colourSetIds to index of corresponding block in palette list\n    this.palette_paletteId_colourSetId = []; // map paletteIds (index of an item in this list) to colourSetIds\n    this.columnHeightsCache = []; // appended to in getPhysicalLayout_individualColumn, used in setNBT_json_size\n  }\n\n  constructPaletteLookups() {\n    // filter $materials to colourSetIds with non-zero materials count\n    const nonZeroMaterials = Object.fromEntries(Object.entries(this.mapMaterialsCounts).filter(([_, value]) => value !== 0));\n    // now construct palette lookups for non-zero colourSetIds\n    Object.keys(nonZeroMaterials).forEach((colourSetId) => {\n      this.palette_colourSetId_paletteId[colourSetId] = this.palette_paletteId_colourSetId.length;\n      this.palette_paletteId_colourSetId.push(colourSetId);\n    });\n    // finally add noobline/scaffold material at the end, special key\n    this.palette_colourSetId_paletteId[\"NOOBLINE_SCAFFOLD\"] = this.palette_paletteId_colourSetId.length;\n    this.palette_paletteId_colourSetId.push(\"NOOBLINE_SCAFFOLD\");\n  }\n\n  setNBT_json_palette() {\n    this.palette_paletteId_colourSetId.forEach((colourSetId) => {\n      let paletteItemToPush = {};\n      if (colourSetId === \"NOOBLINE_SCAFFOLD\") {\n        paletteItemToPush.Name = {\n          type: TagTypes.string,\n          value: `minecraft:${optionValue_supportBlock.toLowerCase()}`,\n        };\n        // we expect the support block to be something non-exotic with no properties eg netherrack\n      } else {\n        let blockNBTData = coloursJSON[colourSetId].blocks[currentSelectedBlocks[colourSetId]].validVersions[optionValue_version.MCVersion];\n        if (typeof blockNBTData === \"string\") {\n          // this is of the form eg \"&1.12.2\"\n          blockNBTData = coloursJSON[colourSetId].blocks[currentSelectedBlocks[colourSetId]].validVersions[blockNBTData.slice(1)];\n        }\n        paletteItemToPush.Name = {\n          type: TagTypes.string,\n          value: `minecraft:${blockNBTData.NBTName}`,\n        };\n        if (Object.keys(blockNBTData.NBTArgs).length !== 0) {\n          paletteItemToPush.Properties = { type: TagTypes.compound, value: {} };\n          Object.keys(blockNBTData.NBTArgs).forEach((NBTArg_key) => {\n            paletteItemToPush.Properties.value[NBTArg_key] = {\n              type: TagTypes.string,\n              value: blockNBTData.NBTArgs[NBTArg_key],\n            };\n          });\n        }\n      }\n      this.NBT_json.value.palette.value.value.push(paletteItemToPush);\n    });\n  }\n\n  setNBT_json_DataVersion() {\n    this.NBT_json.value.DataVersion.value = optionValue_version.NBTVersion;\n  }\n\n  returnPhysicalBlock(x, y, z, colourSetId) {\n    return {\n      pos: { type: TagTypes.list, value: { type: TagTypes.int, value: [x, y, z] } },\n      state: { type: TagTypes.int, value: this.palette_colourSetId_paletteId[colourSetId] },\n    };\n  }\n\n  getPhysicalLayout() {\n    for (let columnNumber = 0; columnNumber < this.mapColoursLayout.length; columnNumber++) {\n      this.getPhysicalLayout_individualColumn(columnNumber);\n      postMessage({\n        head: progressReportHead,\n        body: (columnNumber + 1) / this.mapColoursLayout.length,\n      });\n    }\n  }\n\n  getPhysicalLayout_individualColumn(columnNumber) {\n    const mapColoursLayoutColumn = this.mapColoursLayout[columnNumber];\n    let physicalColumn = [];\n    let currentHeight;\n    switch (optionValue_staircasing) {\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId: {\n        // start at y = 2 for flat maps; this covers the cases of support blocks 1 and or 2 blocks below\n        currentHeight = 2;\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId: {\n        // this doesn't matter\n        // in the classic case each column is later adjusted to have its global minimum at y = 0 so the map has a common base / is as short as possible\n        // in the valley case valleys are pulled down to y = 0\n        currentHeight = 0;\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId: {\n        // staircase descends from noobline southwards\n        currentHeight = 1 + mapColoursLayoutColumn.length;\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId: {\n        // staircase ascends from noobline southwards\n        currentHeight = 1;\n        break;\n      }\n      default: {\n        throw new Error(\"Unknown staircase mode\");\n      }\n    }\n\n    // initialize noobline\n    physicalColumn.push(this.returnPhysicalBlock(columnNumber, currentHeight, 0, \"NOOBLINE_SCAFFOLD\"));\n\n    for (let rowNumber = 0; rowNumber < mapColoursLayoutColumn.length; rowNumber++) {\n      const coloursLayoutBlock = mapColoursLayoutColumn[rowNumber];\n\n      const previousHeight = currentHeight;\n      switch (coloursLayoutBlock.tone) {\n        case \"dark\": {\n          currentHeight -= 1;\n          break;\n        }\n        case \"normal\": {\n          break;\n        }\n        case \"light\": {\n          currentHeight += 1;\n          break;\n        }\n        default: {\n          throw new Error(\"Unknown tone type\");\n        }\n      }\n\n      physicalColumn.push(this.returnPhysicalBlock(columnNumber, currentHeight, rowNumber + 1, coloursLayoutBlock.colourSetId));\n      // the + 1 is because the noobline offsets everything South one block\n\n    }\n\n    // sort in terms of z and y, necessary for determining when a plateau has finished in valley mode, and correct noobline heights in map preview\n    physicalColumn.sort((elt1, elt2) => {\n      if (elt1.pos.value.value[2] < elt2.pos.value.value[2]) {\n        return -1;\n      } else if (elt1.pos.value.value[2] > elt2.pos.value.value[2]) {\n        // smaller Z first\n        return 1;\n      } else {\n        if (elt1.pos.value.value[1] > elt2.pos.value.value[1]) {\n          return -1;\n        } else {\n          // higher Y first\n          return 1;\n        }\n      }\n    });\n\n    switch (optionValue_staircasing) {\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId: {\n        let plateaus = [{ startIndex: 0, endIndex: 0 }];\n        // initial 0 width plateau useful just so we don't have a special case for the first proper plateau later\n        let ascending = false; // weakly ascending\n        let currentPlateauStartIndex = null;\n        let visibleBlocksHeight = physicalColumn[0].pos.value.value[1]; // initialise to noobline height\n        // visible blocks are blocks at the top height in a x-z column, the actual map blocks that give the colours\n\n        for (let i = 0; i < physicalColumn.length; i++) {\n          const physicalBlock = physicalColumn[i];\n          if (this.palette_paletteId_colourSetId[physicalBlock.state.value] === \"NOOBLINE_SCAFFOLD\") {\n            continue;\n          }\n          if (ascending && physicalBlock.pos.value.value[1] < visibleBlocksHeight) {\n            // dark after ascent; plateau found\n            ascending = false;\n            plateaus.push({\n              startIndex: currentPlateauStartIndex,\n              endIndex: i,\n            });\n          } else if (physicalBlock.pos.value.value[1] > visibleBlocksHeight) {\n            // light\n            ascending = true;\n            currentPlateauStartIndex = i;\n          }\n          visibleBlocksHeight = physicalBlock.pos.value.value[1];\n        }\n\n        plateaus.push({ startIndex: physicalColumn.length, endIndex: physicalColumn.length });\n\n        let nonPlateauPulldownHeights = [Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER];\n        while (plateaus.length !== 1) {\n          let pullDownHeight = Number.MAX_SAFE_INTEGER;\n          for (let i = plateaus[0].endIndex; i < plateaus[1].startIndex; i++) {\n            pullDownHeight = Math.min(physicalColumn[i].pos.value.value[1], pullDownHeight);\n          }\n          for (let i = plateaus[0].endIndex; i < plateaus[1].startIndex; i++) {\n            physicalColumn[i].pos.value.value[1] -= pullDownHeight;\n          }\n          nonPlateauPulldownHeights[1] = pullDownHeight;\n          const plateauPulldownHeight = Math.min(...nonPlateauPulldownHeights);\n          // we pull down a plateau by the minimum of the two values the surrounding non-plateaus were pulled down by\n          for (let i = plateaus[0].startIndex; i < plateaus[0].endIndex; i++) {\n            physicalColumn[i].pos.value.value[1] -= plateauPulldownHeight;\n          }\n          plateaus.shift();\n          nonPlateauPulldownHeights[0] = nonPlateauPulldownHeights[1];\n        }\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId: {\n        // make sure the column's global minimum is at y = 0; doing this for every column gives the map a common base.\n        const columnMinimumY = physicalColumn.reduce((a, b) => (a.pos.value.value[1] < b.pos.value.value[1] ? a : b)).pos.value.value[1];\n        physicalColumn.forEach((block) => {\n          block.pos.value.value[1] -= columnMinimumY;\n        });\n        break;\n      }\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId: {\n        break;\n      }\n      default: {\n        throw new Error(\"Unknown staircase mode\");\n      }\n    }\n\n    this.NBT_json.value.blocks.value.value = this.NBT_json.value.blocks.value.value.concat(physicalColumn);\n    this.columnHeightsCache.push(physicalColumn.reduce((a, b) => (a.pos.value.value[1] > b.pos.value.value[1] ? a : b)).pos.value.value[1]);\n  }\n\n  setNBT_json_blocks() {\n    this.getPhysicalLayout();\n  }\n\n  setNBT_json_size() {\n    this.NBT_json.value.size.value.value = [\n      this.mapColoursLayout.length,\n      this.columnHeightsCache.reduce((a, b) => (a > b ? a : b)) + 1,\n      this.mapColoursLayout[0].length + 1,\n    ];\n  }\n\n  getNBT() {\n    this.constructPaletteLookups();\n    this.setNBT_json_palette();\n    this.setNBT_json_DataVersion();\n    this.setNBT_json_blocks();\n    this.setNBT_json_size();\n\n    // console.log(NBT_json);\n\n    let nbtWriter = new NBTWriter();\n    nbtWriter.writeTopLevelCompound(this.NBT_json);\n    return nbtWriter.getData();\n  }\n}\n\nclass Map_Mapdat {\n  constructor(map) {\n    this.coloursLayout = map.coloursLayout;\n\n    const dataVersion = optionValue_version.NBTVersion;\n\n    this.NBT_json = {\n      name: \"\",\n      value: {\n        data: {\n          type: TagTypes.compound,\n          value: {\n            scale: { type: TagTypes.byte, value: 0 },\n            dimension: {\n              type: dataVersion >= 2566 ? TagTypes.string : TagTypes.byte,\n              value: dataVersion >= 2566 ? \"minecraft:overworld\" : dataVersion > 1343 ? 0 : -128,\n            },\n            unlimitedTracking: { type: TagTypes.byte, value: 0 },\n            trackingPosition: { type: TagTypes.byte, value: 0 },\n            locked: { type: TagTypes.byte, value: 1 },\n            height: { type: TagTypes.short, value: 128 },\n            width: { type: TagTypes.short, value: 128 },\n            xCenter: { type: TagTypes.int, value: 0 },\n            zCenter: { type: TagTypes.int, value: 0 },\n            colors: { type: TagTypes.byteArray, value: new Uint8Array(16384) },\n          },\n        },\n        DataVersion: { type: TagTypes.int, value: dataVersion },\n      },\n    };\n  }\n\n  setNBT_json_colors() {\n    for (let x = 0; x < 128; x++) {\n      for (let z = 0; z < 128; z++) {\n        const pixel = this.coloursLayout[x][z];\n        const arrayOffset = z * 128 + x;\n        let mapdatId; // coloursJSON contains the base mapdatId that is multiplied by 4 and added to by one of 0,1,2,3\n        if (pixel.colourSetId === \"-1\") {\n          // special colourSetId for transparent maps\n          mapdatId = 1;\n        } else {\n          switch (pixel.tone) {\n            case \"dark\": {\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId;\n              break;\n            }\n            case \"normal\": {\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId + 1;\n              break;\n            }\n            case \"light\": {\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId + 2;\n              break;\n            }\n            case \"unobtainable\": {\n              mapdatId = 4 * coloursJSON[pixel.colourSetId].mapdatId + 3;\n              break;\n            }\n            default: {\n              throw new Error(\"Unknown colour tone\");\n            }\n          }\n        }\n        this.NBT_json.value.data.value.colors.value[arrayOffset] = mapdatId;\n      }\n      postMessage({\n        head: progressReportHead,\n        body: (x + 1) / 128,\n      });\n    }\n  }\n\n  getNBT() {\n    this.setNBT_json_colors();\n\n    let nbtWriter = new NBTWriter();\n    nbtWriter.writeTopLevelCompound(this.NBT_json);\n    return nbtWriter.getData();\n  }\n}\n\nfunction setupExactColourCache() {\n  // we do not care what staircasing option is selected etc as this does not matter\n  // this is for exactly matching colours, whose values are never repeated in coloursJSON\n  // also RGB could be easily changed to RGBA if Mojang ever added absolute black #000000 and we need to distinguish it from transparent\n  // setupExactColourCache also exists in mapCanvas.jsworker but without the \"-1\" colourSet for transparent\n  for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n    for (const [toneKey, toneRGB] of Object.entries(colourSet.tonesRGB)) {\n      const RGBBinary = (toneRGB[0] << 16) + (toneRGB[1] << 8) + toneRGB[2];\n      exactColourCache.set(RGBBinary, {\n        colourSetId: colourSetId,\n        tone: toneKey,\n      });\n    }\n  }\n  exactColourCache.set(0, {\n    // special transparent for mapdat\n    colourSetId: \"-1\",\n    tone: \"normal\",\n  });\n}\n\nfunction exactRGBToColourSetIdAndTone(pixelRGB) {\n  const RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2];\n  return exactColourCache.get(RGBBinary);\n}\n\nfunction isSupportBlockMandatoryForColourSetIdAndTone(colourSetIdAndTone) {\n  return coloursJSON[colourSetIdAndTone.colourSetId].blocks[currentSelectedBlocks[colourSetIdAndTone.colourSetId]].supportBlockMandatory;\n}\n\nfunction mergeMaps() {\n  // for when we want one big NBT instead of split 1x1s\n  maps.forEach((rowOfMaps) => {\n    for (let whichMap_x = 1; whichMap_x < rowOfMaps.length; whichMap_x++) {\n      rowOfMaps[0].coloursLayout = rowOfMaps[0].coloursLayout.concat(rowOfMaps[whichMap_x].coloursLayout); // merge along x-axis\n    }\n  });\n  for (let i = 0; i < maps[0][0].coloursLayout.length; i++) {\n    // for each column in resulting map\n    for (let j = 1; j < maps.length; j++) {\n      // for each column needing to be merged into resulting map\n      maps[0][0].coloursLayout[i] = maps[0][0].coloursLayout[i].concat(maps[j][0].coloursLayout[i]);\n    }\n  }\n  // Merge materials counts for lookup\n  let materials_new = {};\n  Object.keys(coloursJSON).forEach((colourSetId) => {\n    materials_new[colourSetId] = 0;\n  });\n  maps.forEach((rowOfMaps) => {\n    rowOfMaps.forEach((map) => {\n      Object.keys(map.materials).forEach((colourSetId) => {\n        materials_new[colourSetId] += map.materials[colourSetId];\n      });\n    });\n  });\n  maps[0][0].materials = materials_new;\n  maps = [[maps[0][0]]];\n}\n\nfunction setupColoursLayoutsFromPixelsData() {\n  const mapSize_x = maps[0].length;\n  const mapSize_z = maps.length;\n  for (let whichMap_z = 0; whichMap_z < mapSize_z; whichMap_z++) {\n    for (let whichMap_x = 0; whichMap_x < mapSize_x; whichMap_x++) {\n      let coloursLayout = [];\n      for (let columnNumber = 0; columnNumber < 128; columnNumber++) {\n        let coloursLayout_columnToPush = [];\n        for (let rowNumber = 0; rowNumber < 128; rowNumber++) {\n          const pixelsData_offset = 4 * (128 * mapSize_x * (128 * whichMap_z + rowNumber) + 128 * whichMap_x + columnNumber);\n          const colourSetIdAndTone = exactRGBToColourSetIdAndTone([\n            pixelsData[pixelsData_offset],\n            pixelsData[pixelsData_offset + 1],\n            pixelsData[pixelsData_offset + 2],\n          ]);\n          coloursLayout_columnToPush.push(colourSetIdAndTone);\n        }\n        coloursLayout.push(coloursLayout_columnToPush);\n      }\n      maps[whichMap_z][whichMap_x].coloursLayout = coloursLayout;\n    }\n  }\n}\n\nonmessage = (e) => {\n  coloursJSON = e.data.body.coloursJSON;\n  MapModes = e.data.body.MapModes;\n  optionValue_version = e.data.body.optionValue_version;\n  optionValue_staircasing = e.data.body.optionValue_staircasing;\n  optionValue_supportBlock = e.data.body.optionValue_supportBlock;\n  pixelsData = e.data.body.pixelsData;\n  maps = e.data.body.maps;\n  currentSelectedBlocks = e.data.body.currentSelectedBlocks;\n\n  const headerMessage = e.data.head;\n\n  setupExactColourCache();\n  setupColoursLayoutsFromPixelsData();\n\n  if ([\"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\", \"CREATE_NBT_JOINED\"].includes(headerMessage)) {\n    mergeMaps();\n  }\n\n  progressReportHead = `PROGRESS_REPORT_${headerMessage}`;\n\n  switch (headerMessage) {\n    case \"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\":\n    case \"CREATE_NBT_JOINED\":\n    case \"CREATE_NBT_SPLIT\": {\n      for (let whichMap_y = 0; whichMap_y < maps.length; whichMap_y++) {\n        for (let whichMap_x = 0; whichMap_x < maps[0].length; whichMap_x++) {\n          const map_NBT = new Map_NBT(maps[whichMap_y][whichMap_x]);\n          const NBT_Array = map_NBT.getNBT();\n          postMessage({\n            head: headerMessage === \"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\" ? \"NBT_FOR_VIEW_ONLINE\" : \"NBT_ARRAY\",\n            body: {\n              whichMap_x: whichMap_x,\n              whichMap_y: whichMap_y,\n              NBT_Array: NBT_Array,\n            },\n          });\n        }\n      }\n      break;\n    }\n    case \"CREATE_MAPDAT_SPLIT\":\n    case \"CREATE_MAPDAT_SPLIT_ZIP\": {\n      for (let whichMap_y = 0; whichMap_y < maps.length; whichMap_y++) {\n        for (let whichMap_x = 0; whichMap_x < maps[0].length; whichMap_x++) {\n          const map_Mapdat = new Map_Mapdat(maps[whichMap_y][whichMap_x]);\n          const Mapdat_Bytes = map_Mapdat.getNBT();\n          postMessage({\n            head: headerMessage === \"CREATE_MAPDAT_SPLIT_ZIP\" ? \"MAPDAT_BYTES_ZIP\" : \"MAPDAT_BYTES\",\n            body: {\n              whichMap_x: whichMap_x,\n              whichMap_y: whichMap_y,\n              Mapdat_Bytes: Mapdat_Bytes,\n            },\n          });\n        }\n      }\n      break;\n    }\n    default: {\n      throw new Error(\"Unknown header message\");\n    }\n  }\n};\n\n};\n","import React, { Component } from \"react\";\nimport { gzip } from \"pako\"; // blocks when zipping\nimport JSZip from \"jszip\";\n\nimport Tooltip from \"../tooltip\";\n\nimport MapModes from \"./json/mapModes.json\";\n\nimport WorkerBuilder from './workers/worker-builder';\nimport NBTWorker from \"./workers/nbt\";\n\nimport \"./greenButtons.css\";\n\nclass GreenButtons extends Component {\n  // For download buttons and donate link etc\n  state = {\n    buttonWidth_viewOnline: 1,\n    buttonWidth_NBT_Joined: 1,\n    buttonWidth_NBT_Split: 1,\n    buttonWidth_Mapdat_Split: 1,\n    mapPreviewWorker_onFinishCallback: null,\n  };\n\n  nbtWorker = new WorkerBuilder(NBTWorker);\n\n  resetButtonWidths() {\n    this.setState({\n      buttonWidth_viewOnline: 1,\n      buttonWidth_NBT_Joined: 1,\n      buttonWidth_NBT_Split: 1,\n      buttonWidth_Mapdat_Split: 1,\n    });\n  }\n\n  getNBT_base = (workerHeader) => {\n    const {\n      getLocaleString,\n      coloursJSON,\n      optionValue_version,\n      optionValue_mapSize_x,\n      optionValue_mapSize_y,\n      optionValue_staircasing,\n      optionValue_supportBlock,\n      optionValue_mapdatFilenameUseId,\n      optionValue_mapdatFilenameIdStart,\n      uploadedImage_baseFilename,\n      currentMaterialsData,\n      mapPreviewWorker_inProgress,\n      downloadBlobFile,\n      onGetViewOnlineNBT,\n    } = this.props;\n    if (mapPreviewWorker_inProgress) {\n      this.setState({ mapPreviewWorker_onFinishCallback: () => this.getNBT_base(workerHeader) });\n      return;\n    }\n    if (Object.entries(currentMaterialsData.currentSelectedBlocks).every((elt) => elt[1] === \"-1\")) {\n      alert(getLocaleString(\"DOWNLOAD/ERROR-NONE-SELECTED\"));\n      return;\n    }\n    this.nbtWorker.terminate();\n    this.resetButtonWidths();\n    let numberOfSplitsCalculated = 0;\n    let zipFile = new JSZip();\n    const t0 = performance.now();\n    this.nbtWorker = new WorkerBuilder(NBTWorker);\n    this.nbtWorker.onmessage = (e) => {\n      switch (e.data.head) {\n        case \"PROGRESS_REPORT_CREATE_NBT_JOINED_FOR_VIEW_ONLINE\": {\n          this.setState({ buttonWidth_viewOnline: e.data.body });\n          break;\n        }\n        case \"PROGRESS_REPORT_CREATE_NBT_JOINED\": {\n          this.setState({ buttonWidth_NBT_Joined: e.data.body });\n          break;\n        }\n        case \"PROGRESS_REPORT_CREATE_NBT_SPLIT\": {\n          this.setState({ buttonWidth_NBT_Split: (numberOfSplitsCalculated + e.data.body) / (optionValue_mapSize_x * optionValue_mapSize_y) });\n          break;\n        }\n        case \"PROGRESS_REPORT_CREATE_MAPDAT_SPLIT\": {\n          this.setState({ buttonWidth_Mapdat_Split: (numberOfSplitsCalculated + e.data.body) / (optionValue_mapSize_x * optionValue_mapSize_y) });\n          break;\n        }\n        case \"NBT_FOR_VIEW_ONLINE\": {\n          const t1 = performance.now();\n          console.log(`Created NBT for 'view online' by ${(t1 - t0).toString()}ms`);\n          const { NBT_Array } = e.data.body;\n          onGetViewOnlineNBT(NBT_Array);\n          break;\n        }\n        case \"NBT_ARRAY\": {\n          const t1 = performance.now();\n          console.log(`Created NBT by ${(t1 - t0).toString()}ms`);\n          numberOfSplitsCalculated++;\n          const { NBT_Array, whichMap_x, whichMap_y } = e.data.body;\n          const NBT_Array_gzipped = gzip(NBT_Array);\n          if (workerHeader === \"CREATE_NBT_SPLIT\") {\n            zipFile.file(`${uploadedImage_baseFilename}_${whichMap_x}_${whichMap_y}.nbt`, NBT_Array_gzipped);\n            if (numberOfSplitsCalculated === optionValue_mapSize_x * optionValue_mapSize_y) {\n              zipFile.generateAsync({ type: \"blob\" }).then((content) => {\n                downloadBlobFile(content, `${uploadedImage_baseFilename}.zip`);\n              });\n            }\n          } else {\n            const downloadBlob = new Blob([NBT_Array_gzipped], { type: \"application/x-minecraft-level\" });\n            downloadBlobFile(downloadBlob, `${uploadedImage_baseFilename}.nbt`);\n          }\n          break;\n        }\n        case \"MAPDAT_BYTES\": {\n          const t1 = performance.now();\n          console.log(`Created Mapdat by ${(t1 - t0).toString()}ms`);\n          numberOfSplitsCalculated++;\n          const { Mapdat_Bytes, whichMap_x, whichMap_y } = e.data.body;\n          const Mapdat_Bytes_gzipped = gzip(Mapdat_Bytes);\n          const downloadBlob = new Blob([Mapdat_Bytes_gzipped], { type: \"application/x-minecraft-level\" });\n          downloadBlobFile(downloadBlob, optionValue_mapdatFilenameUseId\n            ? `map_${(optionValue_mapdatFilenameIdStart + whichMap_y * optionValue_mapSize_x + whichMap_x).toString()}.dat`\n            : `${uploadedImage_baseFilename}_${whichMap_x.toString()}_${whichMap_y.toString()}.dat`);\n          break;\n        }\n        case \"MAPDAT_BYTES_ZIP\": {\n          const t1 = performance.now();\n          console.log(`Created Mapdat by ${(t1 - t0).toString()}ms`);\n          numberOfSplitsCalculated++;\n          const { Mapdat_Bytes, whichMap_x, whichMap_y } = e.data.body;\n          const Mapdat_Bytes_gzipped = gzip(Mapdat_Bytes);\n          zipFile.file(\n            optionValue_mapdatFilenameUseId\n              ? `map_${(optionValue_mapdatFilenameIdStart + whichMap_y * optionValue_mapSize_x + whichMap_x).toString()}.dat`\n              : `${uploadedImage_baseFilename}_${whichMap_x.toString()}_${whichMap_y.toString()}.dat`,\n            Mapdat_Bytes_gzipped\n          );\n          if (numberOfSplitsCalculated === optionValue_mapSize_x * optionValue_mapSize_y) {\n            zipFile.generateAsync({ type: \"blob\" }).then((content) => {\n              downloadBlobFile(content, `${uploadedImage_baseFilename}.zip`);\n            });\n          }\n          break;\n        }\n        default: {\n          throw new Error(\"Unknown worker response header\");\n        }\n      }\n    };\n    this.nbtWorker.postMessage({\n      head: workerHeader,\n      body: {\n        coloursJSON: coloursJSON,\n        MapModes: MapModes,\n        optionValue_version: optionValue_version,\n        optionValue_staircasing: optionValue_staircasing,\n        optionValue_supportBlock: optionValue_supportBlock,\n        pixelsData: currentMaterialsData.pixelsData,\n        maps: currentMaterialsData.maps,\n        currentSelectedBlocks: currentMaterialsData.currentSelectedBlocks,\n      },\n    });\n  };\n\n  onViewOnlineClicked = () => {\n    this.getNBT_base(\"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\");\n  };\n\n  onGetNBTClicked = () => {\n    this.getNBT_base(\"CREATE_NBT_JOINED\");\n  };\n\n  onGetNBTSplitClicked = () => {\n    this.getNBT_base(\"CREATE_NBT_SPLIT\");\n  };\n\n  onGetMapdatSplitClicked = () => {\n    this.getNBT_base(\"CREATE_MAPDAT_SPLIT\");\n  };\n\n  onGetMapdatSplitZipClicked = () => {\n    this.getNBT_base(\"CREATE_MAPDAT_SPLIT_ZIP\");\n  };\n\n  componentDidUpdate_shouldNBTWorkerTerminate(prevProps) {\n    const {\n      selectedBlocks,\n      optionValue_version,\n      optionValue_modeNBTOrMapdat,\n      optionValue_mapSize_x,\n      optionValue_mapSize_y,\n      optionValue_cropImage,\n      optionValue_cropImage_zoom,\n      optionValue_cropImage_percent_x,\n      optionValue_cropImage_percent_y,\n      optionValue_staircasing,\n      optionValue_supportBlock,\n      optionValue_transparency,\n      optionValue_transparencyTolerance,\n      optionValue_mapdatFilenameUseId,\n      optionValue_mapdatFilenameIdStart,\n      optionValue_betterColour,\n      optionValue_dithering,\n      optionValue_dithering_propagation_red,\n      optionValue_dithering_propagation_green,\n      optionValue_dithering_propagation_blue,\n      optionValue_preprocessingEnabled,\n      preProcessingValue_brightness,\n      preProcessingValue_contrast,\n      preProcessingValue_saturation,\n      preProcessingValue_backgroundColourSelect,\n      preProcessingValue_backgroundColour,\n      uploadedImage,\n    } = this.props;\n    return [\n      prevProps.selectedBlocks !== selectedBlocks,\n      prevProps.optionValue_version !== optionValue_version,\n      prevProps.optionValue_modeNBTOrMapdat !== optionValue_modeNBTOrMapdat,\n      prevProps.optionValue_mapSize_x !== optionValue_mapSize_x,\n      prevProps.optionValue_mapSize_y !== optionValue_mapSize_y,\n      prevProps.optionValue_cropImage !== optionValue_cropImage,\n      prevProps.optionValue_cropImage_zoom !== optionValue_cropImage_zoom,\n      prevProps.optionValue_cropImage_percent_x !== optionValue_cropImage_percent_x,\n      prevProps.optionValue_cropImage_percent_y !== optionValue_cropImage_percent_y,\n      prevProps.optionValue_staircasing !== optionValue_staircasing,\n      prevProps.optionValue_supportBlock !== optionValue_supportBlock,\n      prevProps.optionValue_transparency !== optionValue_transparency,\n      prevProps.optionValue_transparencyTolerance !== optionValue_transparencyTolerance,\n      prevProps.optionValue_mapdatFilenameUseId !== optionValue_mapdatFilenameUseId,\n      prevProps.optionValue_mapdatFilenameIdStart !== optionValue_mapdatFilenameIdStart,\n      prevProps.optionValue_betterColour !== optionValue_betterColour,\n      prevProps.optionValue_dithering !== optionValue_dithering,\n      prevProps.optionValue_dithering_propagation_red !== optionValue_dithering_propagation_red,\n      prevProps.optionValue_dithering_propagation_green !== optionValue_dithering_propagation_green,\n      prevProps.optionValue_dithering_propagation_blue !== optionValue_dithering_propagation_blue,\n      prevProps.optionValue_preprocessingEnabled !== optionValue_preprocessingEnabled,\n      prevProps.preProcessingValue_brightness !== preProcessingValue_brightness,\n      prevProps.preProcessingValue_contrast !== preProcessingValue_contrast,\n      prevProps.preProcessingValue_saturation !== preProcessingValue_saturation,\n      prevProps.preProcessingValue_backgroundColourSelect !== preProcessingValue_backgroundColourSelect,\n      prevProps.preProcessingValue_backgroundColour !== preProcessingValue_backgroundColour,\n      prevProps.uploadedImage !== uploadedImage,\n    ].some((elt) => elt);\n  }\n\n  componentDidUpdate(prevProps) {\n    const { mapPreviewWorker_inProgress } = this.props;\n    if (this.componentDidUpdate_shouldNBTWorkerTerminate(prevProps)) {\n      // reset callback if setting changed\n      this.nbtWorker.terminate();\n      this.resetButtonWidths();\n      this.setState({ mapPreviewWorker_onFinishCallback: null });\n    } else if (!mapPreviewWorker_inProgress && this.state.mapPreviewWorker_onFinishCallback !== null) {\n      this.state.mapPreviewWorker_onFinishCallback();\n      this.setState({ mapPreviewWorker_onFinishCallback: null });\n    }\n  }\n\n  componentWillUnmount() {\n    this.nbtWorker.terminate();\n  }\n\n  render() {\n    const { buttonWidth_viewOnline, buttonWidth_NBT_Joined, buttonWidth_NBT_Split, buttonWidth_Mapdat_Split } = this.state;\n    const { getLocaleString, optionValue_modeNBTOrMapdat } = this.props;\n    let buttons_mapModeConditional;\n    // dummy text used in divs with absolutely positioned children to create correct container height\n    if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\n      buttons_mapModeConditional = (\n        <React.Fragment>\n          <Tooltip tooltipText={getLocaleString(\"VIEW-ONLINE/TITLE-TT\")}>\n            <div className=\"greenButton\" onClick={this.onViewOnlineClicked}>\n              <span className=\"greenButton_text_dummy\">{getLocaleString(\"VIEW-ONLINE/TITLE\")}</span>\n              <span className=\"greenButton_text\">{getLocaleString(\"VIEW-ONLINE/TITLE\")}</span>\n              <div\n                className=\"greenButton_progressDiv\"\n                style={{\n                  width: `${Math.floor(buttonWidth_viewOnline * 100)}%`,\n                }}\n              />\n            </div>\n          </Tooltip>\n          <br />\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-TT\")}>\n            <div className=\"greenButton\" onClick={this.onGetNBTClicked}>\n              <span className=\"greenButton_large_text_dummy\">{getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD\")}</span>\n              <span className=\"greenButton_large_text\">{getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD\")}</span>\n              <div\n                className=\"greenButton_progressDiv\"\n                style={{\n                  width: `${Math.floor(buttonWidth_NBT_Joined * 100)}%`,\n                }}\n              />\n            </div>\n          </Tooltip>\n          <br />\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT-TT\")}>\n            <div className=\"greenButton\" onClick={this.onGetNBTSplitClicked}>\n              <span className=\"greenButton_text_dummy\">{`${getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT\")} .ZIP`}</span>\n              <span className=\"greenButton_text\">{`${getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT\")} .ZIP`}</span>\n              <div\n                className=\"greenButton_progressDiv\"\n                style={{\n                  width: `${Math.floor(buttonWidth_NBT_Split * 100)}%`,\n                }}\n              />\n            </div>\n          </Tooltip>\n          <br />\n        </React.Fragment>\n      );\n    } else {\n      buttons_mapModeConditional = (\n        <React.Fragment>\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD-TT\")}>\n            <div className=\"greenButton\" onClick={this.onGetMapdatSplitClicked}>\n              <span className=\"greenButton_large_text_dummy\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")}`}</span>\n              <span className=\"greenButton_large_text\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")}`}</span>\n              <div\n                className=\"greenButton_progressDiv\"\n                style={{\n                  width: `${Math.floor(buttonWidth_Mapdat_Split * 100)}%`,\n                }}\n              />\n            </div>\n          </Tooltip>\n          <br />\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD-TT\")}>\n            <div className=\"greenButton\" onClick={this.onGetMapdatSplitZipClicked}>\n              <span className=\"greenButton_large_text_dummy\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")} .ZIP`}</span>\n              <span className=\"greenButton_large_text\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")} .ZIP`}</span>\n              <div\n                className=\"greenButton_progressDiv\"\n                style={{\n                  width: `${Math.floor(buttonWidth_Mapdat_Split * 100)}%`,\n                }}\n              />\n            </div>\n          </Tooltip>\n          <br />\n        </React.Fragment>\n      );\n    }\n    const button_donate = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"DONATE/TITLE-TT\")}>\n          <div className=\"greenButton\">\n            <a style={{ textDecoration: \"none\" }} href=\"https://rebane2001.com/mapartcraft/supporters\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <span className=\"greenButton_text_dummy\" style={{ backgroundColor: \"#688e6b\", color: \"#333333\" }}>\n                {getLocaleString(\"DONATE/TITLE\")}\n              </span>\n              <span className=\"greenButton_text\" style={{ backgroundColor: \"#688e6b\", color: \"#333333\" }}>\n                {getLocaleString(\"DONATE/TITLE\")}\n              </span>\n            </a>\n          </div>\n        </Tooltip>\n      </React.Fragment>\n    );\n    const buttonsDiv = (\n      <div>\n        {buttons_mapModeConditional}\n        {/* {button_donate} removed due to closed donation link */}\n      </div>\n    );\n    return buttonsDiv;\n  }\n}\n\nexport default GreenButtons;\n","// eslint-disable-next-line import/no-anonymous-default-export\n// eslint-disable-next-line no-restricted-globals\n\nexport default function MapWorker (args) {\n\nvar coloursJSON;\nvar MapModes;\nvar ColourMethods;\nvar DitherMethods;\nvar canvasImageData;\nvar selectedBlocks;\nvar disabledTones;\nvar optionValue_modeNBTOrMapdat;\nvar optionValue_mapSize_x;\nvar optionValue_mapSize_y;\nvar optionValue_staircasing;\nvar optionValue_transparency;\nvar optionValue_transparencyTolerance;\nvar optionValue_betterColour;\nvar optionValue_dithering;\nvar optionValue_dithering_propagation_red;\nvar optionValue_dithering_propagation_green;\nvar optionValue_dithering_propagation_blue;\n\nvar colourSetsToUse = []; // colourSetIds and shades to use in map\nvar exactColourCache = new Map(); // for mapping RGB that exactly matches in coloursJSON to colourSetId and tone\nvar colourCache = new Map(); // cache for reusing colours in identical pixels\nvar labCache = new Map();\nvar lab50Cache = new Map();\nvar lab65Cache = new Map();\n\nvar maps = [];\n\n/*\n  'maps' is a matrix with entries accessable via maps[z][x], each of which corresponds to a 128x128 map. A typical entry is:\n  { materials: {}, supportBlockCount: 128 }\n  'materials' is a dictionary with keys corresponding to colourSetIds and entries being the number of blocks from this colourSet required to make the map.\n*/\n\n// rgb2lab conversion based on the one from redstonehelper's program\nfunction rgb2lab(rgb) {\n  let val = (rgb[0] << 16) + (rgb[1] << 8) + rgb[2];\n  if (labCache.has(val)) return labCache.get(val);\n\n  let r1 = rgb[0] / 255.0;\n  let g1 = rgb[1] / 255.0;\n  let b1 = rgb[2] / 255.0;\n\n  r1 = 0.04045 >= r1 ? (r1 /= 12.0) : Math.pow((r1 + 0.055) / 1.055, 2.4);\n  g1 = 0.04045 >= g1 ? (g1 /= 12.0) : Math.pow((g1 + 0.055) / 1.055, 2.4);\n  b1 = 0.04045 >= b1 ? (b1 /= 12.0) : Math.pow((b1 + 0.055) / 1.055, 2.4);\n  let f = (0.43605202 * r1 + 0.3850816 * g1 + 0.14308742 * b1) / 0.964221,\n    h = 0.22249159 * r1 + 0.71688604 * g1 + 0.060621485 * b1,\n    k = (0.013929122 * r1 + 0.097097 * g1 + 0.7141855 * b1) / 0.825211,\n    l = 0.008856452 < h ? Math.pow(h, 1 / 3) : (903.2963 * h + 16.0) / 116.0,\n    m = 500.0 * ((0.008856452 < f ? Math.pow(f, 1 / 3) : (903.2963 * f + 16.0) / 116.0) - l),\n    n = 200.0 * (l - (0.008856452 < k ? Math.pow(k, 1 / 3) : (903.2963 * k + 16.0) / 116.0));\n\n  rgb = [2.55 * (116.0 * l - 16.0) + 0.5, m + 0.5, n + 0.5];\n  labCache.set(val, rgb);\n  return rgb;\n}\n\n//Code based on culori.js - https://culorijs.org/\nfunction rgb2lab50(rgb) {\n  let val = (rgb[0] << 16) + (rgb[1] << 8) + rgb[2];\n  if (lab50Cache.has(val)) return lab50Cache.get(val);\n\n  let r1 = rgb[0] / 255.0;\n  let g1 = rgb[1] / 255.0;\n  let b1 = rgb[2] / 255.0;\n\n  let x = (0.436065742824811 * r1 + 0.3851514688337912 * g1 + 0.14307845442264197 * b1) / 0.96429567642956764295676429567643,\n    y = 0.22249319175623702 * r1 + 0.7168870538238823 * g1 + 0.06061979053616537 * b1,\n    z = (0.013923904500943465 * r1 + 0.09708128566574634 * g1 + 0.7140993584005155 * b1) / 0.82510460251046025104602510460251;\n  let f1 = (0.00885645167903563081717167575546 < y ? Math.cbrt(y) : (903.2962962962962962962962962963 * y + 16) / 116);\n\n  let l = 116 * f1 - 16;\n  let a = 0;\n  let b = 0;\n\n  if (r1 !== g1 || g1 !== b1) {\n    let f0 = (0.00885645167903563081717167575546 < x ? Math.cbrt(x) : (903.2962962962962962962962962963 * x + 16) / 116);\n    let f2 = (0.00885645167903563081717167575546 < z ? Math.cbrt(z) : (903.2962962962962962962962962963 * z + 16) / 116);\n    a = 500 * (f0 - f1);\n    b = 200 * (f1 - f2);\n  }\n\n  let lab50 = [l, a, b];\n  lab50Cache.set(val, lab50);\n  return lab50;\n}\n\n//Code based on culori.js - https://culorijs.org/\nfunction rgb2lab65(rgb) {\n  let val = (rgb[0] << 16) + (rgb[1] << 8) + rgb[2];\n  if (lab65Cache.has(val)) return lab65Cache.get(val);\n\n  let r1 = rgb[0] / 255.0;\n  let g1 = rgb[1] / 255.0;\n  let b1 = rgb[2] / 255.0;\n\n  let x = (0.4123907992659593 * r1 + 0.357584339383878 * g1 + 0.1804807884018343 * b1) / 0.95045592705167173252279635258359,\n    y = 0.2126390058715102 * r1 + 0.715168678767756 * g1 + 0.0721923153607337 * b1,\n    z = (0.0193308187155918 * r1 + 0.119194779794626 * g1 + 0.9505321522496607 * b1) / 1.0890577507598784194528875379939;\n  let f1 = (0.00885645167903563081717167575546 < y ? Math.cbrt(y) : (903.2962962962962962962962962963 * y + 16) / 116);\n\n  let l = 116 * f1 - 16;\n  let a = 0;\n  let b = 0;\n\n  if (r1 !== g1 || g1 !== b1) {\n    let f0 = (0.00885645167903563081717167575546 < x ? Math.cbrt(x) : (903.2962962962962962962962962963 * x + 16) / 116);\n    let f2 = (0.00885645167903563081717167575546 < z ? Math.cbrt(z) : (903.2962962962962962962962962963 * z + 16) / 116);\n    a = 500 * (f0 - f1);\n    b = 200 * (f1 - f2);\n  }\n\n  let lab65 = [l, a, b];\n  lab65Cache.set(val, lab65);\n  return lab65;\n}\n\nfunction squaredEuclideanMetricColours(pixel1, pixel2) {\n  const chosenColourMethod =\n    ColourMethods[Object.keys(ColourMethods).find((colourMethodKey) => ColourMethods[colourMethodKey].uniqueId === optionValue_betterColour)];\n\n  if (chosenColourMethod.uniqueId === ColourMethods.MapartCraftDefault.uniqueId) {\n    //return deltaE(rgb2lab(pixel1),rgb2lab(pixel2))\n    pixel1 = rgb2lab(pixel1);\n    pixel2 = rgb2lab(pixel2);\n    const L = pixel1[0] - pixel2[0];\n    const a = pixel1[1] - pixel2[1];\n    const b = pixel1[2] - pixel2[2];\n    return L * L + a * a + b * b;\n  }\n  else if (chosenColourMethod.uniqueId === ColourMethods.Cie76_Lab50.uniqueId ||\n    chosenColourMethod.uniqueId === ColourMethods.Cie76_Lab65.uniqueId) {\n    if (chosenColourMethod.uniqueId === ColourMethods.Cie76_Lab50.uniqueId) {\n      pixel1 = rgb2lab50(pixel1);\n      pixel2 = rgb2lab50(pixel2);\n    }\n    else {\n      pixel1 = rgb2lab65(pixel1);\n      pixel2 = rgb2lab65(pixel2);\n    }\n    const L = pixel1[0] - pixel2[0];\n    const a = pixel1[1] - pixel2[1];\n    const b = pixel1[2] - pixel2[2];\n    return L * L + a * a + b * b;\n  }\n  else if (chosenColourMethod.uniqueId === ColourMethods.Ciede2000_Lab50.uniqueId ||\n      chosenColourMethod.uniqueId === ColourMethods.Ciede2000_Lab65.uniqueId) {\n    //Code based on culori.js - https://culorijs.org/\n\n    if (chosenColourMethod.uniqueId === ColourMethods.Ciede2000_Lab50.uniqueId) {\n      pixel1 = rgb2lab50(pixel1);\n      pixel2 = rgb2lab50(pixel2);\n    }\n    else {\n      pixel1 = rgb2lab65(pixel1);\n      pixel2 = rgb2lab65(pixel2);\n    }\n\n    let lStd = pixel1[0];\n    let aStd = pixel1[1];\n    let bStd = pixel1[2];\n    let cStd = Math.sqrt(aStd * aStd + bStd * bStd);\n\n    let lSmp = pixel2[0];\n    let aSmp = pixel2[1];\n    let bSmp = pixel2[2];\n    let cSmp = Math.sqrt(aSmp * aSmp + bSmp * bSmp);\n    let cAvg = (cStd + cSmp) / 2;\n\n    let cAvgPow7 = Math.pow(cAvg, 7);\n\t\tlet G =\n\t\t\t0.5 *\n\t\t\t(1 -\n\t\t\t\tMath.sqrt(\n\t\t\t\t\tcAvgPow7 / (cAvgPow7 + Math.pow(25, 7))\n\t\t\t\t));\n\n\t\tlet apStd = aStd * (1 + G);\n\t\tlet apSmp = aSmp * (1 + G);\n\n\t\tlet cpStd = Math.sqrt(apStd * apStd + bStd * bStd);\n\t\tlet cpSmp = Math.sqrt(apSmp * apSmp + bSmp * bSmp);\n\n\t\tlet hpStd =\n\t\t\tMath.abs(apStd) + Math.abs(bStd) === 0\n\t\t\t\t? 0\n\t\t\t\t: Math.atan2(bStd, apStd);\n\t\thpStd += (hpStd < 0) * 2 * Math.PI;\n\n\t\tlet hpSmp =\n\t\t\tMath.abs(apSmp) + Math.abs(bSmp) === 0\n\t\t\t\t? 0\n\t\t\t\t: Math.atan2(bSmp, apSmp);\n\t\thpSmp += (hpSmp < 0) * 2 * Math.PI;\n\n\t\tlet dL = lSmp - lStd;\n\t\tlet dC = cpSmp - cpStd;\n\n    let cpStdtimescpSmpZero = (cpStd === 0 && cpSmp === 0);\n\t\tlet dhp = cpStdtimescpSmpZero ? 0 : hpSmp - hpStd;\n\t\tdhp -= (dhp > Math.PI) * 2 * Math.PI;\n\t\tdhp += (dhp < -Math.PI) * 2 * Math.PI;\n\n\t\tlet dH = 2 * Math.sqrt(cpStd * cpSmp) * Math.sin(dhp / 2);\n\n\t\tlet Lp = (lStd + lSmp) / 2;\n\t\tlet Cp = (cpStd + cpSmp) / 2;\n\n\t\tlet hp;\n\t\tif (cpStdtimescpSmpZero) {\n\t\t\thp = hpStd + hpSmp;\n\t\t} else {\n\t\t\thp = (hpStd + hpSmp) / 2;\n\t\t\thp -= (Math.abs(hpStd - hpSmp) > Math.PI) * Math.PI;\n\t\t\thp += (hp < 0) * 2 * Math.PI;\n\t\t}\n\n    let Lpminus50 = Lp - 50;\n\t\tlet Lpm50 = Lpminus50 * Lpminus50;\n\t\tlet T =\n\t\t\t1 -\n\t\t\t0.17 * Math.cos(hp - Math.PI / 6) +\n\t\t\t0.24 * Math.cos(2 * hp) +\n\t\t\t0.32 * Math.cos(3 * hp + Math.PI / 30) -\n\t\t\t0.2 * Math.cos(4 * hp - (63 * Math.PI) / 180);\n\n\t\tlet Sl = 1 + (0.015 * Lpm50) / Math.sqrt(20 + Lpm50);\n\t\tlet Sc = 1 + 0.045 * Cp;\n\t\tlet Sh = 1 + 0.015 * Cp * T;\n\n\t\tlet deltaTheta =\n\t\t\t((30 * Math.PI) / 180) *\n\t\t\tMath.exp(-1 * Math.pow(((180 / Math.PI) * hp - 275) / 25, 2));\n\t\tlet Rc =\n\t\t\t2 *\n\t\t\tMath.sqrt(Math.pow(Cp, 7) / (Math.pow(Cp, 7) + Math.pow(25, 7)));\n\n\t\tlet Rt = -1 * Math.sin(2 * deltaTheta) * Rc;\n\n    let dLdivSl = dL / Sl;\n    let dCdivSc = dC / Sc;\n    let dHdivSh = dH / Sh;\n\t\treturn dLdivSl * dLdivSl + dCdivSc * dCdivSc + dHdivSh * dHdivSh +\n\t\t\t\t(((Rt * dC) / Sc) * dH) / Sh;\n  }\n  else {\n    const r = pixel1[0] - pixel2[0];\n    const g = pixel1[1] - pixel2[1];\n    const b = pixel1[2] - pixel2[2];\n    return r * r + g * g + b * b;\n  }\n}\n\nfunction findClosestColourSetIdAndToneAndRGBTo(pixelRGB) {\n  let RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2]; // injective mapping RGB to concatenated binaries\n  if (colourCache.has(RGBBinary)) {\n    return colourCache.get(RGBBinary);\n  } else {\n    let shortestDistance = 9999999;\n    let closestPixel;\n\n    colourSetsToUse.forEach((colourSet) => {\n      Object.keys(colourSet.tonesRGB).forEach((toneKey) => {\n        const toneRGB = colourSet.tonesRGB[toneKey];\n        let squareDistance = squaredEuclideanMetricColours(toneRGB, pixelRGB);\n        if (squareDistance < shortestDistance) {\n          shortestDistance = squareDistance;\n          closestPixel = {\n            colourSetId: colourSet.colourSetId,\n            tone: toneKey,\n          };\n        }\n      });\n    });\n    colourCache.set(RGBBinary, closestPixel);\n    return closestPixel;\n  }\n}\n\nfunction findClosest2ColourSetIdAndToneAndRGBTo(pixelRGB) {\n  let RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2];\n  if (colourCache.has(RGBBinary)) {\n    return colourCache.get(RGBBinary);\n  } else {\n    let shortestDistance1 = 9999999;\n    let shortestDistance2 = 9999999;\n    let closestPixel1 = { colourSetId: null, tone: null }; // best colour\n    let closestPixel2 = { colourSetId: null, tone: null }; // second best colour\n\n    colourSetsToUse.forEach((colourSet) => {\n      Object.keys(colourSet.tonesRGB).forEach((toneKey) => {\n        const toneRGB = colourSet.tonesRGB[toneKey];\n        let squareDistance = squaredEuclideanMetricColours(toneRGB, pixelRGB);\n        if (squareDistance < shortestDistance1) {\n          shortestDistance1 = squareDistance;\n          closestPixel1 = {\n            colourSetId: colourSet.colourSetId,\n            tone: toneKey,\n          };\n        }\n        if (squareDistance < shortestDistance2 && colourSetIdAndToneToRGB(closestPixel1.colourSetId, closestPixel1.tone) !== toneRGB) {\n          shortestDistance2 = squareDistance;\n          closestPixel2 = {\n            colourSetId: colourSet.colourSetId,\n            tone: toneKey,\n          };\n        }\n      });\n    });\n    if (\n      shortestDistance2 !== 9999999 && // to make sure closestPixel2.colourSetId/tone is not null\n      squaredEuclideanMetricColours(\n        colourSetIdAndToneToRGB(closestPixel1.colourSetId, closestPixel1.tone),\n        colourSetIdAndToneToRGB(closestPixel2.colourSetId, closestPixel2.tone)\n      ) <= shortestDistance2\n    ) {\n      closestPixel2 = closestPixel1; // if closestPixel1 is a better fit to closestPixel2 than closestPixel2 is to the actual pixel\n    }\n    let newPixels = [shortestDistance1, shortestDistance2, closestPixel1, closestPixel2];\n    colourCache.set(RGBBinary, newPixels);\n    return newPixels;\n  }\n}\n\nfunction setupColourSetsToUse() {\n  let colourSetIdsToUse = []; // get selected colour sets\n  Object.keys(selectedBlocks).forEach((key) => {\n    if (selectedBlocks[key] !== \"-1\") {\n      colourSetIdsToUse.push(key);\n    }\n  });\n\n  // now get appropriate shades\n  const toneKeys = Object.values(Object.values(MapModes).find((mapMode) => mapMode.uniqueId === optionValue_modeNBTOrMapdat).staircaseModes).find(\n    (staircaseMode) => staircaseMode.uniqueId === optionValue_staircasing\n  ).toneKeys;\n\n  for (const colourSetId of colourSetIdsToUse) {\n    let tonesRGB = {};\n    for (const toneKey of toneKeys) {\n      if (disabledTones[colourSetId].has(toneKey))\n        continue;\n\n      tonesRGB[toneKey] = coloursJSON[colourSetId].tonesRGB[toneKey];\n    }\n\n    if (Object.keys(tonesRGB).length === 0)\n      continue;\n\n    colourSetsToUse.push({\n      colourSetId: colourSetId,\n      tonesRGB: tonesRGB,\n    });\n  }\n}\n\nfunction setupExactColourCache() {\n  // we do not care what staircasing option is selected etc as this does not matter\n  // this is for exactly matching colours, whose values are never repeated in coloursJSON\n  for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n    for (const [toneKey, toneRGB] of Object.entries(colourSet.tonesRGB)) {\n      const RGBBinary = (toneRGB[0] << 16) + (toneRGB[1] << 8) + toneRGB[2];\n      exactColourCache.set(RGBBinary, {\n        colourSetId: colourSetId,\n        tone: toneKey,\n      });\n    }\n  }\n}\n\nfunction exactRGBToColourSetIdAndTone(pixelRGB) {\n  const RGBBinary = (pixelRGB[0] << 16) + (pixelRGB[1] << 8) + pixelRGB[2];\n  return exactColourCache.get(RGBBinary);\n}\n\nfunction isSupportBlockMandatoryForColourSetIdAndTone(colourSetIdAndTone) {\n  return coloursJSON[colourSetIdAndTone.colourSetId].blocks[selectedBlocks[colourSetIdAndTone.colourSetId]].supportBlockMandatory;\n}\n\nfunction colourSetIdAndToneToRGB(colourSetId, tone) {\n  return coloursJSON[colourSetId][\"tonesRGB\"][tone];\n}\n\nfunction getMapartImageDataAndMaterials() {\n  for (let y = 0; y < optionValue_mapSize_y; y++) {\n    let mapsRowToAdd = [];\n    for (let x = 0; x < optionValue_mapSize_x; x++) {\n      let mapEntryToAdd = { materials: {}, supportBlockCount: 0 };\n      colourSetsToUse.forEach((colourSet) => {\n        mapEntryToAdd.materials[colourSet.colourSetId] = 0;\n      });\n      mapsRowToAdd.push(mapEntryToAdd);\n    }\n    maps.push(mapsRowToAdd);\n  }\n\n  if (colourSetsToUse.length === 0) {\n    return;\n  }\n\n  if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\n    maps.forEach((row) =>\n      row.forEach((map) => {\n        map.supportBlockCount = 128; // initialise with noobline count\n      })\n    );\n  }\n\n  let ditherMatrix;\n  let divisor;\n  const chosenDitherMethod =\n    DitherMethods[Object.keys(DitherMethods).find((ditherMethodKey) => DitherMethods[ditherMethodKey].uniqueId === optionValue_dithering)];\n  if (chosenDitherMethod.uniqueId !== DitherMethods.None.uniqueId) {\n    ditherMatrix = chosenDitherMethod.ditherMatrix;\n  }\n  if (\n    [\n      DitherMethods.FloydSteinberg.uniqueId,\n      DitherMethods.FloydSteinberg_20.uniqueId,\n      DitherMethods.FloydSteinberg_24.uniqueId,\n      DitherMethods.MinAvgErr.uniqueId,\n      DitherMethods.Burkes.uniqueId,\n      DitherMethods.SierraLite.uniqueId,\n      DitherMethods.Stucki.uniqueId,\n      DitherMethods.Atkinson.uniqueId,\n      DitherMethods.Atkinson_6.uniqueId,\n      DitherMethods.Atkinson_10.uniqueId,\n      DitherMethods.Atkinson_12.uniqueId,\n    ].includes(chosenDitherMethod.uniqueId)\n  ) {\n    divisor = chosenDitherMethod.ditherDivisor;\n  }\n  for (let i = 0; i < canvasImageData.data.length; i += 4) {\n    const indexR = i;\n    const indexG = i + 1;\n    const indexB = i + 2;\n    const indexA = i + 3;\n\n    const multimapWidth = optionValue_mapSize_x * 128;\n    const multimap_x = (i / 4) % multimapWidth;\n    const multimap_y = (i / 4 - multimap_x) / multimapWidth;\n    const whichMap_x = Math.floor(multimap_x / 128);\n    const whichMap_y = Math.floor(multimap_y / 128);\n    const individualMap_y = multimap_y % 128;\n    if (multimap_x === 0) {\n      postMessage({\n        head: \"PROGRESS_REPORT\",\n        body: multimap_y / (128 * optionValue_mapSize_y),\n      });\n    }\n\n    let closestColourSetIdAndTone;\n    if (\n      optionValue_modeNBTOrMapdat === MapModes.MAPDAT.uniqueId &&\n      optionValue_transparency &&\n      canvasImageData.data[indexA] < optionValue_transparencyTolerance\n    ) {\n      // we specially reserve 0,0,0,0 for transparent in mapdats\n      canvasImageData.data[indexR] = 0;\n      canvasImageData.data[indexG] = 0;\n      canvasImageData.data[indexB] = 0;\n      canvasImageData.data[indexA] = 0;\n    } else {\n      canvasImageData.data[indexA] = 255; // full opacity\n      const oldPixel = [canvasImageData.data[indexR], canvasImageData.data[indexG], canvasImageData.data[indexB]];\n      switch (chosenDitherMethod.uniqueId) {\n        // Switch statement that checks the dither method every pixel;\n        // I have tested a refactor that only checks once however the time difference is negligible and code quality deteriorates\n        case DitherMethods.None.uniqueId: {\n          closestColourSetIdAndTone = findClosestColourSetIdAndToneAndRGBTo(oldPixel);\n          const closestColour = colourSetIdAndToneToRGB(closestColourSetIdAndTone.colourSetId, closestColourSetIdAndTone.tone);\n          canvasImageData.data[indexR] = closestColour[0];\n          canvasImageData.data[indexG] = closestColour[1];\n          canvasImageData.data[indexB] = closestColour[2];\n          break;\n        }\n        case DitherMethods.Bayer44.uniqueId:\n        case DitherMethods.Bayer22.uniqueId:\n        case DitherMethods.Ordered33.uniqueId: {\n          const newPixels = findClosest2ColourSetIdAndToneAndRGBTo(oldPixel);\n          // newPixels = [shortestDistance1, shortestDistance2, newPixel1, newPixel2]\n          if (\n            (newPixels[0] * (ditherMatrix[0].length * ditherMatrix.length + 1)) / newPixels[1] >\n            ditherMatrix[multimap_x % ditherMatrix[0].length][multimap_y % ditherMatrix.length]\n          ) {\n            closestColourSetIdAndTone = newPixels[3];\n          } else {\n            closestColourSetIdAndTone = newPixels[2];\n          }\n          const closestColour = colourSetIdAndToneToRGB(closestColourSetIdAndTone.colourSetId, closestColourSetIdAndTone.tone);\n          canvasImageData.data[indexR] = closestColour[0];\n          canvasImageData.data[indexG] = closestColour[1];\n          canvasImageData.data[indexB] = closestColour[2];\n          break;\n        }\n        //Error diffusion algorithms\n        case DitherMethods.FloydSteinberg.uniqueId:\n        case DitherMethods.FloydSteinberg_20.uniqueId:\n        case DitherMethods.FloydSteinberg_24.uniqueId:\n        case DitherMethods.MinAvgErr.uniqueId:\n        case DitherMethods.Burkes.uniqueId:\n        case DitherMethods.SierraLite.uniqueId:\n        case DitherMethods.Stucki.uniqueId:\n        case DitherMethods.Atkinson.uniqueId:\n        case DitherMethods.Atkinson_6.uniqueId:\n        case DitherMethods.Atkinson_10.uniqueId:\n        case DitherMethods.Atkinson_12.uniqueId:\n        {\n          closestColourSetIdAndTone = findClosestColourSetIdAndToneAndRGBTo(oldPixel);\n          const closestColour = colourSetIdAndToneToRGB(closestColourSetIdAndTone.colourSetId, closestColourSetIdAndTone.tone);\n          canvasImageData.data[indexR] = closestColour[0];\n          canvasImageData.data[indexG] = closestColour[1];\n          canvasImageData.data[indexB] = closestColour[2];\n\n          const quant_error = [\n            (oldPixel[0] - closestColour[0]) * optionValue_dithering_propagation_red / 100.0,\n            (oldPixel[1] - closestColour[1]) * optionValue_dithering_propagation_green / 100.0,\n            (oldPixel[2] - closestColour[2]) * optionValue_dithering_propagation_blue / 100.0\n          ];\n\n          try {\n            // ditherMatrix [0][0...2] should always be zero, and can thus be skipped\n            if (multimap_x + 1 < multimapWidth) {\n              // Make sure to not carry over error from one side to the other\n              const weight = ditherMatrix[0][3] / divisor; // 1 right\n              canvasImageData.data[i + 4] += quant_error[0] * weight;\n              canvasImageData.data[i + 5] += quant_error[1] * weight;\n              canvasImageData.data[i + 6] += quant_error[2] * weight;\n              if (multimap_x + 2 < multimapWidth) {\n                const weight = ditherMatrix[0][4] / divisor; // 2 right\n                canvasImageData.data[i + 8] += quant_error[0] * weight;\n                canvasImageData.data[i + 9] += quant_error[1] * weight;\n                canvasImageData.data[i + 10] += quant_error[2] * weight;\n              }\n            }\n\n            // First row below\n            if (multimap_x > 0) {\n              // Order reversed, to allow nesting of 'if' blocks\n              const weight = ditherMatrix[1][1] / divisor; // 1 down, 1 left\n              canvasImageData.data[i + multimapWidth * 4 - 4] += quant_error[0] * weight;\n              canvasImageData.data[i + multimapWidth * 4 - 3] += quant_error[1] * weight;\n              canvasImageData.data[i + multimapWidth * 4 - 2] += quant_error[2] * weight;\n              if (multimap_x > 1) {\n                const weight = ditherMatrix[1][0] / divisor; // 1 down, 2 left\n                canvasImageData.data[i + multimapWidth * 4 - 8] += quant_error[0] * weight;\n                canvasImageData.data[i + multimapWidth * 4 - 7] += quant_error[1] * weight;\n                canvasImageData.data[i + multimapWidth * 4 - 6] += quant_error[2] * weight;\n              }\n            }\n            let weight = ditherMatrix[1][2] / divisor; // 1 down\n            canvasImageData.data[i + multimapWidth * 4 + 0] += quant_error[0] * weight;\n            canvasImageData.data[i + multimapWidth * 4 + 1] += quant_error[1] * weight;\n            canvasImageData.data[i + multimapWidth * 4 + 2] += quant_error[2] * weight;\n            if (multimap_x + 1 < multimapWidth) {\n              const weight = ditherMatrix[1][3] / divisor; // 1 down, 1 right\n              canvasImageData.data[i + multimapWidth * 4 + 4] += quant_error[0] * weight;\n              canvasImageData.data[i + multimapWidth * 4 + 5] += quant_error[1] * weight;\n              canvasImageData.data[i + multimapWidth * 4 + 6] += quant_error[2] * weight;\n              if (multimap_x + 2 < multimapWidth) {\n                const weight = ditherMatrix[1][4] / divisor; // 1 down, 2 right\n                canvasImageData.data[i + multimapWidth * 4 + 8] += quant_error[0] * weight;\n                canvasImageData.data[i + multimapWidth * 4 + 9] += quant_error[1] * weight;\n                canvasImageData.data[i + multimapWidth * 4 + 10] += quant_error[2] * weight;\n              }\n            }\n\n            // Second row below\n            if (multimap_x > 0) {\n              const weight = ditherMatrix[2][1] / divisor; // 2 down, 1 left\n              canvasImageData.data[i + multimapWidth * 8 - 4] += quant_error[0] * weight;\n              canvasImageData.data[i + multimapWidth * 8 - 3] += quant_error[1] * weight;\n              canvasImageData.data[i + multimapWidth * 8 - 2] += quant_error[2] * weight;\n              if (multimap_x > 1) {\n                const weight = ditherMatrix[2][0] / divisor; // 2 down, 2 left\n                canvasImageData.data[i + multimapWidth * 8 - 8] += quant_error[0] * weight;\n                canvasImageData.data[i + multimapWidth * 8 - 7] += quant_error[1] * weight;\n                canvasImageData.data[i + multimapWidth * 8 - 6] += quant_error[2] * weight;\n              }\n            }\n            weight = ditherMatrix[2][2] / divisor; // 2 down\n            canvasImageData.data[i + multimapWidth * 8 + 0] += quant_error[0] * weight;\n            canvasImageData.data[i + multimapWidth * 8 + 1] += quant_error[1] * weight;\n            canvasImageData.data[i + multimapWidth * 8 + 2] += quant_error[2] * weight;\n            if (multimap_x + 1 < multimapWidth) {\n              const weight = ditherMatrix[2][3] / divisor; // 2 down, 1 right\n              canvasImageData.data[i + multimapWidth * 8 + 4] += quant_error[0] * weight;\n              canvasImageData.data[i + multimapWidth * 8 + 5] += quant_error[1] * weight;\n              canvasImageData.data[i + multimapWidth * 8 + 6] += quant_error[2] * weight;\n              if (multimap_x + 2 < multimapWidth) {\n                const weight = ditherMatrix[2][4] / divisor; // 2 down, 2 right\n                canvasImageData.data[i + multimapWidth * 8 + 8] += quant_error[0] * weight;\n                canvasImageData.data[i + multimapWidth * 8 + 9] += quant_error[1] * weight;\n                canvasImageData.data[i + multimapWidth * 8 + 10] += quant_error[2] * weight;\n              }\n            }\n          } catch (e) {\n            console.log(e); // ???\n          }\n          break;\n        }\n        default:\n          break;\n      }\n\n      // support-block count: mapdat can skip this\n      if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\n        maps[whichMap_y][whichMap_x].materials[closestColourSetIdAndTone.colourSetId] += 1;\n      }\n    }\n  }\n}\n\nonmessage = (e) => {\n  coloursJSON = e.data.body.coloursJSON;\n  MapModes = e.data.body.MapModes;\n  ColourMethods = e.data.body.ColourMethods;\n  DitherMethods = e.data.body.DitherMethods;\n  canvasImageData = e.data.body.canvasImageData;\n  selectedBlocks = e.data.body.selectedBlocks;\n  disabledTones = e.data.body.disabledTones;\n  optionValue_modeNBTOrMapdat = e.data.body.optionValue_modeNBTOrMapdat;\n  optionValue_mapSize_x = e.data.body.optionValue_mapSize_x;\n  optionValue_mapSize_y = e.data.body.optionValue_mapSize_y;\n  optionValue_staircasing = e.data.body.optionValue_staircasing;\n  optionValue_transparency = e.data.body.optionValue_transparency;\n  optionValue_transparencyTolerance = e.data.body.optionValue_transparencyTolerance;\n  optionValue_betterColour = e.data.body.optionValue_betterColour;\n  optionValue_dithering = e.data.body.optionValue_dithering;\n  optionValue_dithering_propagation_red = e.data.body.optionValue_dithering_propagation_red;\n  optionValue_dithering_propagation_green = e.data.body.optionValue_dithering_propagation_green;\n  optionValue_dithering_propagation_blue = e.data.body.optionValue_dithering_propagation_blue;\n\n  setupColourSetsToUse();\n  setupExactColourCache();\n  getMapartImageDataAndMaterials();\n  postMessage({\n    head: \"PIXELS_MATERIALS_CURRENTSELECTEDBLOCKS\",\n    body: {\n      pixels: canvasImageData,\n      maps: maps,\n      currentSelectedBlocks: selectedBlocks,\n    },\n  });\n};\n\n};\n","import React, { Component, createRef } from \"react\";\n\nimport Tooltip from \"../tooltip\";\nimport WorkerBuilder from './workers/worker-builder';\nimport MapCanvasWorker from \"./workers/mapCanvas\";\n\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\nimport ColourMethods from \"./json/colourMethods.json\";\nimport CropModes from \"./json/cropModes.json\";\nimport DitherMethods from \"./json/ditherMethods.json\";\nimport MapModes from \"./json/mapModes.json\";\n\nimport IMG_Null from \"../../images/null.png\";\nimport IMG_Textures from \"../../images/textures.png\";\nimport IMG_GridOverlay from \"../../images/gridOverlay.png\";\n\nimport \"./mapPreview.css\";\n\nclass MapPreview extends Component {\n  state = {\n    mapPreviewSizeScale: 2,\n    workerProgress: 0,\n  };\n\n  mapCanvasWorker = new WorkerBuilder(MapCanvasWorker);\n\n  constructor(props) {\n    super(props);\n    this.canvasRef_source = createRef(); // hidden source canvas that at all times contains the uploaded image\n    this.canvasRef_display = createRef(); // display canvas that displays to the user, may be pixels, may be image\n    this.fileInputRef = createRef();\n  }\n\n  shouldCanvasUpdate_source(prevProps, newProps, prevState, newState) {\n    const propChanges = [\n      prevProps.coloursJSON === newProps.coloursJSON,\n      prevProps.selectedBlocks === newProps.selectedBlocks,\n      prevProps.disabledTones === newProps.disabledTones,\n      prevProps.optionValue_mapSize_x === newProps.optionValue_mapSize_x,\n      prevProps.optionValue_mapSize_y === newProps.optionValue_mapSize_y,\n      prevProps.optionValue_cropImage === newProps.optionValue_cropImage,\n      prevProps.optionValue_cropImage_zoom === newProps.optionValue_cropImage_zoom,\n      prevProps.optionValue_cropImage_percent_x === newProps.optionValue_cropImage_percent_x,\n      prevProps.optionValue_cropImage_percent_y === newProps.optionValue_cropImage_percent_y,\n      prevProps.optionValue_pixelSize === newProps.optionValue_pixelSize,\n      prevProps.optionValue_staircasing === newProps.optionValue_staircasing,\n      prevProps.optionValue_preprocessingEnabled === newProps.optionValue_preprocessingEnabled,\n      prevProps.preProcessingValue_brightness === newProps.preProcessingValue_brightness,\n      prevProps.preProcessingValue_contrast === newProps.preProcessingValue_contrast,\n      prevProps.preProcessingValue_saturation === newProps.preProcessingValue_saturation,\n      prevProps.preProcessingValue_backgroundColourSelect === newProps.preProcessingValue_backgroundColourSelect,\n      prevProps.preProcessingValue_backgroundColour === newProps.preProcessingValue_backgroundColour,\n      prevProps.uploadedImage === newProps.uploadedImage,\n    ];\n    return (\n      newProps.uploadedImage !== null &&\n      prevState.workerProgress === newState.workerProgress &&\n      !propChanges.every((elt) => {\n        return elt === true;\n      })\n    );\n  }\n\n  shouldCanvasUpdate_display(prevProps, newProps, prevState, newState) {\n    // ugly but useful method to determine whether map canvas contents should be redrawn on component update\n    const propChanges = [\n      prevProps.coloursJSON === newProps.coloursJSON,\n      prevProps.selectedBlocks === newProps.selectedBlocks,\n      prevProps.disabledTones === newProps.disabledTones,\n      prevProps.optionValue_modeNBTOrMapdat === newProps.optionValue_modeNBTOrMapdat,\n      prevProps.optionValue_mapSize_x === newProps.optionValue_mapSize_x,\n      prevProps.optionValue_mapSize_y === newProps.optionValue_mapSize_y,\n      prevProps.optionValue_cropImage === newProps.optionValue_cropImage,\n      prevProps.optionValue_cropImage_zoom === newProps.optionValue_cropImage_zoom,\n      prevProps.optionValue_cropImage_percent_x === newProps.optionValue_cropImage_percent_x,\n      prevProps.optionValue_cropImage_percent_y === newProps.optionValue_cropImage_percent_y,\n      prevProps.optionValue_pixelSize === newProps.optionValue_pixelSize,\n      prevProps.optionValue_staircasing === newProps.optionValue_staircasing,\n      prevProps.optionValue_transparency === newProps.optionValue_transparency,\n      prevProps.optionValue_transparencyTolerance === newProps.optionValue_transparencyTolerance,\n      prevProps.optionValue_betterColour === newProps.optionValue_betterColour,\n      prevProps.optionValue_dithering === newProps.optionValue_dithering,\n      prevProps.optionValue_dithering_propagation_red === newProps.optionValue_dithering_propagation_red,\n      prevProps.optionValue_dithering_propagation_green === newProps.optionValue_dithering_propagation_green,\n      prevProps.optionValue_dithering_propagation_blue === newProps.optionValue_dithering_propagation_blue,\n      prevProps.optionValue_preprocessingEnabled === newProps.optionValue_preprocessingEnabled,\n      prevProps.preProcessingValue_brightness === newProps.preProcessingValue_brightness,\n      prevProps.preProcessingValue_contrast === newProps.preProcessingValue_contrast,\n      prevProps.preProcessingValue_saturation === newProps.preProcessingValue_saturation,\n      prevProps.preProcessingValue_backgroundColourSelect === newProps.preProcessingValue_backgroundColourSelect,\n      prevProps.preProcessingValue_backgroundColour === newProps.preProcessingValue_backgroundColour,\n      prevProps.uploadedImage === newProps.uploadedImage,\n    ];\n    return (\n      newProps.uploadedImage !== null &&\n      prevState.workerProgress === newState.workerProgress &&\n      !propChanges.every((elt) => {\n        return elt === true;\n      })\n    );\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.shouldCanvasUpdate_source(prevProps, this.props, prevState, this.state)) {\n      this.updateCanvas_source(); // draw uploaded image on source canvas\n    }\n    if (this.shouldCanvasUpdate_display(prevProps, this.props, prevState, this.state)) {\n      this.updateCanvas_display(); // draw pixelart of image on display canvas\n    }\n  }\n\n  closestSmoothColourTo(colourHex) {\n    const { coloursJSON, selectedBlocks, disabledTones, optionValue_staircasing } = this.props;\n    const rgbGroups_input = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(colourHex);\n    const colourRGB_input = [parseInt(rgbGroups_input[1], 16), parseInt(rgbGroups_input[2], 16), parseInt(rgbGroups_input[3], 16)];\n    let smallestDistance = 9999999;\n    let colourRGB_return = null;\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n      if (selectedBlocks[colourSetId] === \"-1\") {\n        continue;\n      }\n      let coloursRGB_colourSet = [];\n      switch (optionValue_staircasing) {\n        case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\n        case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\n        case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\n        case MapModes.MAPDAT.staircaseModes.OFF.uniqueId: {\n          if (!disabledTones[colourSetId].has(\"normal\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.normal);\n          break;\n        }\n        case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\n        case MapModes.MAPDAT.staircaseModes.FULL_DARK.uniqueId: {\n          if (!disabledTones[colourSetId].has(\"dark\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.dark);\n          break;\n        }\n        case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId:\n        case MapModes.MAPDAT.staircaseModes.FULL_LIGHT.uniqueId: {\n          if (!disabledTones[colourSetId].has(\"light\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.light);\n          break;\n        }\n        case MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId: {\n          if (!disabledTones[colourSetId].has(\"unobtainable\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.unobtainable);\n          break;\n        }\n        case MapModes.MAPDAT.staircaseModes.ON.uniqueId: {\n          if (!disabledTones[colourSetId].has(\"dark\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.dark);\n          if (!disabledTones[colourSetId].has(\"normal\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.normal);\n          if (!disabledTones[colourSetId].has(\"light\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.light);\n          break;\n        }\n        case MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId: {\n          if (!disabledTones[colourSetId].has(\"dark\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.dark);\n          if (!disabledTones[colourSetId].has(\"normal\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.normal);\n          if (!disabledTones[colourSetId].has(\"light\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.light);\n          if (!disabledTones[colourSetId].has(\"unobtainable\"))\n            coloursRGB_colourSet.push(colourSet.tonesRGB.unobtainable);\n          break;\n        }\n        default: {\n          throw new Error(\"Unknown staircasing mode\");\n        }\n      }\n      for (const colourRGB_colourSet of coloursRGB_colourSet) {\n        const colourDistance =\n          Math.pow(colourRGB_input[0] - colourRGB_colourSet[0], 2) +\n          Math.pow(colourRGB_input[1] - colourRGB_colourSet[1], 2) +\n          Math.pow(colourRGB_input[2] - colourRGB_colourSet[2], 2);\n        if (colourDistance < smallestDistance) {\n          smallestDistance = colourDistance;\n          colourRGB_return = colourRGB_colourSet;\n        }\n      }\n    }\n    const colourHex_return = `#${colourRGB_return[0].toString(16).padStart(2, \"0\")}${colourRGB_return[1].toString(16).padStart(2, \"0\")}${colourRGB_return[2]\n      .toString(16)\n      .padStart(2, \"0\")}`;\n    return colourHex_return;\n  }\n\n  updateCanvas_source() {\n    const {\n      selectedBlocks,\n      optionValue_preprocessingEnabled,\n      preProcessingValue_brightness,\n      preProcessingValue_contrast,\n      preProcessingValue_saturation,\n      preProcessingValue_backgroundColourSelect,\n      preProcessingValue_backgroundColour,\n      uploadedImage,\n    } = this.props;\n    const {\n      optionValue_mapSize_x,\n      optionValue_mapSize_y,\n      optionValue_cropImage,\n      optionValue_cropImage_zoom,\n      optionValue_cropImage_percent_x,\n      optionValue_cropImage_percent_y,\n      optionValue_pixelSize,\n    } = this.props;\n    const { canvasRef_source } = this;\n    const ctx_source = canvasRef_source.current.getContext(\"2d\");\n    ctx_source.imageSmoothingEnabled = true;   // These two options keep the map preview consistent on Chrome(ium). Otherwise the first render after changing\n    ctx_source.imageSmoothingQuality = \"high\"; // map x or z size is pixelated to a noticeably lower quality. This is not a solution to the cause but a\n                                               // workaround the effect (I do not know exactly why this happens: maybe it is to do with\n                                               // anti-fingerprinting). Firefox is unaffected by any of this.\n    ctx_source.clearRect(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\n\n    if (optionValue_preprocessingEnabled) {\n      if (preProcessingValue_backgroundColourSelect !== BackgroundColourModes.OFF.uniqueId && /^#?[a-f\\d]{6}$/i.test(preProcessingValue_backgroundColour)) {\n        let backgroundColour;\n        if (\n          preProcessingValue_backgroundColourSelect === BackgroundColourModes.SMOOTH.uniqueId &&\n          !Object.values(selectedBlocks).every((selectedBlockId) => selectedBlockId === \"-1\")\n        ) {\n          backgroundColour = this.closestSmoothColourTo(preProcessingValue_backgroundColour);\n        } else {\n          backgroundColour = preProcessingValue_backgroundColour;\n        }\n        ctx_source.filter = \"none\"; // this needs to be present to stop filters affecting background colour\n        ctx_source.rect(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\n        ctx_source.fillStyle = backgroundColour;\n        ctx_source.fill();\n      }\n      ctx_source.filter = `brightness(${preProcessingValue_brightness}%) contrast(${preProcessingValue_contrast}%) saturate(${preProcessingValue_saturation}%)`;\n    } else {\n      ctx_source.filter = \"none\";\n    }\n\n    switch (optionValue_cropImage) {\n      case CropModes.OFF.uniqueId: {\n        ctx_source.drawImage(uploadedImage, 0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\n        break;\n      }\n      case CropModes.CENTER.uniqueId:\n      case CropModes.MANUAL.uniqueId: {\n        const img_width = uploadedImage.width;\n        const img_height = uploadedImage.height;\n        let samplingWidth;\n        let samplingHeight;\n        let samplingOffset_x;\n        let samplingOffset_y;\n        if (img_width * optionValue_mapSize_y > img_height * optionValue_mapSize_x) {\n          // image w/h greater than canvas w/h\n          samplingWidth = Math.floor((10 * img_height * optionValue_mapSize_x) / (optionValue_mapSize_y * optionValue_cropImage_zoom));\n          // the 10 is because the input is from 10 to 50 in steps of 1; scale down by 10\n          samplingHeight = Math.floor((10 * img_height) / optionValue_cropImage_zoom);\n          samplingOffset_x = Math.floor((optionValue_cropImage_percent_x * (img_width - samplingWidth)) / 100);\n          samplingOffset_y = Math.floor((optionValue_cropImage_percent_y * (img_height - samplingHeight)) / 100);\n        } else {\n          // image w/h leq canvas w/h\n          samplingWidth = Math.floor((10 * img_width) / optionValue_cropImage_zoom);\n          samplingHeight = Math.floor((10 * img_width * optionValue_mapSize_y) / (optionValue_mapSize_x * optionValue_cropImage_zoom));\n          samplingOffset_x = Math.floor((optionValue_cropImage_percent_x * (img_width - samplingWidth)) / 100);\n          samplingOffset_y = Math.floor((optionValue_cropImage_percent_y * (img_height - samplingHeight)) / 100);\n        }\n        ctx_source.drawImage(\n          uploadedImage,\n          samplingOffset_x,\n          samplingOffset_y,\n          samplingWidth,\n          samplingHeight,\n          0,\n          0,\n          ctx_source.canvas.width,\n          ctx_source.canvas.height\n        );\n        break;\n      }\n      default: {\n        throw new Error(\"Unknown optionValue_cropImage\");\n      }\n    }\n\n    if (optionValue_pixelSize !== 1) {\n      const pixelationFactor = 1 / optionValue_pixelSize;\n      const canvasWidth = ctx_source.canvas.width;\n      const canvasHeight = ctx_source.canvas.height;\n      const smallWidth = Math.floor(canvasWidth * pixelationFactor);\n      const smallHeight = Math.floor(canvasHeight * pixelationFactor);\n\n      ctx_source.imageSmoothingEnabled = false;\n      ctx_source.drawImage(\n          canvasRef_source.current,\n          0, 0, canvasWidth, canvasHeight,\n          0, 0, smallWidth, smallHeight,\n      );\n\n      ctx_source.drawImage(\n          canvasRef_source.current,\n          0, 0, smallWidth, smallHeight,\n          0, 0, canvasWidth, canvasHeight,\n      );\n      ctx_source.imageSmoothingEnabled = true;\n    }\n  }\n\n  updateCanvas_display() {\n    this.mapCanvasWorker.terminate();\n    const { canvasRef_source, canvasRef_display } = this;\n    const {\n      coloursJSON,\n      selectedBlocks,\n      disabledTones,\n      optionValue_modeNBTOrMapdat,\n      optionValue_mapSize_x,\n      optionValue_mapSize_y,\n      optionValue_staircasing,\n      optionValue_transparency,\n      optionValue_transparencyTolerance,\n      optionValue_betterColour,\n      optionValue_dithering,\n      optionValue_dithering_propagation_red,\n      optionValue_dithering_propagation_green,\n      optionValue_dithering_propagation_blue,\n      onGetMapMaterials,\n      onMapPreviewWorker_begin,\n    } = this.props;\n    const ctx_source = canvasRef_source.current.getContext(\"2d\");\n    const canvasImageData = ctx_source.getImageData(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\n    const t0 = performance.now();\n    this.mapCanvasWorker = new WorkerBuilder(MapCanvasWorker);\n    this.mapCanvasWorker.onmessage = (e) => {\n      if (e.data.head === \"PIXELS_MATERIALS_CURRENTSELECTEDBLOCKS\") {\n        const t1 = performance.now();\n        console.log(`Calculated map preview data in ${(t1 - t0).toString()}ms`);\n        const ctx_display = canvasRef_display.current.getContext(\"2d\");\n        ctx_display.putImageData(e.data.body.pixels, 0, 0);\n        this.setState({ workerProgress: 1 });\n        onGetMapMaterials({\n          pixelsData: e.data.body.pixels.data,\n          maps: e.data.body.maps,\n          currentSelectedBlocks: e.data.body.currentSelectedBlocks,\n        });\n      } else if (e.data.head === \"PROGRESS_REPORT\") {\n        this.setState({ workerProgress: e.data.body });\n      }\n    };\n    onMapPreviewWorker_begin();\n    this.mapCanvasWorker.postMessage({\n      head: \"PIXELS\",\n      body: {\n        coloursJSON: coloursJSON,\n        MapModes: MapModes,\n        ColourMethods: ColourMethods,\n        DitherMethods: DitherMethods,\n        canvasImageData: canvasImageData,\n        selectedBlocks: selectedBlocks,\n        disabledTones: disabledTones,\n        optionValue_modeNBTOrMapdat: optionValue_modeNBTOrMapdat,\n        optionValue_mapSize_x: optionValue_mapSize_x,\n        optionValue_mapSize_y: optionValue_mapSize_y,\n        optionValue_staircasing: optionValue_staircasing,\n        optionValue_transparency: optionValue_transparency,\n        optionValue_transparencyTolerance: optionValue_transparencyTolerance,\n        optionValue_betterColour: optionValue_betterColour,\n        optionValue_dithering: optionValue_dithering,\n        optionValue_dithering_propagation_red: optionValue_dithering_propagation_red,\n        optionValue_dithering_propagation_green: optionValue_dithering_propagation_green,\n        optionValue_dithering_propagation_blue: optionValue_dithering_propagation_blue,\n      },\n    });\n  }\n\n  increasePreviewScale = () => {\n    this.setState({\n      mapPreviewSizeScale: this.state.mapPreviewSizeScale * 1.2,\n    });\n  };\n\n  decreasePreviewScale = () => {\n    this.setState({\n      mapPreviewSizeScale: this.state.mapPreviewSizeScale / 1.2,\n    });\n  };\n\n  componentWillUnmount() {\n    this.mapCanvasWorker.terminate();\n  }\n\n  render() {\n    const {\n      getLocaleString,\n      optionValue_mapSize_x, // map size in maps\n      optionValue_mapSize_y,\n      optionValue_cropImage,\n      optionValue_showGridOverlay,\n      onFileDialogEvent,\n      uploadedImage,\n    } = this.props;\n    const { mapPreviewSizeScale, workerProgress } = this.state;\n    return (\n      <div className=\"section mapPreviewDiv\">\n        <h2>{getLocaleString(\"MAP-PREVIEW/TITLE\")}</h2>\n        <input type=\"file\" className=\"imgUpload\" ref={this.fileInputRef} onChange={onFileDialogEvent} />\n        <div>\n          <span\n            className=\"gridOverlay\"\n            style={{\n              backgroundImage: `url(${IMG_GridOverlay})`,\n              display: optionValue_showGridOverlay ? \"block\" : \"none\",\n              width: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_x).toString()}px`,\n              height: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_y).toString()}px`,\n              backgroundSize: `${(mapPreviewSizeScale * 128).toString()}px`,\n            }}\n          />\n          <canvas\n            className=\"mapCanvas\"\n            width={128 * optionValue_mapSize_x}\n            height={128 * optionValue_mapSize_y}\n            ref={this.canvasRef_display}\n            style={{\n              width: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_x).toString()}px`,\n              height: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_y).toString()}px`,\n            }}\n            onClick={() => this.fileInputRef.current.click()}\n          />\n          <canvas className=\"displayNone\" width={128 * optionValue_mapSize_x} height={128 * optionValue_mapSize_y} ref={this.canvasRef_source}></canvas>\n        </div>\n        <div className=\"mapResolutionAndZoom\">\n          <div>\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/BEST-RESOLUTION-TT\")}>\n              <small>{`${(128 * optionValue_mapSize_x).toString()}x${(128 * optionValue_mapSize_y).toString()}`}</small>\n            </Tooltip>{\" \"}\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/ASPECT-RATIO-MISMATCH-TT\")}>\n              <small\n                className=\"mapResWarning\"\n                style={{\n                  display:\n                    uploadedImage === null || uploadedImage.height * optionValue_mapSize_x === uploadedImage.width * optionValue_mapSize_y ? \"none\" : \"inline\",\n                  color: optionValue_cropImage === CropModes.OFF.uniqueId ? \"red\" : \"orange\",\n                }}\n              >\n                {uploadedImage === null ? null : `${uploadedImage.width.toString()}x${uploadedImage.height.toString()}`}\n              </small>\n            </Tooltip>\n          </div>\n          <div>\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/SCALE-PLUS-TT\")}>\n              <img\n                alt=\"+\"\n                className=\"sizeButton\"\n                src={IMG_Null}\n                style={{\n                  backgroundImage: `url(${IMG_Textures})`,\n                  backgroundPositionX: \"-96px\",\n                  backgroundPositionY: \"-2048px\",\n                }}\n                onClick={this.increasePreviewScale}\n              />\n            </Tooltip>\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/SCALE-MINUS-TT\")}>\n              <img\n                alt=\"-\"\n                className=\"sizeButton\"\n                src={IMG_Null}\n                style={{\n                  backgroundImage: `url(${IMG_Textures})`,\n                  backgroundPositionX: \"-128px\",\n                  backgroundPositionY: \"-2048px\",\n                }}\n                onClick={this.decreasePreviewScale}\n              />\n            </Tooltip>\n          </div>\n        </div>\n        <div\n          className=\"progress\"\n          style={\n            [0, 1].includes(workerProgress)\n              ? {\n                  display: \"unset\",\n                  visibility: \"hidden\",\n                }\n              : { display: \"block\" }\n          }\n        >\n          <span className=\"progressText\">{`${Math.floor(workerProgress * 100)}%`}</span>\n          <div\n            className=\"progressDiv\"\n            style={{\n              width: `${Math.floor(workerProgress * 100)}%`,\n            }}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default MapPreview;\n","import React, { Component } from \"react\";\n\nimport BlockImage from \"../blockImage\";\n\nimport \"./autoCompleteInputBlockToAdd.css\";\n\nclass AutoCompleteInputBlockToAdd extends Component {\n  state = { suggestionSelected: true };\n\n  getRelevantSuggestions = () => {\n    const { coloursJSON, value, optionValue_version } = this.props;\n    let suggestions_prefix = [];\n    let suggestions_includes = [];\n\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n      for (const [blockId, block] of Object.entries(colourSet.blocks)) {\n        if (!(optionValue_version.MCVersion in block.validVersions)) {\n          continue;\n        }\n        let blockNBTData = block.validVersions[optionValue_version.MCVersion];\n        if (typeof blockNBTData === \"string\") {\n          // this is of the form eg \"&1.12.2\"\n          blockNBTData = block.validVersions[blockNBTData.slice(1)];\n        }\n        if (!block.supportBlockMandatory) {\n          // no gravity affected blocks etc for support / noobline\n          if (blockNBTData.NBTName.startsWith(value)) {\n            suggestions_prefix.push({\n              blockName: blockNBTData.NBTName,\n              colourSetId,\n              blockId,\n            });\n          } else if (blockNBTData.NBTName.includes(value)) {\n            suggestions_includes.push({\n              blockName: blockNBTData.NBTName,\n              colourSetId,\n              blockId,\n            });\n          }\n        }\n      }\n    }\n    return suggestions_prefix.concat(suggestions_includes);\n  };\n\n  handleTextChange = (e) => {\n    const newValue = e.target.value.replace(\" \", \"_\").toLowerCase();\n    this.props.setValue(newValue);\n  };\n\n  onSuggestionClicked = (suggestion) => {\n    this.props.setValue(suggestion.blockName);\n    this.setState({ suggestionSelected: true });\n  };\n\n  onFocus = () => {\n    this.setState({ suggestionSelected: false });\n  };\n\n  render() {\n    const { coloursJSON, value } = this.props;\n    const { suggestionSelected } = this.state;\n\n    const relevantSuggestions = this.getRelevantSuggestions();\n\n    return (\n      <React.Fragment>\n        <input type=\"text\" value={value} onChange={this.handleTextChange} onFocus={this.onFocus} onClick={this.onFocus} />\n        <table className={\"blockToAddSuggestions\"} style={{ display: suggestionSelected || relevantSuggestions.length === 0 ? \"none\" : \"table\" }}>\n          <tbody>\n            {relevantSuggestions.map((suggestion) => (\n              <tr\n                className={\"blockToAddSuggestion\"}\n                key={`${suggestion.colourSetId}$_${suggestion.blockId}_${suggestion.blockName}`}\n                onClick={() => this.onSuggestionClicked(suggestion)}\n              >\n                <th>\n                  <BlockImage coloursJSON={coloursJSON} colourSetId={suggestion.colourSetId} blockId={suggestion.blockId} />\n                </th>\n                <th>{suggestion.blockName}</th>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default AutoCompleteInputBlockToAdd;\n","import { Component } from \"react\";\n\nimport \"./bufferedNumberInput.css\";\n\nclass BufferedNumberInput extends Component {\n  state = { buffer: null };\n\n  constructor(props) {\n    super(props);\n    this.state.buffer = props.value;\n  }\n\n  componentDidUpdate(prevProps) {\n    const { value } = this.props;\n    if (prevProps.value !== value) {\n      this.setState({ buffer: value });\n    }\n  }\n\n  onInputChange = (e) => {\n    const { validators, onValidInput } = this.props;\n    const newValue_buffer = e.target.value;\n    const newValue_int = parseInt(newValue_buffer);\n    this.setState({ buffer: newValue_buffer }, () => {\n      if (\n        validators.every((validator) => {\n          return validator(newValue_int);\n        })\n      ) {\n        onValidInput(newValue_int);\n      }\n    });\n  };\n\n  render() {\n    const { min, max, step, style, disabled } = this.props;\n    const { buffer } = this.state;\n    return <input type=\"number\" min={min} max={max} step={step} value={buffer} onChange={this.onInputChange} disabled={disabled} style={style} />;\n  }\n}\n\nexport default BufferedNumberInput;\n","import React, { Component } from \"react\";\n\nimport AutoCompleteInputBlockToAdd from \"./autoCompleteInputBlockToAdd/autoCompleteInputBlockToAdd\";\n\nimport BufferedNumberInput from \"./bufferedNumberInput/bufferedNumberInput\";\n\nimport Tooltip from \"../tooltip\";\n\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\nimport CropModes from \"./json/cropModes.json\";\nimport ColourMethods from \"./json/colourMethods.json\";\nimport DitherMethods from \"./json/ditherMethods.json\";\nimport MapModes from \"./json/mapModes.json\";\nimport SupportedVersions from \"./json/supportedVersions.json\";\n\nimport \"./mapSettings.css\";\n\nclass MapSettings extends Component {\n  render() {\n    const {\n      getLocaleString,\n      coloursJSON,\n      optionValue_version,\n      onOptionChange_version,\n      optionValue_mapSize_x,\n      onOptionChange_mapSize_x,\n      optionValue_mapSize_y,\n      onOptionChange_mapSize_y,\n      optionValue_modeNBTOrMapdat,\n      onOptionChange_modeNBTOrMapdat,\n      optionValue_cropImage,\n      onOptionChange_cropImage,\n      optionValue_cropImage_zoom,\n      onOptionChange_cropImage_zoom,\n      optionValue_cropImage_percent_x,\n      onOptionChange_cropImage_percent_x,\n      optionValue_cropImage_percent_y,\n      onOptionChange_cropImage_percent_y,\n      optionValue_showGridOverlay,\n      onOptionChange_showGridOverlay,\n      optionValue_pixelSize,\n      onOptionChange_pixelSize,\n      optionValue_staircasing,\n      onOptionChange_staircasing,\n      optionValue_supportBlock,\n      setOption_SupportBlock,\n      optionValue_transparency,\n      onOptionChange_transparency,\n      optionValue_transparencyTolerance,\n      onOptionChange_transparencyTolerance,\n      optionValue_mapdatFilenameUseId,\n      onOptionChange_mapdatFilenameUseId,\n      optionValue_mapdatFilenameIdStart,\n      onOptionChange_mapdatFilenameIdStart,\n      optionValue_betterColour,\n      onOptionChange_BetterColour,\n      optionValue_dithering,\n      onOptionChange_dithering,\n      optionValue_dithering_propagation_red,\n      onOptionChange_dithering_propagation_red,\n      optionValue_dithering_propagation_green,\n      onOptionChange_dithering_propagation_green,\n      optionValue_dithering_propagation_blue,\n      onOptionChange_dithering_propagation_blue,\n      optionValue_preprocessingEnabled,\n      onOptionChange_PreProcessingEnabled,\n      preProcessingValue_brightness,\n      onOptionChange_PreProcessingBrightness,\n      preProcessingValue_contrast,\n      onOptionChange_PreProcessingContrast,\n      preProcessingValue_saturation,\n      onOptionChange_PreProcessingSaturation,\n      preProcessingValue_backgroundColourSelect,\n      onOptionChange_PreProcessingBackgroundColourSelect,\n      preProcessingValue_backgroundColour,\n      onOptionChange_PreProcessingBackgroundColour,\n      optionValue_extras_moreStaircasingOptions,\n      onOptionChange_extras_moreStaircasingOptions,\n    } = this.props;\n    const setting_mode = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MODE-TT\")}>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/MODE\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <select onChange={onOptionChange_modeNBTOrMapdat} value={optionValue_modeNBTOrMapdat}>\n          {Object.values(MapModes).map((mapMode) => (\n            <option key={mapMode.uniqueId} value={mapMode.uniqueId}>\n              {mapMode.name}\n            </option>\n          ))}\n        </select>\n        <br />\n      </React.Fragment>\n    );\n    const setting_version = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/VERSION-TT\")}>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/VERSION\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <select value={optionValue_version.MCVersion} onChange={onOptionChange_version}>\n          {Object.values(SupportedVersions).map((supportedVersion) => (\n            <option key={supportedVersion.MCVersion} value={supportedVersion.MCVersion}>\n              {supportedVersion.MCVersion}\n            </option>\n          ))}\n        </select>\n        <br />\n      </React.Fragment>\n    );\n    const setting_mapSize = (\n      <React.Fragment>\n        <b>\n          {getLocaleString(\"MAP-SETTINGS/MAP-SIZE\")}\n          {\":\"}\n        </b>{\" \"}\n        <BufferedNumberInput\n          min=\"1\"\n          max={null}\n          step=\"1\"\n          value={optionValue_mapSize_x}\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\n          onValidInput={onOptionChange_mapSize_x}\n          style={{ width: \"2em\" }}\n        />\n        x\n        <BufferedNumberInput\n          min=\"1\"\n          max={null}\n          step=\"1\"\n          value={optionValue_mapSize_y}\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\n          onValidInput={onOptionChange_mapSize_y}\n          style={{ width: \"2em\" }}\n        />\n        <br />\n      </React.Fragment>\n    );\n    let setting_crop = (\n      <tr>\n        <th>\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/CROP/TITLE-TT\")}>\n            <b>\n              {getLocaleString(\"MAP-SETTINGS/CROP/TITLE\")}\n              {\":\"}\n            </b>\n          </Tooltip>{\" \"}\n        </th>\n        <td>\n          <select onChange={onOptionChange_cropImage} value={optionValue_cropImage}>\n            {Object.values(CropModes).map((cropMode) => (\n              <option key={cropMode.uniqueId} value={cropMode.uniqueId}>\n                {getLocaleString(cropMode.localeKey)}\n              </option>\n            ))}\n          </select>\n        </td>\n        <td />\n      </tr>\n    );\n    let setting_crop_zoom = null;\n    let setting_crop_percent_x = null;\n    let setting_crop_percent_y = null;\n    if (optionValue_cropImage === CropModes.MANUAL.uniqueId) {\n      setting_crop_zoom = (\n        <tr>\n          <th>\n            <b>\n              {getLocaleString(\"MAP-SETTINGS/CROP/ZOOM\")}\n              {\":\"}\n            </b>{\" \"}\n          </th>\n          <td>\n            <input\n              type=\"range\"\n              min=\"10\"\n              max=\"50\"\n              value={optionValue_cropImage_zoom}\n              onChange={(e) => onOptionChange_cropImage_zoom(parseInt(e.target.value))}\n            />\n          </td>\n          <td />\n        </tr>\n      );\n      setting_crop_percent_x = (\n        <tr>\n          <th>\n            <b>{\"X:\"}</b>{\" \"}\n          </th>\n          <td>\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"100\"\n              value={optionValue_cropImage_percent_x}\n              onChange={(e) => onOptionChange_cropImage_percent_x(parseInt(e.target.value))}\n            />\n          </td>\n          <td>\n            <BufferedNumberInput\n              min=\"0\"\n              max=\"100\"\n              step=\"1\"\n              value={optionValue_cropImage_percent_x}\n              validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 100]}\n              onValidInput={onOptionChange_cropImage_percent_x}\n              style={{ width: \"3em\" }}\n            />\n          </td>\n        </tr>\n      );\n      setting_crop_percent_y = (\n        <tr>\n          <th>\n            <b>{\"Y:\"}</b>{\" \"}\n          </th>\n          <td>\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"100\"\n              value={optionValue_cropImage_percent_y}\n              onChange={(e) => onOptionChange_cropImage_percent_y(parseInt(e.target.value))}\n            />\n          </td>\n          <td>\n            <BufferedNumberInput\n              min=\"0\"\n              max=\"100\"\n              step=\"1\"\n              value={optionValue_cropImage_percent_y}\n              validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 100]}\n              onValidInput={onOptionChange_cropImage_percent_y}\n              style={{ width: \"3em\" }}\n            />\n          </td>\n        </tr>\n      );\n    }\n    let settingGroup_cropping = (\n      <div className={optionValue_cropImage === CropModes.MANUAL.uniqueId ? \"settingsGroup\" : null}>\n        <table>\n          <tbody>\n            {setting_crop}\n            {setting_crop_zoom}\n            {setting_crop_percent_x}\n            {setting_crop_percent_y}\n          </tbody>\n        </table>\n      </div>\n    );\n    const setting_pixelSize = (\n      <React.Fragment>\n        <b>\n          {\"Pixel size\"}\n          {\":\"}\n        </b>{\" \"}\n        <BufferedNumberInput\n          min=\"1\"\n          max={null}\n          step=\"1\"\n          value={optionValue_pixelSize}\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\n          onValidInput={onOptionChange_pixelSize}\n          style={{ width: \"2em\" }}\n        />\n        <br />\n      </React.Fragment>\n    );\n    const setting_grid = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/GRID-OVERLAY-TT\")}>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/GRID-OVERLAY\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <input type=\"checkbox\" checked={optionValue_showGridOverlay} onChange={onOptionChange_showGridOverlay} />\n        <br />\n      </React.Fragment>\n    );\n    const setting_staircasing = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/3D/TITLE-TT\")}>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/3D/TITLE\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <select onChange={onOptionChange_staircasing} value={optionValue_staircasing}>\n          {Object.values(\n            optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId ? MapModes.SCHEMATIC_NBT.staircaseModes : MapModes.MAPDAT.staircaseModes\n          )\n            .filter((staircaseMode) => optionValue_extras_moreStaircasingOptions || !staircaseMode.extra)\n            .map((staircaseMode) => (\n              <option key={staircaseMode.uniqueId} value={staircaseMode.uniqueId}>\n                {getLocaleString(staircaseMode.localeKey)}\n              </option>\n            ))}\n        </select>\n        <br />\n      </React.Fragment>\n    );\n    let settings_mapModeConditional;\n    if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\n      settings_mapModeConditional = (\n        <React.Fragment>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/NBT-SPECIFIC/SUPPORT-BLOCK-TO-ADD\")}\n            {\":\"}\n          </b>{\" \"}\n          <AutoCompleteInputBlockToAdd\n            coloursJSON={coloursJSON}\n            value={optionValue_supportBlock}\n            setValue={setOption_SupportBlock}\n            optionValue_version={optionValue_version}\n          />\n          <br />\n        </React.Fragment>\n      );\n    } else {\n      let setting_transparency = (\n        <tr>\n          <th>\n            <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY-TT\")}>\n              <b>\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY\")}\n                {\":\"}\n              </b>\n            </Tooltip>{\" \"}\n          </th>\n          <td>\n            <input type=\"checkbox\" checked={optionValue_transparency} onChange={onOptionChange_transparency} />\n          </td>\n          <td />\n        </tr>\n      );\n      let setting_transparencyTolerance = null;\n      if (optionValue_transparency) {\n        setting_transparencyTolerance = (\n          <tr>\n            <th>\n              <b>\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY-TOLERANCE\")}\n                {\":\"}\n              </b>{\" \"}\n            </th>\n            <td>\n              <input\n                type=\"range\"\n                min=\"0\"\n                max=\"256\"\n                value={optionValue_transparencyTolerance}\n                onChange={(e) => onOptionChange_transparencyTolerance(parseInt(e.target.value))}\n              />\n            </td>\n            <td>\n              <BufferedNumberInput\n                min=\"0\"\n                max=\"256\"\n                step=\"1\"\n                value={optionValue_transparencyTolerance}\n                validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 256]}\n                onValidInput={onOptionChange_transparencyTolerance}\n                style={{ width: \"3em\" }}\n              />\n            </td>\n          </tr>\n        );\n      }\n      let settingGroup_transparency = (\n        <div className={optionValue_transparency ? \"settingsGroup\" : null}>\n          <table>\n            <tbody>\n              {setting_transparency}\n              {setting_transparencyTolerance}\n            </tbody>\n          </table>\n        </div>\n      );\n      let setting_mapdatFilenameUseId = (\n        <tr>\n          <th>\n            <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-USE-ID-TT\")}>\n              <b>\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-USE-ID\")}\n                {\":\"}\n              </b>\n            </Tooltip>{\" \"}\n          </th>\n          <td>\n            <input type=\"checkbox\" checked={optionValue_mapdatFilenameUseId} onChange={onOptionChange_mapdatFilenameUseId} />\n          </td>\n          <td />\n          <td />\n        </tr>\n      );\n      let setting_mapdatFilenameIdStart = null;\n      if (optionValue_mapdatFilenameUseId) {\n        setting_mapdatFilenameIdStart = (\n          <tr>\n            <th>\n              <b>\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-ID-RANGE\")}\n                {\":\"}\n              </b>{\" \"}\n            </th>\n            <td>\n              <BufferedNumberInput\n                min=\"0\"\n                step=\"1\"\n                value={optionValue_mapdatFilenameIdStart}\n                validators={[(t) => !isNaN(t), (t) => t >= 0]}\n                onValidInput={onOptionChange_mapdatFilenameIdStart}\n                style={{ width: \"3em\" }}\n              />\n            </td>\n            <td>\n              <b>{\"-\"}</b>\n            </td>\n            <td>\n              <BufferedNumberInput\n                value={-1 + optionValue_mapdatFilenameIdStart + optionValue_mapSize_x * optionValue_mapSize_y}\n                disabled={true}\n                style={{ width: \"3em\" }}\n              />\n            </td>\n          </tr>\n        );\n      }\n      let settingGroup_mapdatFilename = (\n        <div className={optionValue_mapdatFilenameUseId ? \"settingsGroup\" : null}>\n          <table>\n            <tbody>\n              {setting_mapdatFilenameUseId}\n              {setting_mapdatFilenameIdStart}\n            </tbody>\n          </table>\n        </div>\n      );\n      settings_mapModeConditional = (\n        <React.Fragment>\n          {settingGroup_transparency}\n          {settingGroup_mapdatFilename}\n        </React.Fragment>\n      );\n    }\n    const setting_betterColour = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/BETTER-COLOUR-TT\")}>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/BETTER-COLOUR\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <select value={optionValue_betterColour} onChange={onOptionChange_BetterColour}>\n          {Object.keys(ColourMethods).map((colourMethodKey) => (\n            <option key={ColourMethods[colourMethodKey][\"uniqueId\"]} value={ColourMethods[colourMethodKey][\"uniqueId\"]}>\n              {\"localeKey\" in ColourMethods[colourMethodKey]\n                ? getLocaleString(ColourMethods[colourMethodKey][\"localeKey\"])\n                : ColourMethods[colourMethodKey][\"name\"]}\n            </option>\n          ))}\n        </select>\n        <br />\n      </React.Fragment>\n    );\n    const setting_dithering = (\n      <React.Fragment>\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/DITHERING/TITLE-TT\")}>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/TITLE\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <select value={optionValue_dithering} onChange={onOptionChange_dithering}>\n          {Object.keys(DitherMethods).map((ditherMethodKey) => (\n            <option key={DitherMethods[ditherMethodKey][\"uniqueId\"]} value={DitherMethods[ditherMethodKey][\"uniqueId\"]}>\n              {\"localeKey\" in DitherMethods[ditherMethodKey]\n                ? getLocaleString(DitherMethods[ditherMethodKey][\"localeKey\"])\n                : DitherMethods[ditherMethodKey][\"name\"]}\n            </option>\n          ))}\n        </select>\n        <br />\n      </React.Fragment>\n    );\n    const setting_dithering_propagation_red = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/PROPAGATION-RED\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"200\"\n            value={optionValue_dithering_propagation_red}\n            onChange={(e) => onOptionChange_dithering_propagation_red(parseInt(e.target.value))}\n          />\n        </td>\n        <td>\n          <BufferedNumberInput\n            min=\"0\"\n            max=\"200\"\n            step=\"1\"\n            value={optionValue_dithering_propagation_red}\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\n            onValidInput={onOptionChange_dithering_propagation_red}\n            style={{ width: \"3em\" }}\n          />\n        </td>\n      </tr>\n    );\n    const setting_dithering_propagation_green = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/PROPAGATION-GREEN\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"200\"\n            value={optionValue_dithering_propagation_green}\n            onChange={(e) => onOptionChange_dithering_propagation_green(parseInt(e.target.value))}\n          />\n        </td>\n        <td>\n          <BufferedNumberInput\n            min=\"0\"\n            max=\"200\"\n            step=\"1\"\n            value={optionValue_dithering_propagation_green}\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\n            onValidInput={onOptionChange_dithering_propagation_green}\n            style={{ width: \"3em\" }}\n          />\n        </td>\n      </tr>\n    );\n    const setting_dithering_propagation_blue = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/PROPAGATION-BLUE\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"200\"\n            value={optionValue_dithering_propagation_blue}\n            onChange={(e) => onOptionChange_dithering_propagation_blue(parseInt(e.target.value))}\n          />\n        </td>\n        <td>\n          <BufferedNumberInput\n            min=\"0\"\n            max=\"200\"\n            step=\"1\"\n            value={optionValue_dithering_propagation_blue}\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\n            onValidInput={onOptionChange_dithering_propagation_blue}\n            style={{ width: \"3em\" }}\n          />\n        </td>\n      </tr>\n    );\n    const setting_dithering_propagation = (\n      <div>\n        <table>\n          <tbody>\n            {setting_dithering_propagation_red}\n            {setting_dithering_propagation_green}\n            {setting_dithering_propagation_blue}\n          </tbody>\n        </table>\n      </div>\n    );\n    const setting_preprocessing = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/ENABLE\")}\n            {\":\"}\n          </b>{\" \"}\n          <input type=\"checkbox\" checked={optionValue_preprocessingEnabled} onChange={onOptionChange_PreProcessingEnabled} />\n        </th>\n        <td />\n        <td />\n      </tr>\n    );\n    const setting_preprocessing_brightness = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BRIGHTNESS\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"200\"\n            value={preProcessingValue_brightness}\n            onChange={(e) => onOptionChange_PreProcessingBrightness(parseInt(e.target.value))}\n            disabled={!optionValue_preprocessingEnabled}\n          />\n        </td>\n        <td>\n          <BufferedNumberInput\n            min=\"0\"\n            max=\"200\"\n            step=\"1\"\n            value={preProcessingValue_brightness}\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\n            onValidInput={onOptionChange_PreProcessingBrightness}\n            disabled={!optionValue_preprocessingEnabled}\n            style={{ width: \"3em\" }}\n          />\n        </td>\n      </tr>\n    );\n    const setting_preprocessing_contrast = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/CONTRAST\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"200\"\n            value={preProcessingValue_contrast}\n            onChange={(e) => onOptionChange_PreProcessingContrast(parseInt(parseInt(e.target.value)))}\n            disabled={!optionValue_preprocessingEnabled}\n          />\n        </td>\n        <td>\n          <BufferedNumberInput\n            min=\"0\"\n            max=\"200\"\n            step=\"1\"\n            value={preProcessingValue_contrast}\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\n            onValidInput={onOptionChange_PreProcessingContrast}\n            disabled={!optionValue_preprocessingEnabled}\n            style={{ width: \"3em\" }}\n          />\n        </td>\n      </tr>\n    );\n    const setting_preprocessing_saturation = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/SATURATION\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"200\"\n            value={preProcessingValue_saturation}\n            onChange={(e) => onOptionChange_PreProcessingSaturation(parseInt(e.target.value))}\n            disabled={!optionValue_preprocessingEnabled}\n          />\n        </td>\n        <td>\n          <BufferedNumberInput\n            min=\"0\"\n            max=\"200\"\n            step=\"1\"\n            value={preProcessingValue_saturation}\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\n            onValidInput={onOptionChange_PreProcessingSaturation}\n            disabled={!optionValue_preprocessingEnabled}\n            style={{ width: \"3em\" }}\n          />\n        </td>\n      </tr>\n    );\n    const setting_preprocessing_background = (\n      <tr>\n        <th>\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND/TITLE-TT\")}>\n            <b>\n              {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND/TITLE\")}\n              {\":\"}\n            </b>\n          </Tooltip>{\" \"}\n        </th>\n        <td>\n          <select\n            onChange={onOptionChange_PreProcessingBackgroundColourSelect}\n            value={preProcessingValue_backgroundColourSelect}\n            disabled={!optionValue_preprocessingEnabled}\n          >\n            {Object.values(BackgroundColourModes).map((backgroundColourMode) => (\n              <option key={backgroundColourMode.uniqueId} value={backgroundColourMode.uniqueId}>\n                {getLocaleString(backgroundColourMode.localeKey)}\n              </option>\n            ))}\n          </select>\n        </td>\n      </tr>\n    );\n    const setting_preprocessing_backgroundColour = (\n      <tr>\n        <th>\n          <b>\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND-COLOUR\")}\n            {\":\"}\n          </b>{\" \"}\n        </th>\n        <td>\n          <input\n            type=\"color\"\n            value={preProcessingValue_backgroundColour}\n            onChange={onOptionChange_PreProcessingBackgroundColour}\n            disabled={!optionValue_preprocessingEnabled || preProcessingValue_backgroundColourSelect === BackgroundColourModes.OFF.uniqueId}\n          />\n        </td>\n      </tr>\n    );\n    const settingGroup_preprocessing = (\n      <tr>\n        <b>\n          {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/TITLE\")}\n        </b>\n        <div className={\"settingsGroup\"}>\n          <table>\n            <tbody>\n              {setting_preprocessing}\n              {setting_preprocessing_brightness}\n              {setting_preprocessing_contrast}\n              {setting_preprocessing_saturation}\n              {setting_preprocessing_background}\n              {setting_preprocessing_backgroundColour}\n            </tbody>\n          </table>\n        </div>\n      </tr>\n    );\n    const setting_extras_moreStaircasingOptions = (\n      <tr>\n        <th>\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/EXTRAS/MORE-STAIRCASING-OPTIONS-TT\")}>\n            <b>\n              {getLocaleString(\"MAP-SETTINGS/EXTRAS/MORE-STAIRCASING-OPTIONS\")}\n              {\":\"}\n            </b>\n          </Tooltip>{\" \"}\n        </th>\n        <td>\n          <input type=\"checkbox\" checked={optionValue_extras_moreStaircasingOptions} onChange={onOptionChange_extras_moreStaircasingOptions} />\n        </td>\n      </tr>\n    );\n    const settingGroup_extras = (\n      <React.Fragment>\n        <details>\n          <summary>{getLocaleString(\"MAP-SETTINGS/EXTRAS/TITLE\")}</summary>\n          <table>\n            <tbody>{setting_extras_moreStaircasingOptions}</tbody>\n          </table>\n        </details>\n      </React.Fragment>\n    );\n    const settingsDiv = (\n      <div className=\"section settingsDiv\">\n        <h2>{getLocaleString(\"MAP-SETTINGS/TITLE\")}</h2>\n        {setting_mode}\n        {setting_version}\n        {setting_mapSize}\n        {settingGroup_cropping}\n        {setting_pixelSize}\n        {setting_grid}\n        {setting_staircasing}\n        {settings_mapModeConditional}\n        {setting_betterColour}\n        {setting_dithering}\n        {setting_dithering_propagation}\n        {settingGroup_preprocessing}\n      </div>\n    );\n    return settingsDiv;\n  }\n}\n\nexport default MapSettings;\n","import React, { Component } from \"react\";\n\nimport Tooltip from \"../tooltip\";\n\nimport BlockImage from \"./blockImage\";\n\nimport \"./materials.css\";\n\nclass Materials extends Component {\n  state = { onlyMaxPerSplit: false };\n\n  onOnlyMaxPerSplitChange = () => {\n    this.setState((currentState) => ({\n      // nb this method of passing currentState instead of using this.state... is prefered; TODO neaten up controller uses\n      onlyMaxPerSplit: !currentState.onlyMaxPerSplit,\n    }));\n  };\n\n  getMaterialsCount_nonZeroMaterialsItems() {\n    const { coloursJSON, currentMaterialsData } = this.props;\n    const { onlyMaxPerSplit } = this.state;\n    const materialsCount = {};\n    for (const colourSetId of Object.keys(coloursJSON)) {\n      materialsCount[colourSetId] = 0;\n    }\n    for (const row of currentMaterialsData.maps) {\n      for (const map of row) {\n        for (const [colourSetId, materialCount] of Object.entries(map.materials)) {\n          if (onlyMaxPerSplit) {\n            materialsCount[colourSetId] = Math.max(materialsCount[colourSetId], materialCount);\n          } else {\n            materialsCount[colourSetId] += materialCount;\n          }\n        }\n      }\n    }\n    return Object.entries(materialsCount)\n      .filter(([_, value]) => value !== 0)\n      .sort((first, second) => {\n        return second[1] - first[1];\n      });\n  }\n\n  getMaterialsCount_supportBlock() {\n    const { currentMaterialsData } = this.props;\n    const { onlyMaxPerSplit } = this.state;\n    let supportBlockCount = 0;\n    currentMaterialsData.maps.forEach((row) => {\n      row.forEach((map) => {\n        const count = map.supportBlockCount;\n        if (onlyMaxPerSplit) {\n          supportBlockCount = Math.max(supportBlockCount, count);\n        } else {\n          supportBlockCount += count;\n        }\n      });\n    });\n    return supportBlockCount;\n  }\n\n  formatMaterialCount = (count) => {\n    if (count < 64) return '' + count;\n\n    const numberOfShulkers = Math.floor(count / 1728);\n    const numberOfStacks = Math.floor((count % 1728) / 64);\n    const remainder = count % 64;\n\n    const sb = numberOfShulkers > 0 ? `${numberOfShulkers} B` : \"\";\n    const stacks = numberOfStacks > 0 ? `${numberOfStacks} S` : \"\";\n    const items = remainder > 0 ? `${remainder} I`: \"\";\n\n    const split = [sb, stacks, items].filter(n => n).join(' + ');\n\n    return `${count.toString()} (${split})`;\n  };\n\n  colourSetIdAndBlockIdFromNBTName(blockName) {\n    const { coloursJSON, optionValue_version } = this.props;\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n      for (const [blockId, block] of Object.entries(colourSet.blocks)) {\n        if (!(optionValue_version.MCVersion in block.validVersions)) {\n          continue;\n        }\n        let blockNBTData = block.validVersions[optionValue_version.MCVersion];\n        if (typeof blockNBTData === \"string\") {\n          // this is of the form eg \"&1.12.2\"\n          blockNBTData = block.validVersions[blockNBTData.slice(1)];\n        }\n        if (\n          Object.keys(blockNBTData.NBTArgs).length === 0 && // no exotic blocks for noobline\n          blockName.toLowerCase() === blockNBTData.NBTName.toLowerCase()\n        ) {\n          return { colourSetId, blockId };\n        }\n      }\n    }\n    return null; // if block not found\n  }\n\n  nbtNameToColourSetId(colourSetId) {\n    const { coloursJSON, optionValue_version, currentMaterialsData } = this.props;\n    const colourSet = coloursJSON[colourSetId];\n    const selection = currentMaterialsData.currentSelectedBlocks[colourSetId];\n\n    if (selection < 0) return null;\n\n    const block = colourSet.blocks[selection];\n    if (!(optionValue_version.MCVersion in block.validVersions)) {\n      return null;\n    }\n    let blockNBTData = block.validVersions[optionValue_version.MCVersion];\n\n    if (typeof blockNBTData === \"string\") {\n      // this is of the form eg \"&1.12.2\"\n      blockNBTData = block.validVersions[blockNBTData.slice(1)];\n    }\n\n    return blockNBTData.NBTName.toLowerCase();\n  }\n\n  copyToClipboard(nonZeroMaterialsItems, supportBlockCount) {\n    const { optionValue_supportBlock} = this.props;\n\n    const mergedList = new Array(nonZeroMaterialsItems.length);\n\n    for (const [colourSetId, val] of Object.values(nonZeroMaterialsItems)) {\n      const mcId = this.nbtNameToColourSetId(colourSetId);\n      mergedList[mcId] = val;\n    }\n\n    mergedList[optionValue_supportBlock] += supportBlockCount;\n\n    const counts = Object.fromEntries(\n      Object.entries(mergedList.sort((first, second) => second - first))\n      .map(([k, v]) => [k, this.formatMaterialCount(v)]));\n\n    const NBSP = String.fromCharCode(160); //non-breaking space\n    const CRLF = String.fromCharCode(13, 10); //new line\n\n    const results = [\"```\"];\n\n    //calculate paddings\n    let nameMaxLength = 0;\n\n    for (const key of Object.keys(counts)) {\n      if (nameMaxLength < key.length)\n        nameMaxLength = key.length;\n    }\n\n    //insert each entry\n    for (const [key, val] of Object.entries(counts)) {\n      results.push(key.padEnd(nameMaxLength, NBSP) + \" = \" + val);\n    }\n\n    results.push(\"```\");\n\n    navigator.clipboard.writeText(results.join(CRLF));\n  }\n\n  render() {\n    const { getLocaleString, coloursJSON, optionValue_supportBlock, currentMaterialsData, onChangeColourSetBlock } = this.props;\n    const { onlyMaxPerSplit } = this.state;\n    const nonZeroMaterialsItems = this.getMaterialsCount_nonZeroMaterialsItems();\n    const supportBlockCount = this.getMaterialsCount_supportBlock();\n    const supportBlockIds = this.colourSetIdAndBlockIdFromNBTName(optionValue_supportBlock);\n    return (\n      <div className=\"section materialsDiv\">\n        <h2>{getLocaleString(\"MATERIALS/TITLE\")}</h2>\n        <Tooltip tooltipText={getLocaleString(\"MATERIALS/SHOW-PER-SPLIT-TT\")}>\n          <b>\n            {getLocaleString(\"MATERIALS/SHOW-PER-SPLIT\")}\n            {\":\"}\n          </b>\n        </Tooltip>{\" \"}\n        <input type=\"checkbox\" checked={onlyMaxPerSplit} onChange={this.onOnlyMaxPerSplitChange} />\n        <br />\n        <button type=\"button\" onClick={() => this.copyToClipboard(nonZeroMaterialsItems, supportBlockCount)}>{getLocaleString(\"MATERIALS/COPY-CLIPBOARD\")}</button>\n        <table id=\"materialtable\">\n          <tbody>\n            <tr>\n              <th>{getLocaleString(\"MATERIALS/BLOCK\")}</th>\n              <th>{getLocaleString(\"MATERIALS/AMOUNT\")}</th>\n            </tr>\n            {supportBlockCount !== 0 && (\n              <tr>\n                <th>\n                  <Tooltip tooltipText={getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")}>\n                    <BlockImage\n                      getLocaleString={getLocaleString}\n                      coloursJSON={coloursJSON}\n                      colourSetId={supportBlockIds === null ? \"64\" : supportBlockIds.colourSetId}\n                      blockId={supportBlockIds === null ? \"2\" : supportBlockIds.blockId}\n                    />\n                  </Tooltip>\n                </th>\n                <th>{this.formatMaterialCount(supportBlockCount)}</th>\n              </tr>\n            )}\n            {nonZeroMaterialsItems.map(([colourSetId, materialCount]) => {\n              const blockId = currentMaterialsData.currentSelectedBlocks[colourSetId];\n              return (\n                <tr key={colourSetId}>\n                  <th>\n                    <Tooltip tooltipText={coloursJSON[colourSetId].blocks[blockId].displayName}>\n                      <BlockImage coloursJSON={coloursJSON} colourSetId={colourSetId} blockId={blockId} />\n                    </Tooltip>\n                    <Tooltip tooltipText={getLocaleString(\"NONE\")}>\n                      <BlockImage\n                        getLocaleString={getLocaleString}\n                        coloursJSON={coloursJSON}\n                        colourSetId={colourSetId}\n                        blockId={\"-1\"}\n                        onClick={() => onChangeColourSetBlock(colourSetId, \"-1\")}\n                        style={{\n                          cursor: \"pointer\"\n                        }}\n                      />\n                    </Tooltip>\n                  </th>\n                  <th>{this.formatMaterialCount(materialCount)}</th>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n\nexport default Materials;\n","/*\n  A mapping from type names to NBT type numbers.\n  This is NOT just an enum, these values have to stay as they are\n  https://minecraft.wiki/w/NBT_format#TAG_definition\n*/\nconst TagTypes = {\n  end: 0,\n  byte: 1,\n  short: 2,\n  int: 3,\n  long: 4,\n  float: 5,\n  double: 6,\n  byteArray: 7,\n  string: 8,\n  list: 9,\n  compound: 10,\n  intArray: 11,\n  longArray: 12,\n};\n\nclass NBTReader {\n  constructor() {\n    if (typeof ArrayBuffer === \"undefined\") {\n      throw new Error(\"Missing required type ArrayBuffer\");\n    }\n    if (typeof DataView === \"undefined\") {\n      throw new Error(\"Missing required type DataView\");\n    }\n    if (typeof Uint8Array === \"undefined\") {\n      throw new Error(\"Missing required type Uint8Array\");\n    }\n    this.buffer = null;\n    this.dataView = null;\n    this.arrayView = null;\n    this.offset = null;\n  }\n\n  loadBuffer(buffer) {\n    this.buffer = buffer;\n    this.dataView = new DataView(this.buffer);\n    this.arrayView = new Uint8Array(this.buffer);\n    this.offset = 0;\n  }\n\n  decodeUTF8(bytes) {\n    let codepoints = [];\n    for (let i = 0; i < bytes.length; i++) {\n      const byte = bytes[i];\n      if ((byte & 0x80) === 0) {\n        // single byte 0x0001 to 0x007F\n        codepoints.push(byte);\n      } else if ((byte & 0xe0) === 0xc0) {\n        // two bytes for 0x0000 and 0x0080 to 0x07FF\n        codepoints.push(((byte & 0x1f) << 6) | (bytes[i + 1] & 0x3f));\n        i += 1;\n      } else if ((byte & 0xf0) === 0xe0) {\n        // three bytes for 0x0800 to 0xFFFF\n        codepoints.push(((byte & 0x0f) << 12) | ((bytes[i + 1] & 0x3f) << 6) | (bytes[i + 2] & 0x3f));\n        i += 2;\n      }\n    }\n    return String.fromCharCode.apply(null, codepoints);\n  }\n\n  read(dataType, size) {\n    const value = this.dataView[`get${dataType}`](this.offset);\n    this.offset += size;\n    return value;\n  }\n\n  readByType(dataType) {\n    switch (dataType) {\n      case TagTypes.end: {\n        return this.readByType(TagTypes.byte);\n      }\n      case TagTypes.byte: {\n        return this.read(\"Int8\", 1);\n      }\n      case TagTypes.short: {\n        return this.read(\"Int16\", 2);\n      }\n      case TagTypes.int: {\n        return this.read(\"Int32\", 4);\n      }\n      case TagTypes.long: {\n        // NB: special: JS doesn't support native 64 bit ints; returns an array of two 32 bit ints\n        return [this.readByType(TagTypes.int), this.readByType(TagTypes.int)];\n      }\n      case TagTypes.float: {\n        return this.read(\"Float32\", 4);\n      }\n      case TagTypes.double: {\n        return this.read(\"Float64\", 8);\n      }\n      case TagTypes.byteArray: {\n        const arrayLength = this.readByType(TagTypes.int);\n        const returnArray = this.arrayView.slice(this.offset, this.offset + arrayLength);\n        this.offset += arrayLength;\n        return returnArray;\n      }\n      case TagTypes.string: {\n        const string_bytes_length = this.readByType(TagTypes.short);\n        const string_bytes = this.arrayView.slice(this.offset, this.offset + string_bytes_length);\n        this.offset += string_bytes_length;\n        return this.decodeUTF8(string_bytes);\n      }\n      case TagTypes.list: {\n        const list_objectType = this.readByType(TagTypes.byte);\n        const list_length = this.readByType(TagTypes.int);\n        let returnObject = { type: list_objectType, value: [] };\n        for (let i = 0; i < list_length; i++) {\n          returnObject.value.push(this.readByType(list_objectType));\n        }\n        return returnObject;\n      }\n      case TagTypes.compound: {\n        let returnObject = {};\n        while (true) {\n          let tagType = this.readByType(TagTypes.byte);\n          if (tagType === TagTypes.end) {\n            break;\n          } else {\n            let key = this.readByType(TagTypes.string);\n            let value = this.readByType(tagType);\n            returnObject[key] = { type: tagType, value: value };\n          }\n        }\n        return returnObject;\n      }\n      case TagTypes.intArray: {\n        const returnArray = [];\n        const array_length = this.readByType(TagTypes.int);\n        for (let i = 0; i < array_length; i++) {\n          returnArray.push(this.readByType(TagTypes.int));\n        }\n        return returnArray;\n      }\n      case TagTypes.longArray: {\n        const returnArray = [];\n        const array_length = this.readByType(TagTypes.int);\n        for (let i = 0; i < array_length; i++) {\n          returnArray.push(this.readByType(TagTypes.long));\n          // NB this is an array of length 2 arrays of ints as specified in case:long\n        }\n        return returnArray;\n      }\n      default: {\n        throw new Error(`Unknown data type ${dataType}`);\n      }\n    }\n  }\n\n  getData() {\n    this.readByType(TagTypes.byte);\n    return {\n      name: this.readByType(TagTypes.string),\n      value: this.readByType(TagTypes.compound),\n    }; // NB this reads the top-level compound which does not have a terminating null byte\n  }\n}\n\nexport default NBTReader;\n","import React, { Component } from \"react\";\n\nimport BlockImage from \"../blockImage\";\n\nimport \"./waila.css\";\n\n// What Am I Looking At\n\nclass Waila extends Component {\n  render() {\n    const { getLocaleString, coloursJSON, selectedBlock, ...props_others } = this.props;\n    return (\n      <div className={\"viewOnline_waila\"} {...props_others}>\n        <h3>{`x: ${selectedBlock.x.toString()} y: ${selectedBlock.y.toString()} z: ${selectedBlock.z.toString()}`}</h3>\n        <BlockImage\n          getLocaleString={getLocaleString}\n          coloursJSON={coloursJSON}\n          colourSetId={selectedBlock.colourSetId.toString()}\n          blockId={selectedBlock.blockId.toString()}\n          style={{ verticalAlign: \"middle\" }}\n        />{\" \"}\n        {selectedBlock.colourSetId === 64 && selectedBlock.blockId === 2\n          ? getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")\n          : coloursJSON[selectedBlock.colourSetId.toString()].blocks[selectedBlock.blockId.toString()].displayName}\n      </div>\n    );\n  }\n}\n\nexport default Waila;\n","import React, { Component, createRef } from \"react\";\n\nimport Tooltip from \"../../tooltip\";\n\nimport MapModes from \"../json/mapModes.json\";\n\nimport IMG_Textures from \"../../../images/textures.png\";\n\nimport NBTReader from \"../nbtReader\";\nimport Waila from \"../viewOnlineCommon/waila\";\n\nimport \"./viewOnline2D.css\";\n\nclass ViewOnline2D extends Component {\n  state = {\n    viewOnline_NBT_decompressed: null,\n    selectedBlock: null,\n    zoomFactor: 1,\n    canvasOffset_x: 0,\n    canvasOffset_y: 0,\n  };\n\n  paletteIdToColourSetIdAndBlockId = [];\n  mouse = { x: 0, y: 0, down: false, movedSinceDown: null };\n\n  getNBTDecompressed() {\n    const { viewOnline_NBT } = this.props;\n    let nbtReader = new NBTReader();\n    nbtReader.loadBuffer(viewOnline_NBT);\n    const viewOnline_NBT_decompressed = nbtReader.getData();\n    return viewOnline_NBT_decompressed;\n  }\n\n  drawNBT() {\n    const { coloursJSON, optionValue_version, optionValue_mapSize_x, optionValue_mapSize_y, optionValue_staircasing } = this.props;\n    const { viewOnline_NBT_decompressed } = this.state;\n    const { canvasRef_viewOnline } = this;\n\n    this.paletteIdToColourSetIdAndBlockId = [];\n    const NBT_palette = viewOnline_NBT_decompressed.value.palette.value.value;\n    for (let paletteItem_index = 0; paletteItem_index < NBT_palette.length; paletteItem_index++) {\n      const paletteItem = NBT_palette[paletteItem_index];\n      let paletteItemFound = false;\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n        if (paletteItemFound) {\n          break;\n        }\n        for (const [blockId, block] of Object.entries(colourSet.blocks)) {\n          if (paletteItemFound) {\n            break;\n          }\n          if (!(optionValue_version.MCVersion in block.validVersions)) {\n            continue;\n          }\n          let blockNBTData = block.validVersions[optionValue_version.MCVersion];\n          if (typeof blockNBTData === \"string\") {\n            // this is of the form eg \"&1.12.2\"\n            blockNBTData = block.validVersions[blockNBTData.slice(1)];\n          }\n          if (\n            paletteItem.Name.value === `minecraft:${blockNBTData.NBTName}` &&\n            ((!(\"Properties\" in paletteItem) && Object.keys(blockNBTData.NBTArgs).length === 0) ||\n              (\"Properties\" in paletteItem &&\n                Object.keys(paletteItem.Properties.value).length === Object.keys(blockNBTData.NBTArgs).length &&\n                Object.entries(blockNBTData.NBTArgs).every(([argKey, argValue]) => {\n                  return argKey in paletteItem.Properties.value && argValue === paletteItem.Properties.value[argKey].value;\n                })))\n          ) {\n            this.paletteIdToColourSetIdAndBlockId.push([parseInt(colourSetId), parseInt(blockId)]);\n            paletteItemFound = true;\n          }\n        }\n      }\n      if (!paletteItemFound) {\n        console.log(`Didn't find ${paletteItem.Name.value} in coloursJSON; using placeholder texture`);\n        this.paletteIdToColourSetIdAndBlockId.push([64, 2]);\n      }\n    }\n\n    const img_textures = new Image();\n    img_textures.onload = () => {\n      const canvasRef_viewOnline_ctx = canvasRef_viewOnline.current.getContext(\"2d\");\n      canvasRef_viewOnline_ctx.textAlign = \"right\";\n      canvasRef_viewOnline_ctx.textBaseline = \"alphabetic\";\n      canvasRef_viewOnline_ctx.font = \"16px kenpixel_mini_square\";\n      canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 0, 1)\";\n      canvasRef_viewOnline_ctx.fillRect(0, 0, 33 * 128 * optionValue_mapSize_x, 33 * (128 * optionValue_mapSize_y + 1));\n      let currentY = null;\n      let processedNoobline = false;\n      for (const block of viewOnline_NBT_decompressed.value.blocks.value.value) {\n        const block_paletteId = block.state.value;\n        const block_coords = block.pos.value.value;\n        if (block_coords[2] === 0) {\n          if (processedNoobline) {\n            continue;\n          } else {\n            processedNoobline = true;\n            // since we ordered blocks by Z and Y in nbt.jsworker, the first block in the column is the highest block of the\n            // noobline pillar (the correct height for the map preview)\n          }\n        } else {\n          processedNoobline = false; // ready for next column\n          if (block_paletteId === NBT_palette.length - 1) {\n            // last palette entry is support / noobline. don't draw this except on the noobline\n            continue;\n          }\n        }\n        const [int_colourSetId, int_blockId] = this.paletteIdToColourSetIdAndBlockId[block_paletteId];\n        let int_colourSetId_toDraw, int_blockId_toDraw;\n        if (!(int_colourSetId === 64 && int_blockId === 2) && coloursJSON[int_colourSetId.toString()].blocks[int_blockId.toString()].presetIndex === \"CUSTOM\") {\n          // if not placeholder, and is a custom block, then draw colour on canvas\n          int_colourSetId_toDraw = 64;\n          int_blockId_toDraw = 5;\n          canvasRef_viewOnline_ctx.fillStyle = `rgb(${coloursJSON[int_colourSetId.toString()].tonesRGB.normal.join(\", \")})`;\n          canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 32, 32);\n        } else {\n          int_colourSetId_toDraw = int_colourSetId;\n          int_blockId_toDraw = int_blockId;\n        }\n        canvasRef_viewOnline_ctx.drawImage(\n          img_textures,\n          32 * int_blockId_toDraw,\n          32 * int_colourSetId_toDraw,\n          32,\n          32,\n          33 * block_coords[0],\n          33 * block_coords[2],\n          32,\n          32\n        );\n        if (block_coords[2] !== 0) {\n          if (block_coords[1] > currentY) {\n            canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.2)\";\n            for (let i = 0; i < 4; i++) {\n              canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, -2 * (i + 1));\n            }\n          } else if (block_coords[1] < currentY) {\n            canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.2)\";\n            for (let i = 0; i < 4; i++) {\n              canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, 2 * (i + 1));\n            }\n          }\n        }\n        currentY = block_coords[1];\n        canvasRef_viewOnline_ctx.strokeStyle = \"rgba(0, 0, 0, 1)\";\n        canvasRef_viewOnline_ctx.fillStyle = \"rgba(255, 255, 255, 1)\";\n        if (\n          [\n            MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\n            MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\n            MapModes.MAPDAT.staircaseModes.ON.uniqueId,\n            MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId,\n          ].includes(optionValue_staircasing)\n        ) {\n          canvasRef_viewOnline_ctx.strokeText(block_coords[1], 33 * block_coords[0] + 31, 33 * (block_coords[2] + 1) - 2, 31);\n          canvasRef_viewOnline_ctx.fillText(block_coords[1], 33 * block_coords[0] + 31, 33 * (block_coords[2] + 1) - 2, 31);\n        }\n      }\n      for (let whichChunk_x = 0; whichChunk_x < 8 * optionValue_mapSize_x; whichChunk_x++) {\n        for (let whichChunk_y = -1; whichChunk_y < 8 * optionValue_mapSize_y; whichChunk_y++) {\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(255, 0, 0, 1)\";\n          for (let x = 0; x < 16; x++) {\n            for (let y = 0; y < 16; y++) {\n              canvasRef_viewOnline_ctx.fillRect(33 * (16 * whichChunk_x + x) + 32, 33 * (16 * whichChunk_y + y + 1), 1, 33);\n              canvasRef_viewOnline_ctx.fillRect(33 * (16 * whichChunk_x + x), 33 * (16 * whichChunk_y + y + 1) + 32, 33, 1);\n            }\n          }\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 255, 1)\";\n          canvasRef_viewOnline_ctx.fillRect(33 * 16 * (whichChunk_x + 1) - 1, 33 * (16 * whichChunk_y + 1), 1, 33 * 16);\n          canvasRef_viewOnline_ctx.fillRect(33 * 16 * whichChunk_x, 33 * (16 * (whichChunk_y + 1) + 1) - 1, 33 * 16, 1);\n        }\n      }\n    };\n    img_textures.src = IMG_Textures;\n  }\n\n  handleScroll_document = function (e) {\n    e.preventDefault();\n  };\n\n  handleScroll_canvas = function (e) {\n    e.preventDefault();\n    const zoomMultiplier = 1.1;\n    const { offsetX, offsetY } = e;\n    const delta = e.wheelDelta ? e.wheelDelta : e.detail ? -e.detail : 0;\n    if (delta) {\n      this.setState((state) => {\n        return {\n          zoomFactor: delta > 0 ? state.zoomFactor * zoomMultiplier : state.zoomFactor / zoomMultiplier,\n          canvasOffset_x:\n            delta > 0 ? state.canvasOffset_x - (zoomMultiplier - 1) * offsetX : state.canvasOffset_x - ((1 - zoomMultiplier) * offsetX) / zoomMultiplier,\n          canvasOffset_y:\n            delta > 0 ? state.canvasOffset_y - (zoomMultiplier - 1) * offsetY : state.canvasOffset_y - ((1 - zoomMultiplier) * offsetY) / zoomMultiplier,\n        };\n      });\n    }\n  }.bind(this);\n\n  handleMouseDown = function (e) {\n    e.preventDefault();\n    this.mouse.x = parseInt(e.clientX);\n    this.mouse.y = parseInt(e.clientY);\n    this.mouse.down = true;\n    this.mouse.movedSinceDown = false;\n    document.addEventListener(\"mousemove\", this.handleMouseMove, { passive: false });\n  }.bind(this);\n\n  handleMouseUp = function (e) {\n    e.preventDefault();\n    this.mouse.down = false;\n    if (!this.mouse.movedSinceDown) {\n      if (e.target === this.canvasRef_viewOnline.current) {\n        const { optionValue_mapSize_x, optionValue_mapSize_y } = this.props;\n        const { viewOnline_NBT_decompressed } = this.state;\n        const { offsetX, offsetY } = e;\n        const canvas_width = e.target.clientWidth;\n        const canvas_height = e.target.clientHeight;\n        const block_x = Math.floor((offsetX * 128 * optionValue_mapSize_x) / canvas_width);\n        const block_z = Math.floor((offsetY * (128 * optionValue_mapSize_y + 1)) / canvas_height);\n        for (const block of viewOnline_NBT_decompressed.value.blocks.value.value) {\n          const block_coords = block.pos.value.value;\n          if (block_coords[0] === block_x && block_coords[2] === block_z) {\n            const block_paletteId = block.state.value;\n            const [selectedBlock_colourSetId, selectedBlock_blockId] = this.paletteIdToColourSetIdAndBlockId[block_paletteId];\n            this.setState({\n              selectedBlock: {\n                x: block_coords[0],\n                y: block_coords[1],\n                z: block_coords[2],\n                colourSetId: selectedBlock_colourSetId,\n                blockId: selectedBlock_blockId,\n              },\n            });\n            break;\n          }\n        }\n      }\n    }\n    document.removeEventListener(\"mousemove\", this.handleMouseMove, { passive: false });\n  }.bind(this);\n\n  handleMouseMove = function (e) {\n    e.preventDefault();\n    if (!this.mouse.down) {\n      return;\n    }\n    const mouseMoved_x = parseInt(e.clientX - this.mouse.x);\n    const mouseMoved_y = parseInt(e.clientY - this.mouse.y);\n\n    if (Math.abs(mouseMoved_x) > 1 || Math.abs(mouseMoved_y) > 1) {\n      this.mouse.x = e.clientX;\n      this.mouse.y = e.clientY;\n      this.mouse.movedSinceDown = true;\n    }\n\n    this.setState((state) => {\n      return { canvasOffset_x: state.canvasOffset_x + mouseMoved_x, canvasOffset_y: state.canvasOffset_y + mouseMoved_y };\n    });\n  }.bind(this);\n\n  constructor(props) {\n    super(props);\n    this.canvasRef_viewOnline = createRef();\n  }\n\n  componentDidMount() {\n    const viewOnline_NBT_decompressed = this.getNBTDecompressed();\n\n    this.setState({ viewOnline_NBT_decompressed }, () => {\n      this.drawNBT();\n      document.addEventListener(\"DOMMouseScroll\", this.handleScroll_canvas, { passive: false });\n      this.canvasRef_viewOnline.current.addEventListener(\"mousewheel\", this.handleScroll_canvas, { passive: false });\n      document.addEventListener(\"mousewheel\", this.handleScroll_document, { passive: false });\n      document.addEventListener(\"mousedown\", this.handleMouseDown, { passive: false });\n      document.addEventListener(\"mouseup\", this.handleMouseUp, { passive: false });\n    });\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"DOMMouseScroll\", this.handleScroll_canvas, { passive: false });\n    this.canvasRef_viewOnline.current.removeEventListener(\"mousewheel\", this.handleScroll_canvas, { passive: false });\n    document.removeEventListener(\"mousewheel\", this.handleScroll_document, { passive: false });\n    document.removeEventListener(\"mousedown\", this.handleMouseDown, { passive: false });\n    document.removeEventListener(\"mouseup\", this.handleMouseUp, { passive: false });\n  }\n\n  render() {\n    const { getLocaleString, coloursJSON, optionValue_mapSize_x, optionValue_mapSize_y, onGetViewOnlineNBT, onChooseViewOnline3D } = this.props;\n    const { viewOnline_NBT_decompressed, selectedBlock, zoomFactor } = this.state;\n    const { canvasOffset_x, canvasOffset_y } = this.state;\n\n    const component_controls = (\n      <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n        <h1 style={{ cursor: \"pointer\" }} onClick={() => onGetViewOnlineNBT(null)}>\n          ❌\n        </h1>\n        <h1 style={{ cursor: \"pointer\" }} onClick={onChooseViewOnline3D}>\n          3D\n        </h1>\n      </div>\n    );\n\n    let component_waila = null;\n    if (selectedBlock !== null) {\n      component_waila = <Waila coloursJSON={coloursJSON} getLocaleString={getLocaleString} selectedBlock={selectedBlock} />;\n    }\n\n    let component_size = null;\n    if (viewOnline_NBT_decompressed !== null) {\n      const [size_x, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\n      component_size = (\n        <h2 style={{ marginRight: \"0.1em\" }}>\n          {getLocaleString(\"VIEW-ONLINE/SIZE\")}\n          {\": \"}\n          {size_x.toString()}\n          {\"x\"}\n          {size_y > 256 ? (\n            <Tooltip\n              tooltipText={getLocaleString(\"VIEW-ONLINE/TOO-BIG-FOR-SINGLE\")}\n              textStyleOverrides={{\n                right: 0,\n                backgroundColor: \"orange\",\n              }}\n            >\n              <b style={{ color: \"orange\" }}>{size_y.toString()}</b>\n            </Tooltip>\n          ) : (\n            size_y.toString()\n          )}\n          {\"x\"}\n          {size_z.toString()}\n        </h2>\n      );\n    }\n\n    const component_topBar = (\n      <div className=\"topBar\">\n        {component_controls}\n        {component_waila}\n        {component_size}\n      </div>\n    );\n\n    return (\n      <div className={\"viewOnline2DContainer\"}>\n        {component_topBar}\n        <canvas\n          width={33 * 128 * optionValue_mapSize_x}\n          height={33 * (128 * optionValue_mapSize_y + 1)}\n          ref={this.canvasRef_viewOnline}\n          style={{\n            width: `${33 * 128 * optionValue_mapSize_x * zoomFactor}px`,\n            height: `${33 * (128 * optionValue_mapSize_y + 1) * zoomFactor}px`,\n            position: \"relative\",\n            left: canvasOffset_x,\n            top: canvasOffset_y,\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nexport default ViewOnline2D;\n","import { Euler, EventDispatcher, Vector3 } from \"three\";\n\nconst _euler = new Euler(0, 0, 0, \"YXZ\");\nconst _vector = new Vector3();\nconst _vector_up = new Vector3(0, 1, 0);\n\nconst _changeEvent = { type: \"change\" };\nconst _lockEvent = { type: \"lock\" };\nconst _unlockEvent = { type: \"unlock\" };\n\nconst _PI_2 = Math.PI / 2;\n\nclass PointerLockControls extends EventDispatcher {\n  constructor(camera, domElement) {\n    super();\n\n    if (domElement === undefined) {\n      console.warn('THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.');\n      domElement = document.body;\n    }\n\n    this.domElement = domElement;\n    this.isLocked = false;\n\n    // Set to constrain the pitch of the camera\n    // Range is 0 to Math.PI radians\n    this.minPolarAngle = 0; // radians\n    this.maxPolarAngle = Math.PI; // radians\n\n    const scope = this;\n\n    function onMouseMove(event) {\n      if (scope.isLocked === false) return;\n\n      const movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n      const movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n      _euler.setFromQuaternion(camera.quaternion);\n\n      _euler.y -= movementX * 0.002;\n      _euler.x -= movementY * 0.002;\n\n      _euler.x = Math.max(_PI_2 - scope.maxPolarAngle, Math.min(_PI_2 - scope.minPolarAngle, _euler.x));\n\n      camera.quaternion.setFromEuler(_euler);\n\n      scope.dispatchEvent(_changeEvent);\n    }\n\n    function onPointerlockChange() {\n      if (scope.domElement.ownerDocument.pointerLockElement === scope.domElement) {\n        scope.dispatchEvent(_lockEvent);\n\n        scope.isLocked = true;\n      } else {\n        scope.dispatchEvent(_unlockEvent);\n\n        scope.isLocked = false;\n      }\n    }\n\n    function onPointerlockError() {\n      console.error(\"THREE.PointerLockControls: Unable to use Pointer Lock API\");\n    }\n\n    this.connect = function () {\n      scope.domElement.ownerDocument.addEventListener(\"mousemove\", onMouseMove);\n      scope.domElement.ownerDocument.addEventListener(\"pointerlockchange\", onPointerlockChange);\n      scope.domElement.ownerDocument.addEventListener(\"pointerlockerror\", onPointerlockError);\n    };\n\n    this.disconnect = function () {\n      scope.domElement.ownerDocument.removeEventListener(\"mousemove\", onMouseMove);\n      scope.domElement.ownerDocument.removeEventListener(\"pointerlockchange\", onPointerlockChange);\n      scope.domElement.ownerDocument.removeEventListener(\"pointerlockerror\", onPointerlockError);\n    };\n\n    this.dispose = function () {\n      this.disconnect();\n    };\n\n    this.getObject = function () {\n      // retaining this method for backward compatibility\n\n      return camera;\n    };\n\n    this.getDirection = (function () {\n      const direction = new Vector3(0, 0, -1);\n\n      return function (v) {\n        return v.copy(direction).applyQuaternion(camera.quaternion);\n      };\n    })();\n\n    this.moveForward = function (distance) {\n      // move forward parallel to the xz-plane\n      // assumes camera.up is y-up\n\n      _vector.setFromMatrixColumn(camera.matrix, 0);\n\n      _vector.crossVectors(camera.up, _vector);\n\n      camera.position.addScaledVector(_vector, distance);\n    };\n\n    this.moveRight = function (distance) {\n      _vector.setFromMatrixColumn(camera.matrix, 0);\n\n      camera.position.addScaledVector(_vector, distance);\n    };\n\n    this.moveUp = function (distance) {\n      camera.position.addScaledVector(_vector_up, distance);\n    };\n\n    this.lock = function () {\n      this.domElement.requestPointerLock();\n    };\n\n    this.unlock = function () {\n      scope.domElement.ownerDocument.exitPointerLock();\n    };\n\n    this.connect();\n  }\n}\n\nexport { PointerLockControls };\n","import React, { Component, createRef } from \"react\";\n\nimport Tooltip from \"../../tooltip\";\n\nimport IMG_Textures from \"../../../images/textures.png\";\n\nimport NBTReader from \"../nbtReader\";\nimport Waila from \"../viewOnlineCommon/waila\";\n\nimport * as THREE from \"three\";\nimport { PointerLockControls } from \"./pointerLockControls\";\n\nimport \"./viewOnline3D.css\";\n\nclass BlockWorld {\n  faces = [\n    {\n      // left\n      uvRow: 0,\n      dir: [-1, 0, 0],\n      vertices: [\n        { pos: [0, 1, 0], uv: [0, 1] },\n        { pos: [0, 0, 0], uv: [0, 0] },\n        { pos: [0, 1, 1], uv: [1, 1] },\n        { pos: [0, 0, 1], uv: [1, 0] },\n      ],\n    },\n    {\n      // right\n      uvRow: 0,\n      dir: [1, 0, 0],\n      vertices: [\n        { pos: [1, 1, 1], uv: [0, 1] },\n        { pos: [1, 0, 1], uv: [0, 0] },\n        { pos: [1, 1, 0], uv: [1, 1] },\n        { pos: [1, 0, 0], uv: [1, 0] },\n      ],\n    },\n    {\n      // bottom\n      uvRow: 0,\n      dir: [0, -1, 0],\n      vertices: [\n        { pos: [1, 0, 1], uv: [1, 0] },\n        { pos: [0, 0, 1], uv: [0, 0] },\n        { pos: [1, 0, 0], uv: [1, 1] },\n        { pos: [0, 0, 0], uv: [0, 1] },\n      ],\n    },\n    {\n      // top\n      uvRow: 0,\n      dir: [0, 1, 0],\n      vertices: [\n        { pos: [0, 1, 1], uv: [1, 1] },\n        { pos: [1, 1, 1], uv: [0, 1] },\n        { pos: [0, 1, 0], uv: [1, 0] },\n        { pos: [1, 1, 0], uv: [0, 0] },\n      ],\n    },\n    {\n      // north\n      uvRow: 0,\n      dir: [0, 0, -1],\n      vertices: [\n        { pos: [1, 0, 0], uv: [0, 0] },\n        { pos: [0, 0, 0], uv: [1, 0] },\n        { pos: [1, 1, 0], uv: [0, 1] },\n        { pos: [0, 1, 0], uv: [1, 1] },\n      ],\n    },\n    {\n      // south\n      uvRow: 0,\n      dir: [0, 0, 1],\n      vertices: [\n        { pos: [0, 0, 1], uv: [0, 0] },\n        { pos: [1, 0, 1], uv: [1, 0] },\n        { pos: [0, 1, 1], uv: [0, 1] },\n        { pos: [1, 1, 1], uv: [1, 1] },\n      ],\n    },\n  ];\n\n  chunkSize = 16;\n  chunks = {};\n  chunks_mesh = {};\n  renderRequested = false;\n  animationFrameRequestID = null;\n\n  // for click mouse events\n  mouse = {\n    x: 0,\n    y: 0,\n    moveX: 0,\n    moveY: 0,\n  };\n\n  constructor(options) {\n    this.canvasRef = options.canvasRef;\n    this.coloursJSON = options.coloursJSON;\n    this.tileSize = options.tileSize;\n    this.tileTextureWidth = options.tileTextureWidth;\n    this.tileTextureHeight = options.tileTextureHeight;\n    const { camera_x, camera_y, camera_z } = options;\n    this.onSelectBlockCallback = options.onSelectBlockCallback;\n    // each chunk is a Uint8Array; each block is stored as colourSetId, blockId\n    // chunks represent a chunkSize^3 volume\n\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvasRef.current });\n    this.renderer.setSize(this.canvasRef.current.clientWidth, this.canvasRef.current.clientHeight, false);\n\n    this.scene = new THREE.Scene();\n    this.scene.background = new THREE.Color(\"lightblue\");\n    this.scene.add(new THREE.AmbientLight(0xdddddd));\n\n    const fov = 75;\n    const aspect = 2;\n    const near = 0.1;\n    const far = 250;\n    this.camera = new THREE.PerspectiveCamera(fov, aspect, near, far);\n    this.camera.position.set(camera_x, camera_y, camera_z);\n\n    this.controls = new PointerLockControls(this.camera, this.canvasRef.current);\n\n    const texture = new THREE.TextureLoader().load(IMG_Textures, this.render);\n    texture.magFilter = THREE.NearestFilter;\n    texture.minFilter = THREE.NearestFilter;\n\n    this.material = new THREE.MeshLambertMaterial({\n      map: texture,\n      side: THREE.FrontSide,\n      alphaTest: 0,\n      transparent: false,\n    });\n  }\n\n  startAnimationLoop = () => {\n    this.renderer.render(this.scene, this.camera);\n    this.animationFrameRequestID = window.requestAnimationFrame(this.startAnimationLoop);\n  };\n\n  stopAnimationLoop = () => {\n    window.cancelAnimationFrame(this.animationFrameRequestID);\n  };\n\n  addEventListeners() {\n    window.addEventListener(\"resize\", this.handleWindowResize);\n    this.canvasRef.current.addEventListener(\"pointerdown\", this.handlePointerDown, { passive: false });\n    this.canvasRef.current.addEventListener(\"touchstart\", this.handleTouchStart, { passive: false });\n    document.addEventListener(\"keydown\", this.handleKeyDown, { passive: false });\n    document.addEventListener(\"keyup\", this.handleKeyUp, { passive: false });\n    this.controls.connect();\n  }\n\n  handleKeyDown = function (e) {\n    e.preventDefault();\n    switch (e.key) {\n      case \"w\":\n        this.controls.moveForward(1);\n        break;\n      case \"a\":\n        this.controls.moveRight(-1);\n        break;\n      case \"s\":\n        this.controls.moveForward(-1);\n        break;\n      case \"d\":\n        this.controls.moveRight(1);\n        break;\n      case \"e\":\n        this.controls.moveUp(-1);\n        break;\n      case \" \":\n        this.controls.moveUp(1);\n        break;\n      case \"c\":\n        this.camera.fov = 25;\n        this.camera.updateProjectionMatrix();\n        break;\n      default:\n        break;\n    }\n  }.bind(this);\n\n  handleKeyUp = function (e) {\n    e.preventDefault();\n    switch (e.key) {\n      case \"c\":\n        this.camera.fov = 75;\n        this.camera.updateProjectionMatrix();\n        break;\n      default:\n        break;\n    }\n  }.bind(this);\n\n  handlePointerDown = function (e) {\n    e.preventDefault();\n    this.mouse.x = e.clientX;\n    this.mouse.y = e.clientY;\n    this.mouse.moveX = 0;\n    this.mouse.moveY = 0;\n    this.canvasRef.current.addEventListener(\"pointermove\", this.recordMovement);\n    this.canvasRef.current.addEventListener(\"pointerup\", this.selectBlockIfNoMovement);\n    this.controls.lock();\n  }.bind(this);\n\n  recordMovement = function (e) {\n    this.mouse.moveX += Math.abs(this.mouse.x - e.clientX);\n    this.mouse.moveY += Math.abs(this.mouse.y - e.clientY);\n  }.bind(this);\n\n  selectBlockIfNoMovement = function (e) {\n    if (this.mouse.moveX < 5 && this.mouse.moveY < 5) {\n      this.selectBlock(e);\n    }\n    this.canvasRef.current.removeEventListener(\"pointermove\", this.recordMovement);\n    this.canvasRef.current.removeEventListener(\"pointerup\", this.selectBlockIfNoMovement);\n  }.bind(this);\n\n  handleTouchStart = function (e) {\n    // TODO test this on mobile\n    e.preventDefault(); // prevent scrolling\n  };\n\n  handleWindowResize = function () {\n    const width = this.canvasRef.current.clientWidth;\n    const height = this.canvasRef.current.clientHeight;\n\n    this.renderer.setSize(width, height, false);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  }.bind(this);\n\n  removeEventListeners() {\n    window.removeEventListener(\"resize\", this.handleWindowResize);\n    this.canvasRef.current.removeEventListener(\"pointerdown\", this.handlePointerDown, { passive: false });\n    this.canvasRef.current.removeEventListener(\"touchstart\", this.handleTouchStart, { passive: false });\n    document.removeEventListener(\"keydown\", this.handleKeyDown, { passive: false });\n    document.removeEventListener(\"keyup\", this.handleKeyUp, { passive: false });\n    this.controls.unlock();\n    this.controls.disconnect();\n  }\n\n  computeBlockOffset(x, y, z) {\n    const { chunkSize } = this;\n    const blockX = THREE.MathUtils.euclideanModulo(x, chunkSize) | 0;\n    const blockY = THREE.MathUtils.euclideanModulo(y, chunkSize) | 0;\n    const blockZ = THREE.MathUtils.euclideanModulo(z, chunkSize) | 0;\n    return 2 * (blockY * chunkSize * chunkSize + blockZ * chunkSize + blockX);\n  }\n\n  getChunkKey(x, y, z) {\n    const { chunkSize } = this;\n    const chunkX = Math.floor(x / chunkSize);\n    const chunkY = Math.floor(y / chunkSize);\n    const chunkZ = Math.floor(z / chunkSize);\n    return `${chunkX},${chunkY},${chunkZ}`;\n  }\n\n  getChunkForBlock(x, y, z) {\n    return this.chunks[this.getChunkKey(x, y, z)];\n  }\n\n  addChunkForBlock(x, y, z) {\n    const chunkKey = this.getChunkKey(x, y, z);\n    let chunk = this.chunks[chunkKey];\n    if (!chunk) {\n      const { chunkSize } = this;\n      chunk = new Uint8Array(2 * chunkSize * chunkSize * chunkSize);\n      for (let i = 0; i < chunk.length; i++) {\n        chunk[i] = 255;\n      }\n      this.chunks[chunkKey] = chunk;\n    }\n    return chunk;\n  }\n\n  getBlock(x, y, z) {\n    const chunk = this.getChunkForBlock(x, y, z);\n    if (!chunk) {\n      return null;\n    }\n    const blockOffset = this.computeBlockOffset(x, y, z);\n    return chunk.slice(blockOffset, blockOffset + 2);\n  }\n\n  setBlock(x, y, z, colourSetId, blockId) {\n    let chunk = this.getChunkForBlock(x, y, z);\n    if (!chunk) {\n      chunk = this.addChunkForBlock(x, y, z);\n    }\n    const blockOffset = this.computeBlockOffset(x, y, z);\n    chunk[blockOffset] = colourSetId;\n    chunk[blockOffset + 1] = blockId;\n  }\n\n  selectBlock() {\n    const canvas = this.canvasRef.current;\n    // const rect = canvas.getBoundingClientRect();\n    const pos = {\n      // x: ((e.clientX - rect.left) * canvas.width) / rect.width,\n      // y: ((e.clientY - rect.top) * canvas.height) / rect.height,\n      // x: ((rect.right + rect.left) * canvas.width) / (2 * rect.width),\n      // y: ((rect.bottom + rect.top) * canvas.height) / (2 * rect.height),\n      x: canvas.width / 2,\n      y: canvas.height / 2,\n    };\n    const x = (pos.x / canvas.width) * 2 - 1;\n    const y = (pos.y / canvas.height) * -2 + 1; // note we flip Y\n\n    const start = new THREE.Vector3();\n    const end = new THREE.Vector3();\n    start.setFromMatrixPosition(this.camera.matrixWorld);\n    end.set(x, y, 1).unproject(this.camera);\n\n    const intersection = this.intersectRay(start, end);\n    if (intersection) {\n      // the intersection point is on the face. That means\n      // the math imprecision could put us on either side of the face.\n      // so go half a normal into the block if removing (currentBlock = 0)\n      // our out of the block if adding (currentBlock  > 0)\n      // const pos = intersection.position.map((v, numberOfVertices) => {\n      //   return v + intersection.normal[numberOfVertices] * -0.5;\n      // });\n      this.onSelectBlockCallback({\n        x: intersection.block_coords.x,\n        y: intersection.block_coords.y,\n        z: intersection.block_coords.z,\n        colourSetId: intersection.block[0],\n        blockId: intersection.block[1],\n      });\n    }\n  }\n\n  intersectRay(start, end) {\n    // from\n    // http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\n    let dx = end.x - start.x;\n    let dy = end.y - start.y;\n    let dz = end.z - start.z;\n    const lenSq = dx * dx + dy * dy + dz * dz;\n    const len = Math.sqrt(lenSq);\n\n    dx /= len;\n    dy /= len;\n    dz /= len;\n\n    let t = 0.0;\n    let ix = Math.floor(start.x);\n    let iy = Math.floor(start.y);\n    let iz = Math.floor(start.z);\n\n    const stepX = dx > 0 ? 1 : -1;\n    const stepY = dy > 0 ? 1 : -1;\n    const stepZ = dz > 0 ? 1 : -1;\n\n    const txDelta = Math.abs(1 / dx);\n    const tyDelta = Math.abs(1 / dy);\n    const tzDelta = Math.abs(1 / dz);\n\n    const xDist = stepX > 0 ? ix + 1 - start.x : start.x - ix;\n    const yDist = stepY > 0 ? iy + 1 - start.y : start.y - iy;\n    const zDist = stepZ > 0 ? iz + 1 - start.z : start.z - iz;\n\n    // location of nearest block boundary, in units of t\n    let txMax = txDelta < Infinity ? txDelta * xDist : Infinity;\n    let tyMax = tyDelta < Infinity ? tyDelta * yDist : Infinity;\n    let tzMax = tzDelta < Infinity ? tzDelta * zDist : Infinity;\n\n    let steppedIndex = -1;\n\n    // main loop along raycast vector\n    while (t <= len) {\n      const block = this.getBlock(ix, iy, iz);\n      if (block !== null && !(block[0] === 255 && block[1] === 255)) {\n        return {\n          position: [start.x + t * dx, start.y + t * dy, start.z + t * dz],\n          normal: [steppedIndex === 0 ? -stepX : 0, steppedIndex === 1 ? -stepY : 0, steppedIndex === 2 ? -stepZ : 0],\n          block: block,\n          block_coords: { x: ix, y: iy, z: iz },\n        };\n      }\n\n      // advance t to next nearest block boundary\n      if (txMax < tyMax) {\n        if (txMax < tzMax) {\n          ix += stepX;\n          t = txMax;\n          txMax += txDelta;\n          steppedIndex = 0;\n        } else {\n          iz += stepZ;\n          t = tzMax;\n          tzMax += tzDelta;\n          steppedIndex = 2;\n        }\n      } else {\n        if (tyMax < tzMax) {\n          iy += stepY;\n          t = tyMax;\n          tyMax += tyDelta;\n          steppedIndex = 1;\n        } else {\n          iz += stepZ;\n          t = tzMax;\n          tzMax += tzDelta;\n          steppedIndex = 2;\n        }\n      }\n    }\n    return null;\n  }\n\n  generateGeometryDataForChunk(chunkX, chunkY, chunkZ) {\n    const { coloursJSON, chunkSize, tileSize, tileTextureWidth, tileTextureHeight } = this;\n    const verticesComponents = [];\n    const normalsComponents = [];\n    const uvs = [];\n    const indices = [];\n    const startX = chunkX * chunkSize;\n    const startY = chunkY * chunkSize;\n    const startZ = chunkZ * chunkSize;\n\n    const chunk = this.getChunkForBlock(startX, startY, startZ);\n    if (chunk) {\n      for (let y = 0; y < chunkSize; y++) {\n        const blockY = startY + y;\n        for (let z = 0; z < chunkSize; z++) {\n          const blockZ = startZ + z;\n          for (let x = 0; x < chunkSize; x++) {\n            const blockX = startX + x;\n            const blockOffset = this.computeBlockOffset(x, y, z);\n            const block = chunk.slice(blockOffset, blockOffset + 2);\n            let [colourSetId, blockId] = block;\n            if (!(colourSetId === 255 && blockId === 255)) {\n              if (!(colourSetId === 64 && blockId === 2)) {\n                // if not placeholder texture then check if custom texture needed\n                if (coloursJSON[colourSetId.toString()].blocks[blockId.toString()].presetIndex === \"CUSTOM\") {\n                  colourSetId = 64;\n                  blockId = 5;\n                }\n              }\n              // There is a block here but do we need faces for it?\n              for (const { dir, vertices, uvRow } of this.faces) {\n                const neighbor = this.getBlock(blockX + dir[0], blockY + dir[1], blockZ + dir[2]);\n                if (neighbor === null || (neighbor[0] === 255 && neighbor[1] === 255)) {\n                  // this block has no neighbor in this direction so we need a face\n                  const numberOfVertices = verticesComponents.length / 3;\n                  for (const { pos, uv } of vertices) {\n                    verticesComponents.push(pos[0] + x, pos[1] + y, pos[2] + z);\n                    normalsComponents.push(...dir);\n                    uvs.push(((blockId + uv[0]) * tileSize) / tileTextureWidth, 1 - ((uvRow + (1 + colourSetId) - uv[1]) * tileSize) / tileTextureHeight);\n                  }\n                  indices.push(numberOfVertices, numberOfVertices + 1, numberOfVertices + 2, numberOfVertices + 2, numberOfVertices + 1, numberOfVertices + 3);\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return {\n      verticesComponents,\n      normalsComponents,\n      uvs,\n      indices,\n    };\n  }\n\n  updateChunkGeometry(x, y, z) {\n    const { chunkSize } = this;\n    const chunkX = Math.floor(x / chunkSize);\n    const chunkY = Math.floor(y / chunkSize);\n    const chunkZ = Math.floor(z / chunkSize);\n    const chunkKey = this.getChunkKey(x, y, z);\n    let mesh = this.chunks_mesh[chunkKey];\n    const geometry = mesh ? mesh.geometry : new THREE.BufferGeometry();\n\n    const { verticesComponents, normalsComponents, uvs, indices } = this.generateGeometryDataForChunk(chunkX, chunkY, chunkZ);\n    const positionNumComponents = 3;\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(verticesComponents), positionNumComponents));\n    const normalNumComponents = 3;\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(new Float32Array(normalsComponents), normalNumComponents));\n    const uvNumComponents = 2;\n    geometry.setAttribute(\"uv\", new THREE.BufferAttribute(new Float32Array(uvs), uvNumComponents));\n    geometry.setIndex(indices);\n    geometry.computeBoundingSphere();\n\n    if (!mesh) {\n      mesh = new THREE.Mesh(geometry, this.material);\n      mesh.name = chunkKey;\n      this.chunks_mesh[chunkKey] = mesh;\n      this.scene.add(mesh);\n      mesh.position.set(chunkX * chunkSize, chunkY * chunkSize, chunkZ * chunkSize);\n    }\n  }\n\n  updateBlockGeometry(x, y, z) {\n    const updatedChunkKeys = {};\n    for (const offset of [\n      [0, 0, 0], // self\n      [-1, 0, 0], // left\n      [1, 0, 0], // right\n      [0, -1, 0], // down\n      [0, 1, 0], // up\n      [0, 0, -1], // back\n      [0, 0, 1], // front\n    ]) {\n      const ox = x + offset[0];\n      const oy = y + offset[1];\n      const oz = z + offset[2];\n      const chunkKey = this.getChunkKey(ox, oy, oz);\n      if (!updatedChunkKeys[chunkKey]) {\n        updatedChunkKeys[chunkKey] = true;\n        this.updateChunkGeometry(ox, oy, oz);\n      }\n    }\n  }\n}\n\nclass ViewOnline3D extends Component {\n  state = {\n    viewOnline_NBT_decompressed: null,\n    selectedBlock: null,\n  };\n\n  constructor(props) {\n    super(props);\n    this.canvasRef_viewOnline = createRef();\n  }\n\n  getNBTDecompressed() {\n    const { viewOnline_NBT } = this.props;\n    let nbtReader = new NBTReader();\n    nbtReader.loadBuffer(viewOnline_NBT);\n    const viewOnline_NBT_decompressed = nbtReader.getData();\n    return viewOnline_NBT_decompressed;\n  }\n\n  drawNBT() {\n    const { coloursJSON, optionValue_version } = this.props;\n    const { viewOnline_NBT_decompressed } = this.state;\n    const [schematic_size_x, schematic_size_y, schematic_size_z] = viewOnline_NBT_decompressed.value.size.value.value;\n\n    this.world.chunks = {};\n    this.world.chunks_mesh = {};\n\n    let paletteIdToColourSetIdAndBlockId = [];\n    const NBT_palette = viewOnline_NBT_decompressed.value.palette.value.value;\n    for (let paletteItem_index = 0; paletteItem_index < NBT_palette.length; paletteItem_index++) {\n      const paletteItem = NBT_palette[paletteItem_index];\n      let paletteItemFound = false;\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n        if (paletteItemFound) {\n          break;\n        }\n        for (const [blockId, block] of Object.entries(colourSet.blocks)) {\n          if (paletteItemFound) {\n            break;\n          }\n          if (!(optionValue_version.MCVersion in block.validVersions)) {\n            continue;\n          }\n          let blockNBTData = block.validVersions[optionValue_version.MCVersion];\n          if (typeof blockNBTData === \"string\") {\n            // this is of the form eg \"&1.12.2\"\n            blockNBTData = block.validVersions[blockNBTData.slice(1)];\n          }\n          if (\n            paletteItem.Name.value === `minecraft:${blockNBTData.NBTName}` &&\n            ((!(\"Properties\" in paletteItem) && Object.keys(blockNBTData.NBTArgs).length === 0) ||\n              (\"Properties\" in paletteItem &&\n                Object.keys(paletteItem.Properties.value).length === Object.keys(blockNBTData.NBTArgs).length &&\n                Object.entries(blockNBTData.NBTArgs).every(([argKey, argValue]) => {\n                  return argKey in paletteItem.Properties.value && argValue === paletteItem.Properties.value[argKey].value;\n                })))\n          ) {\n            paletteIdToColourSetIdAndBlockId.push([parseInt(colourSetId), parseInt(blockId)]);\n            paletteItemFound = true;\n          }\n        }\n      }\n      if (!paletteItemFound) {\n        console.log(`Didn't find ${paletteItem.Name.value} in coloursJSON; using placeholder texture`);\n        paletteIdToColourSetIdAndBlockId.push([64, 2]);\n      }\n    }\n\n    viewOnline_NBT_decompressed.value.blocks.value.value.forEach((block) => {\n      const block_coords = block.pos.value.value;\n      const block_paletteId = block.state.value;\n      this.world.setBlock(...block_coords, ...paletteIdToColourSetIdAndBlockId[block_paletteId]);\n    });\n    for (let x = 0; x < schematic_size_x; x += this.world.chunkSize) {\n      for (let y = 0; y < schematic_size_y; y += this.world.chunkSize) {\n        for (let z = 0; z < schematic_size_z; z += this.world.chunkSize) {\n          this.world.updateChunkGeometry(x, y, z);\n        }\n      }\n    }\n  }\n\n  handleEscapeKeyDown = function (e) {\n    const { handleViewOnline3DEscape } = this.props;\n    e.preventDefault();\n    if (e.key === \"Escape\") {\n      handleViewOnline3DEscape();\n    }\n  }.bind(this);\n\n  componentDidMount() {\n    const { coloursJSON } = this.props;\n    const canvasRef = this.canvasRef_viewOnline;\n    const viewOnline_NBT_decompressed = this.getNBTDecompressed();\n    const [, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\n\n    this.world = new BlockWorld({\n      canvasRef: canvasRef,\n      coloursJSON: coloursJSON,\n      tileSize: 32,\n      tileTextureWidth: 608,\n      tileTextureHeight: 2080,\n      camera_x: 0,\n      camera_y: size_y + 1,\n      camera_z: size_z,\n      onSelectBlockCallback: (selectedBlock) => {\n        this.setState({ selectedBlock });\n      },\n    });\n\n    this.world.startAnimationLoop();\n\n    this.setState({ viewOnline_NBT_decompressed }, () => {\n      this.drawNBT();\n      document.addEventListener(\"keydown\", this.handleEscapeKeyDown);\n      this.world.addEventListeners();\n    });\n  }\n\n  componentWillUnmount() {\n    this.world.stopAnimationLoop();\n    this.world.removeEventListeners();\n    document.removeEventListener(\"keydown\", this.handleEscapeKeyDown);\n  }\n\n  render() {\n    const { getLocaleString, coloursJSON } = this.props;\n    const { viewOnline_NBT_decompressed, selectedBlock } = this.state;\n    let component_size = null;\n    if (viewOnline_NBT_decompressed !== null) {\n      const [size_x, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\n      component_size = (\n        <h2\n          style={{\n            position: \"fixed\",\n            zIndex: 121,\n            left: 0,\n            top: 0,\n          }}\n        >\n          {getLocaleString(\"VIEW-ONLINE/SIZE\")}\n          {\": \"}\n          {size_x.toString()}\n          {\"x\"}\n          {size_y > 256 ? (\n            <Tooltip\n              tooltipText={getLocaleString(\"VIEW-ONLINE/TOO-BIG-FOR-SINGLE\")}\n              textStyleOverrides={{\n                whiteSpace: \"nowrap\",\n                backgroundColor: \"orange\",\n              }}\n            >\n              <b style={{ color: \"orange\" }}>{size_y.toString()}</b>\n            </Tooltip>\n          ) : (\n            size_y.toString()\n          )}\n          {\"x\"}\n          {size_z.toString()}\n        </h2>\n      );\n    }\n    const component_controls = (\n      <div\n        style={{\n          position: \"fixed\",\n          zIndex: 121,\n          left: 0,\n          bottom: 0,\n        }}\n      >\n        <h3 style={{ margin: 0 }}>{`${getLocaleString(\"VIEW-ONLINE/CONTROLS\")}: W A S D E SPACE C`}</h3>\n        <h3 style={{ margin: 0 }}>{`ESC ESC ${getLocaleString(\"VIEW-ONLINE/TO-EXIT\")}`}</h3>\n      </div>\n    );\n    let component_waila = null;\n    if (selectedBlock !== null) {\n      component_waila = (\n        <Waila\n          getLocaleString={getLocaleString}\n          coloursJSON={coloursJSON}\n          selectedBlock={selectedBlock}\n          style={{\n            position: \"fixed\",\n            zIndex: 121,\n            right: 0,\n            top: 0,\n          }}\n        />\n      );\n    }\n\n    return (\n      <React.Fragment>\n        {component_size}\n        {component_controls}\n        {component_waila}\n        <b style={{ position: \"fixed\", zIndex: 121, top: \"50%\", left: \"50%\" }}>{\"\\\\\"}</b>\n        <canvas\n          ref={this.canvasRef_viewOnline}\n          style={{\n            position: \"fixed\",\n            zIndex: 120,\n            width: \"100%\",\n            height: \"100%\",\n            top: 0,\n            bottom: 0,\n            left: 0,\n            right: 0,\n          }}\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nexport default ViewOnline3D;\n","import React, { Component } from \"react\";\n\nimport CookieManager from \"../../cookieManager\";\nimport BlockSelection from \"./blockSelection\";\nimport GreenButtons from \"./greenButtons\";\nimport MapPreview from \"./mapPreview\";\nimport MapSettings from \"./mapSettings\";\nimport Materials from \"./materials\";\nimport coloursJSON from \"./json/coloursJSON.json\";\nimport ViewOnline2D from \"./viewOnline2D/viewOnline2D\";\nimport ViewOnline3D from \"./viewOnline3D/viewOnline3D\";\n\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\nimport ColourMethods from \"./json/colourMethods.json\";\nimport CropModes from \"./json/cropModes.json\";\nimport DefaultPresets from \"./json/defaultPresets.json\";\nimport DitherMethods from \"./json/ditherMethods.json\";\nimport MapModes from \"./json/mapModes.json\";\nimport SupportedVersions from \"./json/supportedVersions.json\";\n\nimport IMG_Upload from \"../../images/upload.png\";\n\nimport \"./mapartController.css\";\n\nclass MapartController extends Component {\n  state = {\n    coloursJSON: null,\n    selectedBlocks: {},\n    disabledTones: {},\n    optionValue_version: Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1], // default to the latest version supported\n    optionValue_modeNBTOrMapdat: MapModes.SCHEMATIC_NBT.uniqueId,\n    optionValue_mapSize_x: 1,\n    optionValue_mapSize_y: 1,\n    optionValue_cropImage: CropModes.CENTER.uniqueId,\n    optionValue_cropImage_zoom: 10, // this gets scaled down by a factor of 10\n    optionValue_cropImage_percent_x: 50,\n    optionValue_cropImage_percent_y: 50,\n    optionValue_pixelSize: 1,\n    optionValue_showOriginalBlocks: false,\n    optionValue_showGridOverlay: false,\n    optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId,\n    optionValue_supportBlock: \"cobblestone\",\n    optionValue_transparency: false,\n    optionValue_transparencyTolerance: 128,\n    optionValue_mapdatFilenameUseId: true,\n    optionValue_mapdatFilenameIdStart: 0,\n    optionValue_betterColour: ColourMethods.Ciede2000_Lab65.uniqueId,\n    optionValue_dithering: DitherMethods.Atkinson.uniqueId,\n    optionValue_dithering_propagation_red: 100,\n    optionValue_dithering_propagation_green: 100,\n    optionValue_dithering_propagation_blue: 100,\n    optionValue_preprocessingEnabled: true,\n    preProcessingValue_brightness: 90,\n    preProcessingValue_contrast: 100,\n    preProcessingValue_saturation: 100,\n    preProcessingValue_backgroundColourSelect: BackgroundColourModes.OFF.uniqueId,\n    preProcessingValue_backgroundColour: \"#151515\",\n    optionValue_extras_moreStaircasingOptions: false,\n    uploadedImage: null,\n    uploadedImage_baseFilename: null,\n    presets: [],\n    selectedPresetName: \"None\",\n    currentMaterialsData: {\n      pixelsData: null,\n      maps: [[]], // entries are dictionaries with keys \"materials\", \"supportBlockCount\"\n      currentSelectedBlocks: {}, // we keep this soley for materials.js\n    },\n    mapPreviewWorker_inProgress: false,\n    viewOnline_NBT: null,\n    viewOnline_3D: false,\n  };\n\n  constructor(props) {\n    super(props);\n    // update default presets to latest version; done via checking for localeString\n    CookieManager.init();\n    let cookiesPresets_loaded = JSON.parse(CookieManager.touchCookie(\"mapartcraft_presets\", \"[]\"));\n    let cookiesPresets_updated = [];\n    for (const cookiesPreset_default of DefaultPresets) {\n      cookiesPresets_updated.push(cookiesPreset_default);\n    }\n    cookiesPresets_loaded = cookiesPresets_loaded.filter(cookiesPreset_loaded => !DefaultPresets.find((defaultPreset) => defaultPreset.name === cookiesPreset_loaded.name));\n    for (const cookiesPreset_loaded of cookiesPresets_loaded) {\n      cookiesPresets_updated.push(cookiesPreset_loaded);\n    }\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(cookiesPresets_updated));\n    this.state.presets = cookiesPresets_updated;\n\n    let cookie_customBlocks = JSON.parse(CookieManager.touchCookie(\"mapartcraft_customBlocks\", JSON.stringify([])));\n    this.state.coloursJSON = this.getMergedColoursJSON(cookie_customBlocks);\n\n    for (const colourSetId of Object.keys(this.state.coloursJSON)) {\n      this.state.selectedBlocks[colourSetId] = \"-1\";\n      this.state.disabledTones[colourSetId] = new Set();\n    }\n\n    const cookieMCVersion = CookieManager.touchCookie(\"mapartcraft_mcversion\", Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1].MCVersion);\n    const supportedVersionFound = Object.values(SupportedVersions).find((supportedVersion) => supportedVersion.MCVersion === cookieMCVersion);\n    if (supportedVersionFound !== undefined) {\n      this.state.optionValue_version = supportedVersionFound;\n    }\n\n    const URLParams = new URL(window.location).searchParams;\n    if (URLParams.has(\"preset\")) {\n      const decodedPresetBlocks = this.URLToPreset(URLParams.get(\"preset\"));\n      if (decodedPresetBlocks !== null) {\n        this.state.selectedBlocks = decodedPresetBlocks;\n      }\n    }\n  }\n\n  getMergedColoursJSON(customBlocks) {\n    // this is how we currently merge custom blocks into coloursJSON at runtime / when custom blocks update. this may change if presets support for custom blocks is added\n    let coloursJSON_custom = JSON.parse(JSON.stringify(coloursJSON)); // hmmm\n    for (const [colourSetId, customBlock] of customBlocks) {\n      coloursJSON_custom[colourSetId].blocks[Object.keys(coloursJSON_custom[colourSetId].blocks).length.toString()] = customBlock;\n    }\n    return coloursJSON_custom;\n  }\n\n  eventListener_dragover = function (e) {\n    // this has to be here for drop event to work\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  eventListener_drop = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const files = e.dataTransfer.files;\n    if (files.length) {\n      const file = files[0];\n      const imgUrl = URL.createObjectURL(file);\n      this.loadUploadedImageFromURL(imgUrl, \"mapart\");\n    }\n  }.bind(this);\n\n  eventListener_paste = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const files = e.clipboardData.files;\n    if (files.length) {\n      const file = files[0];\n      const imgUrl = URL.createObjectURL(file);\n      this.loadUploadedImageFromURL(imgUrl, \"mapart\");\n    }\n  }.bind(this);\n\n  componentDidMount() {\n    this.loadUploadedImageFromURL(IMG_Upload, \"mapart\");\n\n    document.addEventListener(\"dragover\", this.eventListener_dragover);\n    document.addEventListener(\"drop\", this.eventListener_drop);\n\n    document.addEventListener(\"paste\", this.eventListener_paste);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"dragover\", this.eventListener_dragover);\n    document.removeEventListener(\"drop\", this.eventListener_drop);\n    document.removeEventListener(\"paste\", this.eventListener_paste);\n  }\n\n  onFileDialogEvent = (e) => {\n    const files = e.target.files;\n    if (!files.length) {\n      return;\n    } else {\n      const file = files[0];\n      const imgUrl = URL.createObjectURL(file);\n      this.loadUploadedImageFromURL(imgUrl, file.name.replace(/\\.[^/.]+$/, \"\"));\n    }\n  };\n\n  loadUploadedImageFromURL(imageURL, baseFilename) {\n    const img = new Image();\n    img.onload = () => {\n      this.setState({\n        uploadedImage: img,\n        uploadedImage_baseFilename: baseFilename,\n      });\n    };\n    img.src = imageURL;\n  }\n\n  handleChangeColourSetBlock = (colourSetId, blockId) => {\n    let selectedBlocks = { ...this.state.selectedBlocks };\n    selectedBlocks[colourSetId] = blockId;\n    this.setState({\n      selectedBlocks,\n    });\n  };\n\n  handleChangeColourSetBlocks = (setsAndBlocks) => {\n    const { coloursJSON, optionValue_version } = this.state;\n    let selectedBlocks = {};\n    for (const colourSetId of Object.keys(coloursJSON)) {\n      selectedBlocks[colourSetId] = \"-1\";\n    }\n    for (const [int_colourSetId, ...presetIndexes] of setsAndBlocks) {\n      // we store presetIndex in the cookie, not blockId\n      const colourSetId = int_colourSetId.toString();\n      if (!(colourSetId in coloursJSON)) {\n        continue;\n      }\n      // keep testing presets indexes until one succeeds in the current version.\n      for (const presetIndex of presetIndexes) {\n        const blockIdAndBlock = Object.entries(coloursJSON[colourSetId].blocks).find(([, block]) => block.presetIndex === presetIndex);\n        if (blockIdAndBlock === undefined) {\n          continue;\n        }\n        const blockId = blockIdAndBlock[0];\n        if (Object.keys(coloursJSON[colourSetId].blocks[blockId].validVersions).includes(optionValue_version.MCVersion)) {\n          selectedBlocks[colourSetId] = blockId;\n          break;\n        }\n      }\n    }\n    this.setState({\n      selectedBlocks,\n    });\n  };\n\n  handleToggleColourTone = (colourSetId, tone) => {\n    let disabledTones = { ...this.state.disabledTones };\n\n    const set = disabledTones[colourSetId];\n\n    if (set.has(tone))\n      set.delete(tone);\n    else\n      set.add(tone);\n\n    this.setState({\n      disabledTones,\n    });\n  };\n\n  onOptionChange_modeNBTOrMapdat = (e) => {\n    const mode = parseInt(e.target.value);\n    this.setState({ optionValue_modeNBTOrMapdat: mode });\n    if (mode === MapModes.SCHEMATIC_NBT.uniqueId) {\n      this.setState({ optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId });\n    } else {\n      this.setState({ optionValue_staircasing: MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId });\n    }\n  };\n\n  onOptionChange_version = (e) => {\n    const { coloursJSON } = this.state;\n    const mcVersion = e.target.value;\n    CookieManager.setCookie(\"mapartcraft_mcversion\", mcVersion);\n    const supportedVersionFound = Object.values(SupportedVersions).find((supportedVersion) => supportedVersion.MCVersion === mcVersion);\n    this.setState((currentState) => {\n      let selectedBlocks = { ...currentState.selectedBlocks };\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\n        if (selectedBlocks[colourSetId] !== \"-1\" && !Object.keys(colourSet.blocks[selectedBlocks[colourSetId]].validVersions).includes(mcVersion)) {\n          selectedBlocks[colourSetId] = \"-1\";\n        }\n      }\n      return { optionValue_version: supportedVersionFound, selectedBlocks };\n    });\n  };\n\n  onOptionChange_mapSize_x = (value) => {\n    this.setState({\n      optionValue_mapSize_x: value,\n    });\n  };\n\n  onOptionChange_mapSize_y = (value) => {\n    this.setState({\n      optionValue_mapSize_y: value,\n    });\n  };\n\n  onOptionChange_pixelSize = (value) => {\n    this.setState({\n      optionValue_pixelSize: value,\n    });\n  };\n\n  onOptionChange_cropImage = (e) => {\n    const cropValue = parseInt(e.target.value);\n    // CENTER is a special case of MANUAL\n    // reset cropImage variables any time we change\n    this.setState({\n      optionValue_cropImage: cropValue,\n      optionValue_cropImage_zoom: 10,\n      optionValue_cropImage_percent_x: 50,\n      optionValue_cropImage_percent_y: 50,\n    });\n  };\n\n  onOptionChange_cropImage_zoom = (value) => {\n    this.setState({\n      optionValue_cropImage_zoom: value,\n    });\n  };\n\n  onOptionChange_cropImage_percent_x = (value) => {\n    this.setState({\n      optionValue_cropImage_percent_x: value,\n    });\n  };\n\n  onOptionChange_cropImage_percent_y = (value) => {\n    this.setState({\n      optionValue_cropImage_percent_y: value,\n    });\n  };\n\n  onOptionChange_showGridOverlay = () => {\n    this.setState({\n      optionValue_showGridOverlay: !this.state.optionValue_showGridOverlay,\n    });\n    // \"updatePreviewScale(0)\"\n  };\n\n  onOptionChange_showOriginalBlocks = () => {\n    this.setState({\n      optionValue_showOriginalBlocks: !this.state.optionValue_showOriginalBlocks,\n    });\n  };\n\n  onOptionChange_staircasing = (e) => {\n    const staircasingValue = parseInt(e.target.value);\n    this.setState({ optionValue_staircasing: staircasingValue });\n  };\n\n  onOptionChange_transparency = () => {\n    this.setState({\n      optionValue_transparency: !this.state.optionValue_transparency,\n    });\n  };\n\n  onOptionChange_transparencyTolerance = (value) => {\n    this.setState({\n      optionValue_transparencyTolerance: value,\n    });\n  };\n\n  onOptionChange_mapdatFilenameUseId = () => {\n    this.setState((currentState) => {\n      return {\n        optionValue_mapdatFilenameUseId: !currentState.optionValue_mapdatFilenameUseId,\n      };\n    });\n  };\n\n  onOptionChange_mapdatFilenameIdStart = (value) => {\n    this.setState({\n      optionValue_mapdatFilenameIdStart: value,\n    });\n  };\n\n  onOptionChange_BetterColour = (e) => {\n    const colourValue = parseInt(e.target.value);\n    this.setState({ optionValue_betterColour: colourValue });\n  };\n\n  onOptionChange_dithering = (e) => {\n    const ditheringValue = parseInt(e.target.value);\n    this.setState({ optionValue_dithering: ditheringValue });\n  };\n\n  onOptionChange_dithering_propagation_red = (value) => {\n    this.setState({ optionValue_dithering_propagation_red: value });\n  };\n\n  onOptionChange_dithering_propagation_green = (value) => {\n    this.setState({ optionValue_dithering_propagation_green: value });\n  };\n\n  onOptionChange_dithering_propagation_blue = (value) => {\n    this.setState({ optionValue_dithering_propagation_blue: value });\n  };\n\n  setOption_SupportBlock = (text) => {\n    this.setState({ optionValue_supportBlock: text });\n  };\n\n  onOptionChange_PreProcessingEnabled = () => {\n    this.setState({\n      optionValue_preprocessingEnabled: !this.state.optionValue_preprocessingEnabled,\n    });\n  };\n\n  onOptionChange_PreProcessingBrightness = (value) => {\n    this.setState({\n      preProcessingValue_brightness: value,\n    });\n  };\n\n  onOptionChange_PreProcessingContrast = (value) => {\n    this.setState({\n      preProcessingValue_contrast: value,\n    });\n  };\n\n  onOptionChange_PreProcessingSaturation = (value) => {\n    this.setState({\n      preProcessingValue_saturation: value,\n    });\n  };\n\n  onOptionChange_PreProcessingBackgroundColourSelect = (e) => {\n    const newValue = parseInt(e.target.value);\n    this.setState({ preProcessingValue_backgroundColourSelect: newValue });\n  };\n\n  onOptionChange_PreProcessingBackgroundColour = (e) => {\n    const newValue = e.target.value;\n    this.setState({ preProcessingValue_backgroundColour: newValue });\n  };\n\n  onOptionChange_extras_moreStaircasingOptions = () => {\n    const { optionValue_modeNBTOrMapdat, optionValue_extras_moreStaircasingOptions } = this.state;\n    this.setState({ optionValue_extras_moreStaircasingOptions: !optionValue_extras_moreStaircasingOptions });\n    if (optionValue_extras_moreStaircasingOptions) {\n      if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\n        this.setState({ optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId });\n      } else {\n        this.setState({ optionValue_staircasing: MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId });\n      }\n    }\n  };\n\n  onGetViewOnlineNBT = (viewOnline_NBT) => {\n    this.setState({ viewOnline_NBT });\n  };\n\n  downloadBlobFile(downloadBlob, filename) {\n    const downloadURL = window.URL.createObjectURL(downloadBlob);\n    const downloadElt = document.createElement(\"a\");\n    downloadElt.style = \"display: none\";\n    downloadElt.href = downloadURL;\n    downloadElt.download = filename;\n    document.body.appendChild(downloadElt);\n    downloadElt.click();\n    window.URL.revokeObjectURL(downloadURL);\n    document.body.removeChild(downloadElt);\n  }\n\n  handleGetPDNPaletteClicked = () => {\n    const { getLocaleString } = this.props;\n    const { coloursJSON, selectedBlocks, optionValue_modeNBTOrMapdat, optionValue_staircasing } = this.state;\n    let paletteText =\n      \"; paint.net Palette File\\n; Generated by MapartCraft\\n; Link to preset: \" +\n      this.selectedBlocksToURL() +\n      (Object.entries(selectedBlocks).some(([colourSetId, blockId]) => blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\")\n        ? \"\\n; Custom blocks not listed!\"\n        : \"\") +\n      \"\\n; staircasing: \" +\n      ([\n        MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\n        MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\n        MapModes.MAPDAT.staircaseModes.ON.uniqueId,\n        MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId,\n      ].includes(optionValue_staircasing)\n        ? \"enabled\"\n        : \"disabled\") +\n      \"\\n; unobtainable colours: \" +\n      ([MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId, MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId].includes(optionValue_staircasing)\n        ? \"enabled\"\n        : \"disabled\") +\n      \"\\n\";\n    let numberOfColoursExported = 0;\n    const toneKeysToExport = Object.values(Object.values(MapModes).find((mapMode) => mapMode.uniqueId === optionValue_modeNBTOrMapdat).staircaseModes).find(\n      (staircaseMode) => staircaseMode.uniqueId === optionValue_staircasing\n    ).toneKeys; // this .find stuff is annoying.\n    // TODO change from uniqueId to key\n    for (const [selectedBlock_colourSetId, selectedBlock_blockId] of Object.entries(selectedBlocks)) {\n      if (selectedBlock_blockId !== \"-1\") {\n        let colours = coloursJSON[selectedBlock_colourSetId].tonesRGB;\n        for (const toneKeyToExport of toneKeysToExport) {\n          numberOfColoursExported += 1;\n          paletteText += \"FF\";\n          for (let i = 0; i < 3; i++) {\n            paletteText += Number(colours[toneKeyToExport][i]).toString(16).padStart(2, \"0\").toUpperCase();\n          }\n          paletteText += \"\\n\";\n        }\n      }\n    }\n    if (numberOfColoursExported === 0) {\n      alert(getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-NONE-SELECTED\"));\n      return;\n    } else if (numberOfColoursExported > 96) {\n      alert(\n        `${getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-MAX-COLOURS-1\")}${numberOfColoursExported.toString()}${getLocaleString(\n          \"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-MAX-COLOURS-2\"\n        )}`\n      );\n    }\n    const downloadBlob = new Blob([paletteText], { type: \"text/plain\" });\n    this.downloadBlobFile(downloadBlob, \"MapartcraftPalette.txt\");\n  };\n\n  handlePresetChange = (e) => {\n    const presetName = e.target.value;\n    const { presets } = this.state;\n\n    this.setState({ selectedPresetName: presetName });\n\n    if (presetName === \"None\") {\n      this.handleChangeColourSetBlocks([]);\n    } else {\n      const selectedPreset = presets.find((preset) => preset.name === presetName);\n      if (selectedPreset !== undefined) {\n        this.handleChangeColourSetBlocks(selectedPreset.blocks);\n      }\n    }\n  };\n\n  isDefaultPreset = () => {\n    const { selectedPresetName } = this.state;\n    return selectedPresetName === \"None\" || DefaultPresets.find((defaultPreset) => defaultPreset.name === selectedPresetName);\n  };\n\n  handleDeletePreset = () => {\n    const { getLocaleString } = this.props;\n    const { presets, selectedPresetName } = this.state;\n    if (this.isDefaultPreset()) return;\n    if (!window.confirm(`${getLocaleString(\"BLOCK-SELECTION/PRESETS/DELETE-CONFIRM\")} ${selectedPresetName}`)) return;\n    const presets_new = presets.filter((preset) => preset.name !== selectedPresetName);\n    this.setState({\n      presets: presets_new,\n      selectedPresetName: \"None\",\n    });\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(presets_new));\n  };\n\n  handleSavePreset = () => {\n    const { getLocaleString } = this.props;\n    const { coloursJSON, presets, selectedBlocks } = this.state;\n\n    let presetToSave_name = prompt(getLocaleString(\"BLOCK-SELECTION/PRESETS/SAVE-PROMPT-ENTER-NAME\"), \"\");\n    if (presetToSave_name === null) {\n      return;\n    }\n\n    const otherPresets = presets.filter((preset) => preset.name !== presetToSave_name);\n    let newPreset = { name: presetToSave_name, blocks: [] };\n    Object.keys(selectedBlocks).forEach((key) => {\n      if (selectedBlocks[key] !== \"-1\" && coloursJSON[key].blocks[selectedBlocks[key]].presetIndex !== \"CUSTOM\") {\n        newPreset.blocks.push([parseInt(key), parseInt(coloursJSON[key].blocks[selectedBlocks[key]].presetIndex)]);\n      }\n    });\n    const presets_new = [...otherPresets, newPreset];\n    this.setState({\n      presets: presets_new,\n      selectedPresetName: presetToSave_name,\n    });\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(presets_new));\n  };\n\n  selectedBlocksToURL = () => {\n    // colourSetId encoded in base 36 as [0-9a-z]\n    // blockId encoded in modified base 26 as [Q-ZA-P]\n    const { coloursJSON, selectedBlocks } = this.state;\n    let presetQueryString = \"\";\n    for (const [colourSetId, blockId] of Object.entries(selectedBlocks)) {\n      if (blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex !== \"CUSTOM\") {\n        presetQueryString += parseInt(colourSetId).toString(36);\n        presetQueryString += coloursJSON[colourSetId].blocks[blockId].presetIndex\n          .toString(26)\n          .toUpperCase()\n          .replace(/[0-9]/g, (match) => {\n            return {\n              0: \"Q\",\n              1: \"R\",\n              2: \"S\",\n              3: \"T\",\n              4: \"U\",\n              5: \"V\",\n              6: \"W\",\n              7: \"X\",\n              8: \"Y\",\n              9: \"Z\",\n            }[match];\n          });\n      }\n    }\n    return \"https://hahaluckyme.github.io/mapartcraft/?preset=\" + presetQueryString;\n  };\n\n  handleSharePreset = () => {\n    const { getLocaleString } = this.props;\n    const { coloursJSON, selectedBlocks } = this.state;\n    if (Object.keys(selectedBlocks).every((colourSetId) => selectedBlocks[colourSetId] === \"-1\")) {\n      alert(getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-WARNING-NONE-SELECTED\"));\n    } else {\n      if (\n        Object.entries(selectedBlocks).some(([colourSetId, blockId]) => blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\")\n      ) {\n        alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NO-EXPORT\"));\n      }\n      prompt(getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-LINK\"), this.selectedBlocksToURL());\n    }\n  };\n\n  URLToPreset = (encodedPreset) => {\n    const { onCorruptedPreset } = this.props;\n    const { coloursJSON, optionValue_version } = this.state;\n    if (!/^[0-9a-zQ-ZA-P]*$/g.test(encodedPreset)) {\n      onCorruptedPreset();\n      return null;\n    }\n    let selectedBlocks = { ...this.state.selectedBlocks };\n    let presetRegex = /([0-9a-z]+)(?=([Q-ZA-P]+))/g;\n    let match;\n    while ((match = presetRegex.exec(encodedPreset)) !== null) {\n      const encodedColourSetId = match[1];\n      const encodedBlockId = match[2];\n      const decodedColourSetId = parseInt(encodedColourSetId, 36).toString();\n      const decodedPresetIndex = parseInt(\n        encodedBlockId\n          .replace(/[Q-Z]/g, (match) => {\n            return {\n              Q: \"0\",\n              R: \"1\",\n              S: \"2\",\n              T: \"3\",\n              U: \"4\",\n              V: \"5\",\n              W: \"6\",\n              X: \"7\",\n              Y: \"8\",\n              Z: \"9\",\n            }[match];\n          })\n          .toLowerCase(),\n        26\n      );\n      if (!(decodedColourSetId in coloursJSON)) {\n        continue;\n      }\n      const decodedBlock = Object.entries(coloursJSON[decodedColourSetId].blocks).find((elt) => elt[1].presetIndex === decodedPresetIndex);\n      if (decodedBlock === undefined) {\n        continue;\n      }\n      const decodedBlockId = decodedBlock[0].toString();\n      if (Object.keys(coloursJSON[decodedColourSetId].blocks[decodedBlockId].validVersions).includes(optionValue_version.MCVersion)) {\n        selectedBlocks[decodedColourSetId] = decodedBlockId;\n      }\n    }\n    return selectedBlocks;\n  };\n\n  onMapPreviewWorker_begin = () => {\n    this.setState({ mapPreviewWorker_inProgress: true });\n  };\n\n  handleSetMapMaterials = (currentMaterialsData) => {\n    this.setState({ currentMaterialsData: currentMaterialsData, mapPreviewWorker_inProgress: false });\n  };\n\n  onChooseViewOnline3D = () => {\n    this.setState({ viewOnline_3D: true });\n  };\n\n  handleViewOnline3DEscape = () => {\n    this.setState({\n      viewOnline_NBT: null,\n      viewOnline_3D: false,\n    });\n  };\n\n  handleAddCustomBlock = (block_colourSetId, block_name, block_nbtTags, block_versions) => {\n    const { getLocaleString } = this.props;\n    // const {coloursJSON} = this.state;\n    const block_name_trimmed = block_name.trim();\n    if (block_name_trimmed === \"\") {\n      alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ERROR-NO-NAME\"));\n      return;\n    }\n    if (Object.values(block_versions).every((t) => !t)) {\n      alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ERROR-NONE-SELECTED\"));\n      return;\n    }\n    let blockToAdd = {\n      displayName: block_name_trimmed,\n      validVersions: {},\n      presetIndex: \"CUSTOM\",\n    };\n    let addedFirstVersion = false;\n    for (const [block_version, block_version_isSelected] of Object.entries(block_versions)) {\n      if (!block_version_isSelected) {\n        continue;\n      }\n      if (addedFirstVersion) {\n        blockToAdd.validVersions[SupportedVersions[block_version].MCVersion] = `&${Object.keys(blockToAdd.validVersions)[0]}`;\n      } else {\n        blockToAdd.validVersions[SupportedVersions[block_version].MCVersion] = {\n          NBTName: block_name_trimmed,\n          NBTArgs: {},\n        };\n        for (const [nbtTag_key, nbtTag_value] of block_nbtTags) {\n          const nbtTag_key_trimmed = nbtTag_key.trim();\n          const nbtTag_value_trimmed = nbtTag_value.trim();\n          if (!(nbtTag_key_trimmed === \"\" && nbtTag_value_trimmed === \"\")) {\n            blockToAdd.validVersions[SupportedVersions[block_version].MCVersion].NBTArgs[nbtTag_key_trimmed] = nbtTag_value_trimmed;\n          }\n        }\n        addedFirstVersion = true;\n      }\n    }\n\n    const customBlocks = JSON.parse(CookieManager.getCookie(\"mapartcraft_customBlocks\"));\n    let customBlocks_new = customBlocks.filter(\n      (customBlock) =>\n        customBlock[0] !== block_colourSetId ||\n        customBlock[1].displayName !== block_name_trimmed ||\n        !Object.values(SupportedVersions).some(\n          (supportedVersion_value) =>\n            supportedVersion_value.MCVersion in customBlock[1].validVersions && supportedVersion_value.MCVersion in blockToAdd.validVersions\n        )\n    ); // filter removes customBlocks that have the same colourSet, name, and some versions in common as the one we are adding. For example this allows us to add different 1.12.2 and 1.13+ versions of a block\n    customBlocks_new.push([block_colourSetId, blockToAdd]);\n\n    this.setState((currentState) => {\n      return { coloursJSON: this.getMergedColoursJSON(customBlocks_new), selectedBlocks: { ...currentState.selectedBlocks, [block_colourSetId]: \"-1\" } };\n    });\n    CookieManager.setCookie(\"mapartcraft_customBlocks\", JSON.stringify(customBlocks_new));\n  };\n\n  handleDeleteCustomBlock = (block_colourSetId, block_name, block_versions) => {\n    const block_name_trimmed = block_name.trim();\n    if (block_name_trimmed === \"\" || Object.values(block_versions).every((t) => !t)) {\n      return;\n    }\n\n    let validVersions = [];\n    for (const [block_version, block_version_isSelected] of Object.entries(block_versions)) {\n      if (block_version_isSelected) {\n        validVersions.push(SupportedVersions[block_version].MCVersion);\n      }\n    }\n\n    const customBlocks = JSON.parse(CookieManager.getCookie(\"mapartcraft_customBlocks\"));\n    let customBlocks_new = customBlocks.filter(\n      (customBlock) =>\n        customBlock[0] !== block_colourSetId ||\n        customBlock[1].displayName !== block_name_trimmed ||\n        !Object.values(SupportedVersions).some(\n          (supportedVersion_value) =>\n            supportedVersion_value.MCVersion in customBlock[1].validVersions && validVersions.includes(supportedVersion_value.MCVersion)\n        )\n    );\n\n    this.setState((currentState) => {\n      return {\n        coloursJSON: this.getMergedColoursJSON(customBlocks_new),\n        selectedBlocks: { ...currentState.selectedBlocks, [block_colourSetId]: \"-1\" },\n        currentMaterialsData: {\n          // reset currentMaterialsData as materials.js uses a cached version of materials which could contain blocks which no longer exist\n          pixelsData: null,\n          maps: [[]],\n          currentSelectedBlocks: {},\n        },\n      };\n    });\n    CookieManager.setCookie(\"mapartcraft_customBlocks\", JSON.stringify(customBlocks_new));\n  };\n\n  render() {\n    const { getLocaleString } = this.props;\n    const {\n      coloursJSON,\n      selectedBlocks,\n      disabledTones,\n      optionValue_version,\n      optionValue_modeNBTOrMapdat,\n      optionValue_mapSize_x,\n      optionValue_mapSize_y,\n      optionValue_cropImage,\n      optionValue_cropImage_zoom,\n      optionValue_cropImage_percent_x,\n      optionValue_cropImage_percent_y,\n      optionValue_showGridOverlay,\n      optionValue_showOriginalBlocks,\n      optionValue_pixelSize,\n      optionValue_staircasing,\n      optionValue_supportBlock,\n      optionValue_transparency,\n      optionValue_transparencyTolerance,\n      optionValue_mapdatFilenameUseId,\n      optionValue_mapdatFilenameIdStart,\n      optionValue_betterColour,\n      optionValue_dithering,\n      optionValue_dithering_propagation_red,\n      optionValue_dithering_propagation_green,\n      optionValue_dithering_propagation_blue,\n      optionValue_preprocessingEnabled,\n      preProcessingValue_brightness,\n      preProcessingValue_contrast,\n      preProcessingValue_saturation,\n      preProcessingValue_backgroundColourSelect,\n      preProcessingValue_backgroundColour,\n      optionValue_extras_moreStaircasingOptions,\n      uploadedImage,\n      uploadedImage_baseFilename,\n      presets,\n      selectedPresetName,\n      currentMaterialsData,\n      mapPreviewWorker_inProgress,\n      viewOnline_NBT,\n      viewOnline_3D,\n    } = this.state;\n    return (\n      <div className=\"mapartController\">\n        <BlockSelection\n          getLocaleString={getLocaleString}\n          coloursJSON={coloursJSON}\n          disabledTones={disabledTones}\n          onChangeColourSetBlock={this.handleChangeColourSetBlock}\n          onToggleColourTone={this.handleToggleColourTone}\n          optionValue_version={optionValue_version}\n          optionValue_showOriginalBlocks={optionValue_showOriginalBlocks}\n          optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\n          optionValue_staircasing={optionValue_staircasing}\n          selectedBlocks={selectedBlocks}\n          presets={presets}\n          selectedPresetName={selectedPresetName}\n          isDefaultPreset={this.isDefaultPreset}\n          onPresetChange={this.handlePresetChange}\n          onDeletePreset={this.handleDeletePreset}\n          onSavePreset={this.handleSavePreset}\n          onSharePreset={this.handleSharePreset}\n          onGetPDNPaletteClicked={this.handleGetPDNPaletteClicked}\n          onOptionChange_showOriginalBlocks={this.onOptionChange_showOriginalBlocks}\n          handleAddCustomBlock={this.handleAddCustomBlock}\n          handleDeleteCustomBlock={this.handleDeleteCustomBlock}\n        />\n        <div className=\"sectionsPreviewSettingsMaterials\">\n          <MapPreview\n            getLocaleString={getLocaleString}\n            coloursJSON={coloursJSON}\n            selectedBlocks={selectedBlocks}\n            disabledTones={disabledTones}\n            optionValue_version={optionValue_version}\n            optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\n            optionValue_mapSize_x={optionValue_mapSize_x}\n            optionValue_mapSize_y={optionValue_mapSize_y}\n            optionValue_cropImage={optionValue_cropImage}\n            optionValue_cropImage_zoom={optionValue_cropImage_zoom}\n            optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\n            optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\n            optionValue_showGridOverlay={optionValue_showGridOverlay}\n            optionValue_pixelSize={optionValue_pixelSize}\n            optionValue_staircasing={optionValue_staircasing}\n            optionValue_transparency={optionValue_transparency}\n            optionValue_transparencyTolerance={optionValue_transparencyTolerance}\n            optionValue_betterColour={optionValue_betterColour}\n            optionValue_dithering={optionValue_dithering}\n            optionValue_dithering_propagation_red={optionValue_dithering_propagation_red}\n            optionValue_dithering_propagation_green={optionValue_dithering_propagation_green}\n            optionValue_dithering_propagation_blue={optionValue_dithering_propagation_blue}\n            optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\n            preProcessingValue_brightness={preProcessingValue_brightness}\n            preProcessingValue_contrast={preProcessingValue_contrast}\n            preProcessingValue_saturation={preProcessingValue_saturation}\n            preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\n            preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\n            uploadedImage={uploadedImage}\n            onFileDialogEvent={this.onFileDialogEvent}\n            onGetMapMaterials={this.handleSetMapMaterials}\n            onMapPreviewWorker_begin={this.onMapPreviewWorker_begin}\n          />\n          <div style={{ display: \"block\" }}>\n            <MapSettings\n              getLocaleString={getLocaleString}\n              coloursJSON={coloursJSON}\n              optionValue_version={optionValue_version}\n              onOptionChange_version={this.onOptionChange_version}\n              optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\n              onOptionChange_modeNBTOrMapdat={this.onOptionChange_modeNBTOrMapdat}\n              optionValue_mapSize_x={optionValue_mapSize_x}\n              onOptionChange_mapSize_x={this.onOptionChange_mapSize_x}\n              optionValue_mapSize_y={optionValue_mapSize_y}\n              onOptionChange_mapSize_y={this.onOptionChange_mapSize_y}\n              optionValue_cropImage={optionValue_cropImage}\n              onOptionChange_cropImage={this.onOptionChange_cropImage}\n              optionValue_cropImage_zoom={optionValue_cropImage_zoom}\n              onOptionChange_cropImage_zoom={this.onOptionChange_cropImage_zoom}\n              optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\n              onOptionChange_cropImage_percent_x={this.onOptionChange_cropImage_percent_x}\n              optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\n              onOptionChange_cropImage_percent_y={this.onOptionChange_cropImage_percent_y}\n              optionValue_showGridOverlay={optionValue_showGridOverlay}\n              onOptionChange_showGridOverlay={this.onOptionChange_showGridOverlay}\n              optionValue_pixelSize={optionValue_pixelSize}\n              onOptionChange_pixelSize={this.onOptionChange_pixelSize}\n              optionValue_staircasing={optionValue_staircasing}\n              onOptionChange_staircasing={this.onOptionChange_staircasing}\n              optionValue_supportBlock={optionValue_supportBlock}\n              setOption_SupportBlock={this.setOption_SupportBlock}\n              optionValue_transparency={optionValue_transparency}\n              onOptionChange_transparency={this.onOptionChange_transparency}\n              optionValue_transparencyTolerance={optionValue_transparencyTolerance}\n              onOptionChange_transparencyTolerance={this.onOptionChange_transparencyTolerance}\n              optionValue_mapdatFilenameUseId={optionValue_mapdatFilenameUseId}\n              onOptionChange_mapdatFilenameUseId={this.onOptionChange_mapdatFilenameUseId}\n              optionValue_mapdatFilenameIdStart={optionValue_mapdatFilenameIdStart}\n              onOptionChange_mapdatFilenameIdStart={this.onOptionChange_mapdatFilenameIdStart}\n              optionValue_betterColour={optionValue_betterColour}\n              onOptionChange_BetterColour={this.onOptionChange_BetterColour}\n              optionValue_dithering={optionValue_dithering}\n              onOptionChange_dithering={this.onOptionChange_dithering}\n              optionValue_dithering_propagation_red={optionValue_dithering_propagation_red}\n              onOptionChange_dithering_propagation_red={this.onOptionChange_dithering_propagation_red}\n              optionValue_dithering_propagation_green={optionValue_dithering_propagation_green}\n              onOptionChange_dithering_propagation_green={this.onOptionChange_dithering_propagation_green}\n              optionValue_dithering_propagation_blue={optionValue_dithering_propagation_blue}\n              onOptionChange_dithering_propagation_blue={this.onOptionChange_dithering_propagation_blue}\n              optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\n              onOptionChange_PreProcessingEnabled={this.onOptionChange_PreProcessingEnabled}\n              preProcessingValue_brightness={preProcessingValue_brightness}\n              onOptionChange_PreProcessingBrightness={this.onOptionChange_PreProcessingBrightness}\n              preProcessingValue_contrast={preProcessingValue_contrast}\n              onOptionChange_PreProcessingContrast={this.onOptionChange_PreProcessingContrast}\n              preProcessingValue_saturation={preProcessingValue_saturation}\n              onOptionChange_PreProcessingSaturation={this.onOptionChange_PreProcessingSaturation}\n              preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\n              onOptionChange_PreProcessingBackgroundColourSelect={this.onOptionChange_PreProcessingBackgroundColourSelect}\n              preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\n              onOptionChange_PreProcessingBackgroundColour={this.onOptionChange_PreProcessingBackgroundColour}\n              optionValue_extras_moreStaircasingOptions={optionValue_extras_moreStaircasingOptions}\n              onOptionChange_extras_moreStaircasingOptions={this.onOptionChange_extras_moreStaircasingOptions}\n            />\n            <GreenButtons\n              getLocaleString={getLocaleString}\n              coloursJSON={coloursJSON}\n              selectedBlocks={selectedBlocks}\n              optionValue_version={optionValue_version}\n              optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\n              optionValue_mapSize_x={optionValue_mapSize_x}\n              optionValue_mapSize_y={optionValue_mapSize_y}\n              optionValue_cropImage={optionValue_cropImage}\n              optionValue_cropImage_zoom={optionValue_cropImage_zoom}\n              optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\n              optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\n              optionValue_staircasing={optionValue_staircasing}\n              optionValue_supportBlock={optionValue_supportBlock}\n              optionValue_transparency={optionValue_transparency}\n              optionValue_transparencyTolerance={optionValue_transparencyTolerance}\n              optionValue_mapdatFilenameUseId={optionValue_mapdatFilenameUseId}\n              optionValue_mapdatFilenameIdStart={optionValue_mapdatFilenameIdStart}\n              optionValue_betterColour={optionValue_betterColour}\n              optionValue_dithering={optionValue_dithering}\n              optionValue_dithering_propagation_red={optionValue_dithering_propagation_red}\n              optionValue_dithering_propagation_green={optionValue_dithering_propagation_green}\n              optionValue_dithering_propagation_blue={optionValue_dithering_propagation_blue}\n              optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\n              preProcessingValue_brightness={preProcessingValue_brightness}\n              preProcessingValue_contrast={preProcessingValue_contrast}\n              preProcessingValue_saturation={preProcessingValue_saturation}\n              preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\n              preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\n              uploadedImage={uploadedImage}\n              uploadedImage_baseFilename={uploadedImage_baseFilename}\n              currentMaterialsData={currentMaterialsData}\n              mapPreviewWorker_inProgress={mapPreviewWorker_inProgress}\n              downloadBlobFile={this.downloadBlobFile}\n              onGetViewOnlineNBT={this.onGetViewOnlineNBT}\n            />\n          </div>\n        </div>\n        {optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId ? (\n            <Materials\n              getLocaleString={getLocaleString}\n              coloursJSON={coloursJSON}\n              optionValue_version={optionValue_version}\n              optionValue_supportBlock={optionValue_supportBlock}\n              currentMaterialsData={currentMaterialsData}\n              onChangeColourSetBlock={this.handleChangeColourSetBlock}\n            />\n          ) : null}\n        {viewOnline_NBT !== null &&\n          (viewOnline_3D ? (\n            <ViewOnline3D\n              getLocaleString={getLocaleString}\n              coloursJSON={coloursJSON}\n              optionValue_version={optionValue_version}\n              optionValue_mapSize_x={optionValue_mapSize_x}\n              optionValue_mapSize_y={optionValue_mapSize_y}\n              viewOnline_NBT={viewOnline_NBT}\n              handleViewOnline3DEscape={this.handleViewOnline3DEscape}\n            />\n          ) : (\n            <ViewOnline2D\n              getLocaleString={getLocaleString}\n              coloursJSON={coloursJSON}\n              optionValue_version={optionValue_version}\n              optionValue_mapSize_x={optionValue_mapSize_x}\n              optionValue_mapSize_y={optionValue_mapSize_y}\n              optionValue_staircasing={optionValue_staircasing}\n              viewOnline_NBT={viewOnline_NBT}\n              onGetViewOnlineNBT={this.onGetViewOnlineNBT}\n              onChooseViewOnline3D={this.onChooseViewOnline3D}\n            />\n          ))}\n      </div>\n    );\n  }\n}\n\nexport default MapartController;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAANMSURBVHhe7d3PahNRGIbxowv/IHZjcS2uxL3gDXgV3oDgvXgXXoVegOC+iAv3lm6sSGIjKBPmg+Mwk2SSMzPfd573gaEmTJuU99dpRUlvvXn39m9S2G63bxU0AYAnAPAEAJ4AwBMAeAIADwtg9WOVvny4SJvVTXsPMySA7fgfL9LPy+vtWzICHAAb/896s729vl6jEaAAdMe3yAgwAIbGt6gIEAD2jW8REVQP4NDxLRqCqgGMHd8iIagWwLHjWxQEVQI4dXyLgKA6AKXGt2pHUBWA0uNbNSOoBsBU41u1IqgCwNTjWzUiCA9grvGt2hCEBjD3+FZNCMICWGp8qxYEIQEsPb5VA4JwALyMb0VHEAqAt/GtyAjCAPA6vhUVQQgA3se3IiJwDyDK+FY0BK4BRBvfioTALYCo41tRELgEEH18KwICdwBqGd/yjsAVgNrGtzwjcAOg1vEtrwhcAKh9fMsjgsUBUMa3vCFYFABtfMsTgsUAUMe3vCBYBAB9fMsDgtkBaPz/WxrBrAA0fn9LIpgNgMbf3VIIZgGg8Q9rCQSTA9D445obwaQANP5xzYlg0t8XcPn1e9qsy30SV9+u0s2v3+0tf915cDedPz1vb53evbP76dGTch+vr1C/MKJ5Ycfmtf289vDxWXr26nl7K0az/jVQ+UsA4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMAL9TqBqny6AsATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4BX9x6DP7z+1fxruxeuX27f5uX33DbXr/ZuG7u927ONbpz7noY4595R0BYA3GYBGpx3HlL9/fsxV97EOeewxzzM/Nz/66juvOUqkKwC8yQA038PsmLruY5X8ChlT93nsKz9/1/v1ndccJdIVAN4sPwPkxxR1P37Jr5AxdZ/Hvg49N/+4+VEiXQHguQWQf6/Lj1oa8znl5+ZHiXQFgKf/Fg5PVwB4AgBPAOAJADwBgCcA8AQAngDAEwB4AgBPAOAJADwBgCcA8AQAXUr/ADWYPUK6/RieAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\n\nimport Header from \"./header\";\nimport Languages from \"./languages\";\nimport MapartController from \"./mapart/mapartController\";\n\nimport Locale from \"../locale/locale\";\n\nimport \"./root.css\";\n\nclass Root extends Component {\n  state = {\n    displayingCorruptedPresetWarning: false,\n    displayingEdgeWarning: false,\n  };\n\n  constructor(props) {\n    super(props);\n\n    //show warning when using Edge\n    if (!(/*@cc_on!@*/ (false || !!document[\"documentMode\"])) && !!window[\"StyleMedia\"]) {\n      this.state.displayingEdgeWarning = true;\n    }\n  }\n\n  getLocaleString = (stringName, languageCodeOverride) => {\n    // languageCodeOverride only used inside this method for falling back to en\n    const countryCode = languageCodeOverride !== undefined ? languageCodeOverride : this.props.match.params.countryCode;\n    if (countryCode in Locale) {\n      let stringSegments = stringName.split(\"/\");\n      const stringLast = stringSegments.pop();\n      let folder = Locale[countryCode].strings;\n      for (const stringSegment of stringSegments) {\n        folder = folder[stringSegment];\n      }\n      if (folder[stringLast] === null) {\n        // this could get stuck in an endless loop if the string does not exist in en;\n        // en must always exist\n        return this.getLocaleString(stringName, \"en\");\n      } else {\n        return folder[stringLast];\n      }\n    } else {\n      return this.getLocaleString(stringName, \"en\");\n    }\n  };\n\n  onEdgeWarningButtonClick = () => {\n    this.setState({ displayingEdgeWarning: false });\n  };\n\n  onCorruptedPresetWarningButtonClick = () => {\n    this.setState({ displayingCorruptedPresetWarning: false });\n  };\n\n  showCorruptedPresetWarning = () => {\n    this.setState({ displayingCorruptedPresetWarning: true });\n  };\n\n  render() {\n    const { displayingCorruptedPresetWarning, displayingEdgeWarning } = this.state;\n    return (\n      <React.Fragment>\n        <div className=\"titleAndLanguages\">\n          <span><h1>MapartCraft</h1>{this.props.match.params.countryCode && this.props.match.params.countryCode !== \"en\" && <small>{this.getLocaleString(\"TRANSLATION/CREDITS\")}</small>}</span>\n          <Languages />\n        </div>\n        <Header getLocaleString={this.getLocaleString} countryCode={this.props.match.params.countryCode} />\n        <MapartController getLocaleString={this.getLocaleString} onCorruptedPreset={this.showCorruptedPresetWarning} />\n        <div className=\"fixedMessages\">\n          {displayingEdgeWarning ? (\n            <div className=\"fixedMessage\">\n              <p>{this.getLocaleString(\"EDGE-WARNING\").replace(\"\\\\n\", \"\\n\")}</p>\n              <button type=\"button\" onClick={this.onEdgeWarningButtonClick}>\n                ✔️\n              </button>\n            </div>\n          ) : null}\n          {displayingCorruptedPresetWarning ? (\n            <div className=\"fixedMessage\">\n              <p>{this.getLocaleString(\"BLOCK-SELECTION/PRESETS/IMPORT-ERROR-CORRUPTED\")}</p>\n              <button type=\"button\" onClick={this.onCorruptedPresetWarningButtonClick}>\n                ❗\n              </button>\n            </div>\n          ) : null}\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Root;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\n\nimport FAQ from \"./components/faq\";\nimport Root from \"./components/root\";\n\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router basename=\"/mapartcraft\">\n      <Switch>\n        <Route path=\"/:countryCode?/faq\" component={FAQ} />\n        <Route path=\"/:countryCode?\" component={Root} />\n      </Switch>\n    </Router>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}